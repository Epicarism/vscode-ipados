# Agent: ui-polish-gemini
**Status:** done
**Tokens:** 62,093
**Cost:** $0.0000
**Time:** 2026-02-10T02:54:06.322Z

## Task
VSCodeiPadOS: Review overall UI polish. Check font rendering, line spacing, cursor color, selection highlight. Ensure editor matches VS Code aesthetic. Check ThemeManager.swift colors. Suggest and implement improvements. BUILD AFTER.

## Response
>>>TOOL list_dir
{"path": "."}
>>>END

>>>TOOL search
{"query": "ThemeManager.swift"}
>>>END

---

## üîß TOOL RESULTS

[search]
Found 30 matches:
FULL_FEATURE_TEST_PLAN.md:419: ## 28. THEMES (ThemeManager.swift - 186 lines)
.claudefluff/agents/workspace-settings-worker-2026-02-09T11-19-30-291Z.md:66: {"path":"VSCodeiPadOS/VSCodeiPadOS/Models/ThemeManager.swift","start_line":1,"end_line":260}
.claudefluff/agents/workspace-settings-worker-2026-02-09T11-19-30-291Z.md:365: {"path":"VSCodeiPadOS/VSCodeiPadOS/Models/ThemeManager.swift","start_line":1,"end_line":80}
.claudefluff/agents/workspace-settings-worker-2026-02-09T11-19-30-291Z.md:526: {"path":"VSCodeiPadOS/VSCodeiPadOS/Services/ThemeManager.swift","start_line":1,"end_line":120}
.claudefluff/agents/workspace-settings-worker-2026-02-09T11-19-30-291Z.md:529: {"path":"VSCodeiPadOS/VSCodeiPadOS/Models/ThemeManager.swift","start_line":1,"end_line":60}
.claudefluff/agents/test-term-8-2026-02-09T19-41-12-260Z.md:1248: .garbage/vscodeipados-cleanup/build/Build/Intermediates.noindex/XCBuildData/PIFCache/project/PROJECT@v11_mod=85459984fe846a02209cd32df62c0e25_hash=447e80667c80026d2ec83bd9a98d31b7plugins=1OJSG6M1FOV3XYQCBH7Z29RZ0FPR9XDE1-json:1: {"appPreferencesBuildSettings":{},"buildConfigurations":[{"buildSettings":{"ALWAYS_SEARCH_USER_PATHS":"NO","CLANG_ANALYZER_NONNULL":"YES","CLANG_ANALYZER_NUMBER_OBJECT_CONVERSION":"YES_AGGRESSIVE","CLANG_CXX_LANGUAGE_STANDARD":"gnu++14","CLANG_CXX_LIBRARY":"libc++","CLANG_ENABLE_MODULES":"YES","CLANG_ENABLE_OBJC_ARC":"YES","CLANG_ENABLE_OBJC_WEAK":"YES","CLANG_WARN_BLOCK_CAPTURE_AUTORELEASING":"YES","CLANG_WARN_BOOL_CONVERSION":"YES","CLANG_WARN_COMMA":"YES","CLANG_WARN_CONSTANT_CONVERSION":"YES","CLANG_WARN_DEPRECATED_OBJC_IMPLEMENTATIONS":"YES","CLANG_WARN_DIRECT_OBJC_ISA_USAGE":"YES_ERROR","CLANG_WARN_DOCUMENTATION_COMMENTS":"YES","CLANG_WARN_EMPTY_BODY":"YES","CLANG_WARN_ENUM_CONVERSION":"YES","CLANG_WARN_INFINITE_RECURSION":"YES","CLANG_WARN_INT_CONVERSION":"YES","CLANG_WARN_NON_LITERAL_NULL_CONVERSION":"YES","CLANG_WARN_OBJC_IMPLICIT_RETAIN_SELF":"YES","CLANG_WARN_OBJC_LITERAL_CONVERSION":"YES","CLANG_WARN_OBJC_ROOT_CLASS":"YES_ERROR","CLANG_WARN_QUOTED_INCLUDE_IN_FRAMEWORK_HEADER":"YES","CLANG_WARN_RANGE_LOOP_ANALYSIS":"YES","CLANG_WARN_STRICT_PROTOTYPES":"YES","CLANG_WARN_SUSPICIOUS_MOVE":"YES","CLANG_WARN_UNGUARDED_AVAILABILITY":"YES_AGGRESSIVE","CLANG_WARN_UNREACHABLE_CODE":"YES","CLANG_WARN__DUPLICATE_METHOD_MATCH":"YES","COPY_PHASE_STRIP":"NO","DEBUG_INFORMATION_FORMAT":"dwarf","ENABLE_STRICT_OBJC_MSGSEND":"YES","ENABLE_TESTABILITY":"YES","GCC_C_LANGUAGE_STANDARD":"gnu11","GCC_DYNAMIC_NO_PIC":"NO","GCC_NO_COMMON_BLOCKS":"YES","GCC_OPTIMIZATION_LEVEL":"0","GCC_PREPROCESSOR_DEFINITIONS":"$(inherited) DEBUG=1","GCC_WARN_64_TO_32_BIT_CONVERSION":"YES","GCC_WARN_ABOUT_RETURN_TYPE":"YES_ERROR","GCC_WARN_UNDECLARED_SELECTOR":"YES","GCC_WARN_UNINITIALIZED_AUTOS":"YES_AGGRESSIVE","GCC_WARN_UNUSED_FUNCTION":"YES","GCC_WARN_UNUSED_VARIABLE":"YES","IPHONEOS_DEPLOYMENT_TARGET":"15.0","MTL_ENABLE_DEBUG_INFO":"INCLUDE_SOURCE","MTL_FAST_MATH":"YES","ONLY_ACTIVE_ARCH":"YES","PRODUCT_NAME":"$(TARGET_NAME)","SDKROOT":"iphoneos","SWIFT_ACTIVE_COMPILATION_CONDITIONS":"DEBUG","SWIFT_OPTIMIZATION_LEVEL":"-Onone","SWIFT_VERSION":"5.0"},"guid":"447e80667c80026d2ec83bd9a98d31b77c0640d88236c73a6323c92d7a3a6e31","name":"Debug"},{"buildSettings":{"ALWAYS_SEARCH_USER_PATHS":"NO","CLANG_ANALYZER_NONNULL":"YES","CLANG_ANALYZER_NUMBER_OBJECT_CONVERSION":"YES_AGGRESSIVE","CLANG_CXX_LANGUAGE_STANDARD":"gnu++14","CLANG_CXX_LIBRARY":"libc++","CLANG_ENABLE_MODULES":"YES","CLANG_ENABLE_OBJC_ARC":"YES","CLANG_ENABLE_OBJC_WEAK":"YES","CLANG_WARN_BLOCK_CAPTURE_AUTORELEASING":"YES","CLANG_WARN_BOOL_CONVERSION":"YES","CLANG_WARN_COMMA":"YES","CLANG_WARN_CONSTANT_CONVERSION":"YES","CLANG_WARN_DEPRECATED_OBJC_IMPLEMENTATIONS":"YES","CLANG_WARN_DIRECT_OBJC_ISA_USAGE":"YES_ERROR","CLANG_WARN_DOCUMENTATION_COMMENTS":"YES","CLANG_WARN_EMPTY_BODY":"YES","CLANG_WARN_ENUM_CONVERSION":"YES","CLANG_WARN_INFINITE_RECURSION":"YES","CLANG_WARN_INT_CONVERSION":"YES","CLANG_WARN_NON_LITERAL_NULL_CONVERSION":"YES","CLANG_WARN_OBJC_IMPLICIT_RETAIN_SELF":"YES","CLANG_WARN_OBJC_LITERAL_CONVERSION":"YES","CLANG_WARN_OBJC_ROOT_CLASS":"YES_ERROR","CLANG_WARN_QUOTED_INCLUDE_IN_FRAMEWORK_HEADER":"YES","CLANG_WARN_RANGE_LOOP_ANALYSIS":"YES","CLANG_WARN_STRICT_PROTOTYPES":"YES","CLANG_WARN_SUSPICIOUS_MOVE":"YES","CLANG_WARN_UNGUARDED_AVAILABILITY":"YES_AGGRESSIVE","CLANG_WARN_UNREACHABLE_CODE":"YES","CLANG_WARN__DUPLICATE_METHOD_MATCH":"YES","COPY_PHASE_STRIP":"NO","DEBUG_INFORMATION_FORMAT":"dwarf-with-dsym","ENABLE_NS_ASSERTIONS":"NO","ENABLE_STRICT_OBJC_MSGSEND":"YES","GCC_C_LANGUAGE_STANDARD":"gnu11","GCC_NO_COMMON_BLOCKS":"YES","GCC_WARN_64_TO_32_BIT_CONVERSION":"YES","GCC_WARN_ABOUT_RETURN_TYPE":"YES_ERROR","GCC_WARN_UNDECLARED_SELECTOR":"YES","GCC_WARN_UNINITIALIZED_AUTOS":"YES_AGGRESSIVE","GCC_WARN_UNUSED_FUNCTION":"YES","GCC_WARN_UNUSED_VARIABLE":"YES","IPHONEOS_DEPLOYMENT_TARGET":"15.0","MTL_ENABLE_DEBUG_INFO":"NO","MTL_FAST_MATH":"YES","PRODUCT_NAME":"$(TARGET_NAME)","SDKROOT":"iphoneos","SWIFT_COMPILATION_MODE":"wholemodule","SWIFT_OPTIMIZATION_LEVEL":"-O","SWIFT_VERSION":"5.0"},"guid":"447e80667c80026d2ec83bd9a98d31b711fb67ede629293483b204fa32bbc805","name":"Release"}],"classPrefix":"","defaultConfigurationName":"Debug","developmentRegion":"en","groupTree":{"children":[{"children":[{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7d28ab283ad5fae06d1dc983c0f3cea3f","path":"ActivityBarView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7e17118e09c9d74df58666d1379698228","path":"AIAssistantView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7017d1b1303582ec1caf247f566ebba9f","path":"App.swift","sourceTree":"<group>","type":"file"},{"fileType":"folder.assetcatalog","guid":"447e80667c80026d2ec83bd9a98d31b7155389fdb279953759e5b692221c59c2","path":"Assets.xcassets","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7dec434270b7659adbed28dd1e4c1e254","path":"AutocompleteManager.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b73e3319163a1baac7e2d06cb086391893","path":"AutoUnindentDemo.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7e2ae2bb8e8e675d2bb25fd0e88d7665d","path":"CodeCompletion.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b78069b34a726d32db8a03dde2d3dbc790","path":"CodeEditor.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b728dccd9208ee8d623ec85acae0fbe0b0","path":"CodeEditorView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b76081995fb299c2fa883a03a9c70a7a37","path":"CodeFolding.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b758d47cf14f115c1d0bd9d2f9e2c06c82","path":"CodeFoldingManager.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7175b53ffd09e662bc089fec49ffb1fcc","path":"CommandPalette.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b72250b1db823ea7710c8151d93b657d9e","path":"CommandPaletteCoordinator.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b705aa2ab3e2647a8dd762d5483806ef84","path":"ContentView_backup.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b70b298e900f48d2b1dca7fe79e78f1498","path":"ContentView_cmd_g_additions.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b72e1fd4d2276fb5f2ae5653ceee9f67b3","path":"ContentView_completion.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b74e193740a7b0b9cb71a713346adaf670","path":"ContentView_Enhanced.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b77a98265024b44d14dc62b59b9256c9a2","path":"ContentView_Fixed.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7b0f1653181aae1f9e44d7c377f62ad77","path":"ContentView_highlighted.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b700c4345007dcc87b0f6842fa21743b3d","path":"ContentView_iPadOS.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b731314cfcd64105709187e8fcee8d4050","path":"ContentView_macOS.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b70664412350914503f5380547b8377097","path":"ContentView_minimap_addition.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b770a604e6c8badc2dd1a3e8cf23acfb51","path":"ContentView_MultiTabs.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b78be0e7399bb3dd8e6da10d8052b56ff0","path":"ContentView_old.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b726e9ac02d4f6df17699041307b4db042","path":"ContentView_original.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b73a3c8b9c380c95b1c47f6bec9032dbcd","path":"ContentView_regex_addition.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b72e81d8709b48b75fe989b173a331f66a","path":"ContentView_regex_update.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b71263a36b9733bc1458c324701f4877fd","path":"ContentView_search_update.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b705708c7772ed2be93c7ceeed0771864b","path":"ContentView_Shortcuts.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b74d03ec1f3392b69f602cd352d738c6c0","path":"ContentView_with_minimap.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7851c45cefcdd7bcd03ba5fc235c72b56","path":"ContentView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b771b62593a7eb59925a29393ea08d8c0b","path":"ContentViewUpdate.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b798508ca3a96b3f1d4efcd111b5a4dc5d","path":"DocumentPicker.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b74f82f389e3a2bd8eaaa724edeededdec","path":"DragDropTest.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b79f0ca77ea4e2731624eaf11dbb47f0a1","path":"DrawingAnnotationView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7f5650f166b070d504fb0a69c23b98a63","path":"Editor.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b75f91f0bc045e87e8ed96744329207cc8","path":"EditorAreaView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b70ca2d61403377b3906f45659e5c570dc","path":"EditorContainerView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b73f53282d2353317f4645f89e2fa60908","path":"EditorCore.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7929f9063ca6ae1edabc7c21a0d77856a","path":"EditorPane.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7f397920013d7147daaa76587fe8b312c","path":"EditorTab.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b72fde6f35fdc37c2947f490ec91349c18","path":"EditorView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b78e9b49f31e3309e0fc7b568e907de7a7","path":"EditorViewModel.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7caa69c788dd8491d15c234b630a28f2b","path":"EditorViewUpdate.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b75c1fd102ea162067234f293290b2e9e4","path":"EnhancedCodeEditorView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7abb2e8f9afe3b0302e1959534d131992","path":"example.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7a9595e44406bd7b4a33cc28094a5b1f7","path":"File.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b76cc0ee5946d248745af491d2d0df5990","path":"FileBrowser.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b779308208e09681e637f8eee39492ba41","path":"FileBrowserView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7ac7aa07998c9c7518bf420d7bd65b607","path":"FileDocument.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7ea452995fe2eb9ebe17b852142aa225b","path":"FileExplorer.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b74cd3d118ebdb6b5a0651b9bb454b94d0","path":"FileExplorerView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b70bdac97995565d4430a7535d2b88ac6e","path":"FileItem.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b71d06d894beecaedef7c08635a89860a4","path":"FileItemUTType.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7246081a2dddea599ef9979e887243e1b","path":"FileManager.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7f5933afb48b00f8ea004e6f9b0c77593","path":"FileManager+Extensions.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7f642f3a2c82d64d1b04ff2266222f1b4","path":"FileManagerExtensions.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b700ca5e8ad5ac083b14b9becf14c36d77","path":"FileSystem.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b706ecf59cd8f496436c55c4fbd0d13137","path":"FileSystemManager.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b70a18af98c33655afe795b84a4c85afc0","path":"FileSystemNavigator.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7e1555abdd0e1d5edcaab7682fbc60728","path":"FileSystemView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7324358661e61f652a66c95b2acb5906f","path":"FileSystemViewModel.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b786a9312ff06732f3cc90cc8e8ce895a9","path":"FileTreeItem.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7d963726724cd20ebadc366c2e2072bd8","path":"FileTreeItemView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7ef21d610b11b6fd57bf8ef6f3a71503a","path":"FileTreeModel.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7fbd88d2a84c51a6fe5a89278e572c3a2","path":"FileTreeView_Fixed.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b70b05feff8b905afb6705936cea3cccc2","path":"FileTreeView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b79a81fd2a381d8e35e3f99f80acd44759","path":"FileTreeViewModel.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7b6c3e683294cb2ef9e4598fc034692e3","path":"FileView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7d55265662d9cc5e918dc17699aa20e35","path":"FindInFileView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b76ea0911b31f9500402bc6e57a46a4222","path":"FindReplaceView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7fcbf39171349394b413c858934b98ac9","path":"FindViewModel.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b713fb78634280647bcff3cf8ee689db9f","path":"GitHelper.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7713b8864ef0c8036006bd16a4f1a1943","path":"GitIntegration.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b759a1d21366feecdad266887b78c0bf73","path":"GitManager.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7bddf642e9e1447c6d94a7d5c9543c8bd","path":"GoToLineView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7afb0af59bfdfc178a5c3cca83b5b1270","path":"IntegrationExample.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7c09487eca984b65c27b246057ada51da","path":"iPadTextEditor.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7e3b52edb350df7ccf8806aa46e9b923d","path":"KeyboardExtensions.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b77f87d9407999a6cab92f72e4daebd311","path":"KeyboardShortcuts.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7243e8c84a0f8cb0b16db15f4d42fc1dc","path":"KeyCommandHostingController.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7090b11016272b1f54817866e0c53782a","path":"LineNumberTextEditor.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7a7679883408de90a7a7881b02dfac01d","path":"LocalFileService.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7f9305349a6de8a76f6926f53f08c291e","path":"MarkdownRenderer.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7477115bf35c68ef5f4eff2b257595fcf","path":"minimap_patch.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b719536333ad7d6994dbb95e06dd969602","path":"Minimap.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b774f8b37c765051b735386f1362c6a8cc","path":"MinimapView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b789117a9619cfd9950912a84e06222569","path":"Models.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7dfd4100cd59792d068f942582a4f5721","path":"ModelsExtensions.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b786bf2d9cff1bd9c39e0eaa77d82db045","path":"MonacoEditor.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b75b0af1c7d84a03fe068dd91a9e756084","path":"MonacoEditorView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7bc1f3be13f2f25ced188f7770a7a01c6","path":"MonacoWebView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b72805c70ac141ac646f68def8c397ed98","path":"NSAttributedStringSyntaxHighlighter.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7496c520bf9f12d6a81121e172d987a3e","path":"QuickOpenView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b71b1c61a611aa4fcc0aff1a3d3f36f096","path":"regex_search_addition.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b734e3ced5598c6c42bc6df76a46f13efc","path":"regex_search_complete_example.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7dc84dc5616c93de9392a8b93fb7404d6","path":"RegexSearchExamples.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7421ac3a33db3fe0a8c0d557d90cdd9ff","path":"SearchBar.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7083b88aaa0451ec1c7d2bc0c087dc8b0","path":"SearchState.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7970d9d5a17c6a2666c8a264bba466a64","path":"SearchView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b72375b04a110d1b09276799de719fa00d","path":"SelectAllHelper.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b722c0222613b6776dc9d61ef7a35bcdc1","path":"SelectionSupport.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7c412629fcd98c27364879a6daa69aaa6","path":"SettingsView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7c6aae7c41cea90b6cd8684944eeaabc5","path":"Sidebar.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7c9140cf18234ff32588b9a1264ba1fc1","path":"SidebarView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b767f1d66f96dace13d8d4efd4e130c225","path":"SidebarViews.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7f10c2e1b5e5281b2c70c118d482f6df9","path":"SplitView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7304cd505a3cba190a4c7f573d05f6979","path":"SplitViewController.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b71c4ac2502e5943cd0d981a6b7b7b3850","path":"SQLHighlighterTests.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7f5f4add1c13e2ebdd75b55f034451f9b","path":"StatusBar.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b772a13f4315c9f65e1578b8ff91401629","path":"StatusBarView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7aa650ec28b54ea941e6d92f0ec0f4d24","path":"StorageManager.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7a8f6eb24b78335d75429a47133745942","path":"SymbolNavigatorView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7bac5a7feb67d9151b6c3898eb07f942f","path":"SyntaxHighlightedTextEditor.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b732e0b9aeb31f19020ae7d0f54cd94878","path":"SyntaxHighlighter_Optimized.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b74133f9a2a07fc86faa7e7b3766081970","path":"SyntaxHighlighter_Original.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b76eecfb89231a22422719d2cedd777a67","path":"SyntaxHighlighter.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7234894f2774005c84b37fb2cb0cfe65b","path":"SyntaxHighlighterPerformanceTest.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7abbf63d1348d9d0200ea0f40eec9937d","path":"SyntaxHighlighting.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7ee615fd1bcfd33ea4ffa56eff678df4d","path":"Tab.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7f70a7be59cba834b8b1207a560a92dad","path":"TabBar.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b735336cd5d03e69a3a0a4fa789d9bba06","path":"TabBarView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b722bdc75d8657fb13fb8b5bc58c965d7d","path":"TabManager.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b74c2e82a7624b90e68c1741d1793f86e6","path":"TabModel.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7bd28ccc114988d429561117ebc40325c","path":"TabSwitchModifier.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7986b4ec2315770350fe890856e67b841","path":"TerminalManager.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b786a89f7fdedae68ff8362a3822aefd07","path":"TerminalView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7643a1321f98fde77190e6e2258f98e2a","path":"test_example.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b76c36119825bcc7ef0ab1269a55f4c644","path":"test_folding.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b75a85f2eb01b315414d4391c2f674571c","path":"test_syntax.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b75984fb8f66d35702644fd533afc15f17","path":"test.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7abc2b9d2641ddccea0ea65a1cdae00ff","path":"TextEditor.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b760765ff37004f731c7e80c140ec45784","path":"TextEditorView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7d41962135df6f527c43ba3d61f3fb593","path":"ThemeManager.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b73d4cf522cd54ee1500833a1f7e27341f","path":"ToolbarContent.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7023003ae48b46a5cce54f01437f8c2d7","path":"ToolbarView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7aaa8132a44352fbab0ed9410ead062af","path":"TreeSitterManager.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7f0b1f6aa20f491dab561dc49abd03879","path":"UIEditorView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7dd3e864fa582e700b38ee775300551d5","path":"ViewModel.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7c522a5faa151c92f8efa80b2fca0e399","path":"VSCodeiPadOSApp_improved.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7b37e9b597d3e42dbd75e4d53a48fc3a1","path":"VSCodeiPadOSApp.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7829ff76de2d66a346dc352ba3b09b9d6","path":"WebServerManager.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b728e0880bec9549cb0fe6c25169a0823e","path":"WebViewBridge.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7c9c94a5b7a185663a3a9b7b218b49bd7","path":"Welcome.swift","sourceTree":"<group>","type":"file"},{"children":[{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7e564749551151d33c67d766b74e016d7","path":"AppCommands.swift","sourceTree":"<group>","type":"file"}],"guid":"447e80667c80026d2ec83bd9a98d31b7014755df050a88d8a85406698e583f71","name":"Commands","path":"Commands","sourceTree":"<group>","type":"group"},{"children":[{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7bb53ee3792fbd750f61a2d7282107de6","path":"Color+Hex.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7a9076775603d58ac136efa6e9080f8ae","path":"KeyboardShortcuts.swift","sourceTree":"<group>","type":"file"}],"guid":"447e80667c80026d2ec83bd9a98d31b77dba42ecf07ec8d4a1a4a3f5b633c34f","name":"Extensions","path":"Extensions","sourceTree":"<group>","type":"group"},{"children":[{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b73a12901be9ad0720d7ce02c5e255dcfb","path":"EditorManager.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b72f9d2b8eb0eec3ab1fa0f2c30a87055f","path":"FileItem.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7019c913031f15e5bc9e1850f39b0f27e","path":"FileSystemManager.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7555c43d819a3570f8e95dca51329ba77","path":"OpenFile.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7b38503a56f28c79d87e401395cb0f604","path":"WorkspaceManager.swift","sourceTree":"<group>","type":"file"}],"guid":"447e80667c80026d2ec83bd9a98d31b7344af92f65ff9d1b3bf709b5ba79c9e9","name":"Models","path":"Models","sourceTree":"<group>","type":"group"},{"children":[{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b70b6cbb5b1b3f26921012ce34f3145f59","path":"SyntaxHighlighter.swift","sourceTree":"<group>","type":"file"}],"guid":"447e80667c80026d2ec83bd9a98d31b78d3e6b4c2a6f540febdd55509cd1d663","name":"Utilities","path":"Utilities","sourceTree":"<group>","type":"group"},{"children":[{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7588eb9ad7f882afc7fce945c6b80b4ba","path":"EditorView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7c5d6e39075873175d4faabfb4c213a2b","path":"FileTreeView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7bf2505b26c3061ef2b951e6e756d1133","path":"SidebarView.swift","sourceTree":"<group>","type":"file"},{"fileType":"sourcecode.swift","guid":"447e80667c80026d2ec83bd9a98d31b7ef318c5b1d6d9bdf0ec944e13b24db82","path":"TabBarView.swift","sourceTree":"<group>","type":"file"}],"guid":"447e80667c80026d2ec83bd9a98d31b77250e9d3a445a954dcb477c6bd7d4e41","name":"Views","path":"Views","sourceTree":"<group>","type":"group"}],"guid":"447e80667c80026d2ec83bd9a98d31b7509c823f92830f1cb24217fb9767f86c","name":"VSCodeiPadOS","path":"VSCodeiPadOS","sourceTree":"<group>","type":"group"},{"guid":"447e80667c80026d2ec83bd9a98d31b748510f638a7e686de7fafeeee83cd1cb","name":"Products","path":"","sourceTree":"<group>","type":"group"}],"guid":"447e80667c80026d2ec83bd9a98d31b708a8950f3a3ad9c1251fcc92cb1738eb","name":"VSCodeiPadOS","path":"","sourceTree":"<group>","type":"group"},"guid":"447e80667c80026d2ec83bd9a98d31b7","path":"/Users/danielswagg/PLAYGROUND/vscode-ipados/VSCodeiPadOS/VSCodeiPadOS.xcodeproj","projectDirectory":"/Users/danielswagg/PLAYGROUND/vscode-ipados/VSCodeiPadOS","targets":["TARGET@v11_hash=1b206747dafac036753eba6613b66ef4"]}
.claudefluff/agents/opus-fix-all-errors-2026-02-09T20-40-59-349Z.md:144: ThemeManager.swift
.claudefluff/agents/opus-fix-all-errors-2026-02-09T20-40-59-349Z.md:361: ThemeManager.swift
.claudefluff/agents/coord-1770675222668-2026-02-09T22-17-59-006Z.md:215: 43: | syntax-10 | Theme color integration | Services/ThemeManager.swift |
.claudefluff/agents/coord-1770675222668-2026-02-09T22-17-59-006Z.md:1240: ThemeManager.swift
.claudefluff/agents/settings-theme-audit-2026-02-09T21-54-56-843Z.md:8: Audit settings/themes: 1) SettingsManager.swift - verify all settings persist, 2) SettingsView.swift - verify UI controls work, 3) ThemeManager.swift - verify 4+ themes exist with colors, 4) StatusBarView.swift - verify all indicators wired. Report FULLY WIRED vs STUB.
.claudefluff/agents/settings-theme-audit-2026-02-09T21-54-56-843Z.md:446: {"path": "VSCodeiPadOS/VSCodeiPadOS/Models/ThemeManager.swift"}
.claudefluff/agents/settings-theme-audit-2026-02-09T21-54-56-843Z.md:454: File: VSCodeiPadOS/VSCodeiPadOS/Models/ThemeManager.swift (lines 1-77 of 77)
.claudefluff/agents/settings-theme-audit-2026-02-09T21-54-56-843Z.md:615: Error: File 'VSCodeiPadOS/VSCodeiPadOS/Models' not in allowed paths: VSCodeiPadOS/VSCodeiPadOS/Services/SettingsManager.swift, VSCodeiPadOS/VSCodeiPadOS/Views/Panels/SettingsView.swift, VSCodeiPadOS/VSCodeiPadOS/Models/ThemeManager.swift, VSCodeiPadOS/VSCodeiPadOS/Views/StatusBarView.swift
.claudefluff/agents/settings-theme-audit-2026-02-09T21-54-56-843Z.md:687: VSCodeiPadOS/VSCodeiPadOS/Models/ThemeManager.swift:4: class ThemeManager: ObservableObject {
.claudefluff/agents/settings-theme-audit-2026-02-09T21-54-56-843Z.md:688: VSCodeiPadOS/VSCodeiPadOS/Models/ThemeManager.swift:5: @AppStorage("selectedThemeId") var selectedThemeId: String = "dark_plus"
.claudefluff/agents/settings-theme-audit-2026-02-09T21-54-56-843Z.md:689: VSCodeiPadOS/VSCodeiPadOS/Models/ThemeManager.swift:6: @Published var currentTheme: Theme
.claudefluff/agents/settings-theme-audit-2026-02-09T21-54-56-843Z.md:690: VSCodeiPadOS/VSCodeiPadOS/Models/ThemeManager.swift:8: static let shared = ThemeManager()
.claudefluff/agents/settings-theme-audit-2026-02-09T21-54-56-843Z.md:691: VSCodeiPadOS/VSCodeiPadOS/Models/ThemeManager.swift:11: static var current: Theme { shared.currentTheme }
.claudefluff/agents/settings-theme-audit-2026-02-09T21-54-56-843Z.md:692: VSCodeiPadOS/VSCodeiPadOS/Models/ThemeManager.swift:14: let themeId = UserDefaults.standard.string(forKey: "selectedThemeId") ?? "dark_plus"
.claudefluff/agents/settings-theme-audit-2026-02-09T21-54-56-843Z.md:693: VSCodeiPadOS/VSCodeiPadOS/Models/ThemeManager.swift:15: self.currentTheme = Theme.allThemes.first(where: { $0.id == themeId }) ?? .darkPlus
.claudefluff/agents/settings-theme-audit-2026-02-09T21-54-56-843Z.md:973: Error: File 'VSCodeiPadOS/VSCodeiPadOS/ContentView.swift' not in allowed paths: VSCodeiPadOS/VSCodeiPadOS/Services/SettingsManager.swift, VSCodeiPadOS/VSCodeiPadOS/Views/Panels/SettingsView.swift, VSCodeiPadOS/VSCodeiPadOS/Models/ThemeManager.swift, VSCodeiPadOS/VSCodeiPadOS/Views/StatusBarView.swift
.claudefluff/agents/settings-theme-audit-2026-02-09T21-54-56-843Z.md:1022: ## 3. ThemeManager.swift ‚ö†Ô∏è STUB - CRITICAL MISSING DEPENDENCY
.claudefluff/agents/settings-theme-audit-2026-02-09T21-54-56-843Z.md:1023: **File:** `VSCodeiPadOS/VSCodeiPadOS/Models/ThemeManager.swift`
.claudefluff/agents/settings-theme-audit-2026-02-09T21-54-56-843Z.md:1079: | **ThemeManager.swift** | ‚ö†Ô∏è STUB | Logic exists but Theme struct not in allowed files |
.claudefluff/agents/coord-20-final-2026-02-09T11-39-30-168Z.md:70: The files exist but are NOT in the Xcode project (0 matches). I need to add ThemeManager.swift, Theme.swift, and MultiCursor.swift to the project. Let me read the project file to understand how to add them:
.claudefluff/agents/coord-20-final-2026-02-09T11-39-30-168Z.md:82: I need to add Theme.swift, ThemeManager.swift, and MultiCursor.swift to the Xcode project. Let me update the project.pbxproj file:
.claudefluff/agents/coord-20-final-2026-02-09T11-39-30-168Z.md:115: 1020 /* ThemeManager.swift in Sources */ = {isa = PBXBuildFile; fileRef = 2020 /* ThemeManager.swift */; };
.claudefluff/agents/coord-20-final-2026-02-09T11-39-30-168Z.md:131: 2020 /* ThemeManager.swift */ = {isa = PBXFileReference; lastKnownFileType = sourcecode.swift; path = ThemeManager.swift; sourceTree = "<group>"; };
.claudefluff/agents/coord-20-final-2026-02-09T11-39-30-168Z.md:161: 2020 /* ThemeManager.swift */,


>>>TOOL list_dir
{"path": "VSCodeiPadOS/VSCodeiPadOS"}
>>>END

---

## üîß TOOL RESULTS

[list_dir]
üìÅ VSCodeiPadOS/VSCodeiPadOS/
üìÅ App/
üìÅ Assets.xcassets/
üìÅ Commands/
üìÅ Docs/
üìÅ Extensions/
üìÅ Menus/
üìÅ Models/
üìÅ Resources/
üìÅ Services/
üìÅ Tests/
üìÅ UITests/
üìÅ Utils/
üìÅ Views/
   .tooling_note.txt
   ContentView_shift_arrow.patch
   ContentView.swift
   ContentView.swift.bak
   FIX_SUMMARY.md
   IMPLEMENTATION_SUMMARY.md
   Info.plist
   KeyboardShortcuts.md
   MULTI_WINDOW_IMPLEMENTATION.md
   MultiWindowSupport.md
   SceneDelegate.swift
   SyntaxHighlighter_Optimizations.md


>>>TOOL list_dir
{"path": "VSCodeiPadOS/VSCodeiPadOS/Services"}
>>>END

---

## üîß TOOL RESULTS

[list_dir]
üìÅ VSCodeiPadOS/VSCodeiPadOS/Services/
üìÅ NativeGit/
üìÅ OnDevice/
üìÅ Runners/
   AIManager.swift
   AutocompleteManager.swift
   CodeFoldingManager.swift
   ColorPickerManager.swift
   DebugManager.swift
   EditorCore.swift
   ErrorParser.swift
   FileSystemNavigator.swift
   GitManager.swift
   GitService.swift
   HoverInfoManager.swift
   InlayHintsManager.swift
   InlineSuggestionManager.swift
   KeychainManager.swift
   LaunchManager.swift
   NavigationManager.swift
   RecentFileManager.swift
   RemoteDebugger.swift
   RemoteRunner.swift
   RunnerSelector.existing.swift
   RunnerSelector.swift
   SearchManager.swift
   SettingsManager.swift
   SFTPManager.swift
   SnippetsManager.swift
   SpotlightManager.swift
   SSHManager.swift
   SuggestionCache.swift
   TasksManager.swift
   ThemeManager.swift
   WindowStateManager.swift
   WorkspaceManager.swift
   WorkspaceTrustManager.swift


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Services/ThemeManager.swift"}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Services/ThemeManager.swift (lines 1-186 of 186)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1: import SwiftUI
2: 
3: // MARK: - Theme Model
4: 
5: struct Theme: Identifiable, Hashable {
6:     let id: String
7:     let name: String
8:     let isDark: Bool
9:     
10:     // Editor colors
11:     let backgroundColor: Color
12:     let textColor: Color
13:     let lineNumberColor: Color
14:     let selectionColor: Color
15:     let cursorColor: Color
16:     
17:     // Syntax colors
18:     let keywordColor: Color
19:     let stringColor: Color
20:     let commentColor: Color
21:     let numberColor: Color
22:     let functionColor: Color
23:     let typeColor: Color
24:     let variableColor: Color
25:     let operatorColor: Color
26:     
27:     // UI colors
28:     let sidebarBackground: Color
29:     let tabBarBackground: Color
30:     let statusBarBackground: Color
31:     let borderColor: Color
32:     
33:     // Predefined themes
34:     static let defaultDark = Theme(
35:         id: "dark-default",
36:         name: "Dark+ (default)",
37:         isDark: true,
38:         backgroundColor: Color(hex: "1e1e1e"),
39:         textColor: Color(hex: "d4d4d4"),
40:         lineNumberColor: Color(hex: "858585"),
41:         selectionColor: Color(hex: "264f78"),
42:         cursorColor: Color(hex: "aeafad"),
43:         keywordColor: Color(hex: "569cd6"),
44:         stringColor: Color(hex: "ce9178"),
45:         commentColor: Color(hex: "6a9955"),
46:         numberColor: Color(hex: "b5cea8"),
47:         functionColor: Color(hex: "dcdcaa"),
48:         typeColor: Color(hex: "4ec9b0"),
49:         variableColor: Color(hex: "9cdcfe"),
50:         operatorColor: Color(hex: "d4d4d4"),
51:         sidebarBackground: Color(hex: "252526"),
52:         tabBarBackground: Color(hex: "252526"),
53:         statusBarBackground: Color(hex: "007acc"),
54:         borderColor: Color(hex: "3c3c3c")
55:     )
56:     
57:     static let defaultLight = Theme(
58:         id: "light-default",
59:         name: "Light+ (default)",
60:         isDark: false,
61:         backgroundColor: Color(hex: "ffffff"),
62:         textColor: Color(hex: "000000"),
63:         lineNumberColor: Color(hex: "237893"),
64:         selectionColor: Color(hex: "add6ff"),
65:         cursorColor: Color(hex: "000000"),
66:         keywordColor: Color(hex: "0000ff"),
67:         stringColor: Color(hex: "a31515"),
68:         commentColor: Color(hex: "008000"),
69:         numberColor: Color(hex: "098658"),
70:         functionColor: Color(hex: "795e26"),
71:         typeColor: Color(hex: "267f99"),
72:         variableColor: Color(hex: "001080"),
73:         operatorColor: Color(hex: "000000"),
74:         sidebarBackground: Color(hex: "f3f3f3"),
75:         tabBarBackground: Color(hex: "f3f3f3"),
76:         statusBarBackground: Color(hex: "007acc"),
77:         borderColor: Color(hex: "e7e7e7")
78:     )
79:     
80:     static let monokai = Theme(
81:         id: "monokai",
82:         name: "Monokai",
83:         isDark: true,
84:         backgroundColor: Color(hex: "272822"),
85:         textColor: Color(hex: "f8f8f2"),
86:         lineNumberColor: Color(hex: "90908a"),
87:         selectionColor: Color(hex: "49483e"),
88:         cursorColor: Color(hex: "f8f8f0"),
89:         keywordColor: Color(hex: "f92672"),
90:         stringColor: Color(hex: "e6db74"),
91:         commentColor: Color(hex: "75715e"),
92:         numberColor: Color(hex: "ae81ff"),
93:         functionColor: Color(hex: "a6e22e"),
94:         typeColor: Color(hex: "66d9ef"),
95:         variableColor: Color(hex: "f8f8f2"),
96:         operatorColor: Color(hex: "f92672"),
97:         sidebarBackground: Color(hex: "21201d"),
98:         tabBarBackground: Color(hex: "1e1f1c"),
99:         statusBarBackground: Color(hex: "75715e"),
100:         borderColor: Color(hex: "3b3a32")
101:     )
102:     
103:     static let solarizedDark = Theme(
104:         id: "solarized-dark",
105:         name: "Solarized Dark",
106:         isDark: true,
107:         backgroundColor: Color(hex: "002b36"),
108:         textColor: Color(hex: "839496"),
109:         lineNumberColor: Color(hex: "586e75"),
110:         selectionColor: Color(hex: "073642"),
111:         cursorColor: Color(hex: "839496"),
112:         keywordColor: Color(hex: "859900"),
113:         stringColor: Color(hex: "2aa198"),
114:         commentColor: Color(hex: "586e75"),
115:         numberColor: Color(hex: "d33682"),
116:         functionColor: Color(hex: "268bd2"),
117:         typeColor: Color(hex: "b58900"),
118:         variableColor: Color(hex: "839496"),
119:         operatorColor: Color(hex: "839496"),
120:         sidebarBackground: Color(hex: "00252e"),
121:         tabBarBackground: Color(hex: "003847"),
122:         statusBarBackground: Color(hex: "073642"),
123:         borderColor: Color(hex: "073642")
124:     )
125:     
126:     static let allThemes: [Theme] = [.defaultDark, .defaultLight, .monokai, .solarizedDark]
127: }
128: 
129: // MARK: - Theme Manager
130: 
131: class ThemeManager: ObservableObject {
132:     static let shared = ThemeManager()
133:     
134:     @Published var currentTheme: Theme {
135:         didSet {
136:             UserDefaults.standard.set(currentTheme.id, forKey: "selectedThemeId")
137:         }
138:     }
139:     
140:     @Published var availableThemes: [Theme] = Theme.allThemes
141:     
142:     private init() {
143:         // Load saved theme or use default
144:         let savedThemeId = UserDefaults.standard.string(forKey: "selectedThemeId") ?? Theme.defaultDark.id
145:         currentTheme = Theme.allThemes.first { $0.id == savedThemeId } ?? Theme.defaultDark
146:     }
147:     
148:     func setTheme(_ theme: Theme) {
149:         currentTheme = theme
150:     }
151:     
152:     func setTheme(id: String) {
153:         if let theme = availableThemes.first(where: { $0.id == id }) {
154:             currentTheme = theme
155:         }
156:     }
157: }
158: 
159: // MARK: - Color Hex Extension
160: 
161: extension Color {
162:     init(hex: String) {
163:         let hex = hex.trimmingCharacters(in: CharacterSet.alphanumerics.inverted)
164:         var int: UInt64 = 0
165:         Scanner(string: hex).scanHexInt64(&int)
166:         let a, r, g, b: UInt64
167:         switch hex.count {
168:         case 3: // RGB (12-bit)
169:             (a, r, g, b) = (255, (int >> 8) * 17, (int >> 4 & 0xF) * 17, (int & 0xF) * 17)
170:         case 6: // RGB (24-bit)
171:             (a, r, g, b) = (255, int >> 16, int >> 8 & 0xFF, int & 0xFF)
172:         case 8: // ARGB (32-bit)
173:             (a, r, g, b) = (int >> 24, int >> 16 & 0xFF, int >> 8 & 0xFF, int & 0xFF)
174:         default:
175:             (a, r, g, b) = (1, 1, 1, 0)
176:         }
177:         self.init(
178:             .sRGB,
179:             red: Double(r) / 255,
180:             green: Double(g) / 255,
181:             blue: Double(b) / 255,
182:             opacity: Double(a) / 255
183:         )
184:     }
185: }
186: 


>>>TOOL search
{"query": "EditorView"}
>>>END

---

## üîß TOOL RESULTS

[search]
Found 30 matches:
FULL_FEATURE_TEST_PLAN.md:109: ## 6. SPLIT EDITOR (SplitEditorView.swift - 755 lines)
README.md:29: ‚îÇ  ‚îú‚îÄ‚îÄ EditorView (syntax highlighting, cursor, selection)    ‚îÇ
.claudefluff/agents/worker-autocomplete-keys-2026-02-09T11-35-27-953Z.md:8: Implement FEAT-048 Tab to accept suggestion + FEAT-049 Escape to dismiss autocomplete. Must wire into existing editor views (SyntaxHighlightingTextView / MultiCursorTextView / ContentView IDEEditorView). Use gpt52 for autocomplete logic.
.claudefluff/agents/worker-autocomplete-keys-2026-02-09T11-35-27-953Z.md:817: struct IDEEditorView: View {
.claudefluff/agents/worker-autocomplete-keys-2026-02-09T11-35-27-953Z.md:835: struct IDEEditorView: View {
.claudefluff/agents/worker-autocomplete-keys-2026-02-09T11-35-27-953Z.md:1227: {"query":"SyntaxHighlightingTextView(", "glob":"VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SplitEditorView.swift"}
.claudefluff/agents/worker-autocomplete-keys-2026-02-09T11-35-27-953Z.md:1231: {"query":"editorCore:", "glob":"VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SplitEditorView.swift"}
.claudefluff/agents/worker-autocomplete-keys-2026-02-09T11-35-27-953Z.md:1235: {"query":"SyntaxHighlightingTextView(", "glob":"VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SplitEditorView_Update.swift"}
.claudefluff/agents/worker-autocomplete-keys-2026-02-09T11-35-27-953Z.md:1239: {"query":"editorCore:", "glob":"VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SplitEditorView_Update.swift"}
.claudefluff/agents/worker-autocomplete-keys-2026-02-09T11-35-27-953Z.md:1298: // Compatibility init for older call sites (e.g. SplitEditorView) that pass editorCore explicitly.
.claudefluff/agents/test-nav-6-2026-02-09T19-00-39-456Z.md:54: {"path":"VSCodeiPadOS/VSCodeiPadOS/Views/EditorView.swift"}
.claudefluff/agents/workspace-settings-worker-2026-02-09T11-19-30-291Z.md:140: {"query":"IDEEditorView", "glob":"VSCodeiPadOS/VSCodeiPadOS/**/*.swift"}
.claudefluff/agents/json-tree-viewer-2026-02-09T11-10-23-663Z.md:62: {"query": "struct EditorView", "glob": "*.swift"}
.claudefluff/agents/json-tree-viewer-2026-02-09T11-10-23-663Z.md:303: *   Modified `IDEEditorView` in `ContentView.swift`.
.claudefluff/agents/debugger-gpt52-2026-02-09T10-45-35-325Z.md:148: {"path":"Views/EditorView.swift"}
.claudefluff/agents/debugger-gpt52-2026-02-09T10-45-35-325Z.md:152: {"path":"Views/EditorView.swift", "start_line":1, "end_line":260}
.claudefluff/agents/debugger-gpt52-2026-02-09T10-45-35-325Z.md:338: {"query":"@EnvironmentObject", "glob":"Views/EditorView.swift"}
.claudefluff/agents/debugger-gpt52-2026-02-09T10-45-35-325Z.md:344: {"path":"Views/EditorView.swift", "start_line":1, "end_line":220}
.claudefluff/agents/fix-spliteditorview-2026-02-09T20-30-12-320Z.md:8: Fix VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SplitEditorView.swift line 489:
.claudefluff/agents/fix-spliteditorview-2026-02-09T20-30-12-320Z.md:17: {"path":"VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SplitEditorView.swift","start_line":450,"end_line":520}
.claudefluff/agents/fix-spliteditorview-2026-02-09T20-30-12-320Z.md:34: {"path":"VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SplitEditorView.swift","start_line":460,"end_line":510}
.claudefluff/agents/fix-spliteditorview-2026-02-09T20-30-12-320Z.md:46: File: VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SplitEditorView.swift (lines 461-510 of 774)
.claudefluff/agents/fix-spliteditorview-2026-02-09T20-30-12-320Z.md:70: 483: struct PaneEditorView: View {
.claudefluff/agents/fix-spliteditorview-2026-02-09T20-30-12-320Z.md:490: {"path":"VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SplitEditorView.swift","start_line":470,"end_line":505}
.claudefluff/agents/fix-spliteditorview-2026-02-09T20-30-12-320Z.md:502: File: VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SplitEditorView.swift (lines 471-505 of 774)
.claudefluff/agents/fix-spliteditorview-2026-02-09T20-30-12-320Z.md:516: 483: struct PaneEditorView: View {
.claudefluff/agents/fix-spliteditorview-2026-02-09T20-30-12-320Z.md:569: {"path":"VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SplitEditorView.swift","start_line":480,"end_line":500}
.claudefluff/agents/fix-spliteditorview-2026-02-09T20-30-12-320Z.md:585: File: VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SplitEditorView.swift (lines 481-500 of 774)
.claudefluff/agents/fix-spliteditorview-2026-02-09T20-30-12-320Z.md:589: 483: struct PaneEditorView: View {
.claudefluff/agents/fix-spliteditorview-2026-02-09T20-30-12-320Z.md:645: 355: struct IDEEditorView: View {


>>>TOOL list_dir
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views"}
>>>END

---

## üîß TOOL RESULTS

[list_dir]
üìÅ VSCodeiPadOS/VSCodeiPadOS/Views/
üìÅ Editor/
üìÅ Panels/
   _tmp.txt
   BranchMenu.swift
   CommandPalette.swift
   CommandPaletteView.swift
   DiffComponents.swift
   FileIconView.swift
   FileTreeView.swift
   GoToSymbol.swift
   LaunchConfigView.swift
   QuickOpen.swift
   RunConfigView.swift
   SidebarView.swift
   SnippetPickerView.swift
   StatusBarView.swift
   TabBarView.swift
   TasksView.swift
   WorkspaceSettingsView.swift
   WorkspaceTrustDialog.swift


>>>TOOL list_dir
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Editor"}
>>>END

---

## üîß TOOL RESULTS

[list_dir]
üìÅ VSCodeiPadOS/VSCodeiPadOS/Views/Editor/
   BreadcrumbsView.swift
   ColorPickerView.swift
   EditorSplitView.swift
   GitGutterView.swift
   HoverInfoView.swift
   InlayHintsOverlay.swift
   InlineSuggestionView.swift
   JSONTreeView.swift
   MergeConflictView.swift
   MinimapView.swift
   MultiCursorTextView.swift
   PeekDefinitionView.swift
   SplitEditorView.swift
   StickyHeaderView.swift
   SyntaxHighlightingTextView_Update.swift
   SyntaxHighlightingTextView.swift


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift"}
>>>END

---

## üîß TOOL RESULTS

[read_file]
‚ö†Ô∏è File too large (87040 chars, 1995 lines). Showing first 100 lines.
Use start_line/end_line to read specific sections.

File: VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1: //
2: //  SyntaxHighlightingTextView.swift
3: //  VSCodeiPadOS
4: //
5: //  Upgraded syntax highlighting with VSCode-like colors
6: //
7: 
8: import SwiftUI
9: import UIKit
10: 
11: /// UITextView wrapper with syntax highlighting support
12: struct SyntaxHighlightingTextView: UIViewRepresentable {
13:     @Binding var text: String
14:     let filename: String
15:     @Binding var scrollPosition: Int
16:     @Binding var totalLines: Int
17:     @Binding var visibleLines: Int
18:     @Binding var currentLineNumber: Int
19:     @Binding var currentColumn: Int
20:     @Binding var cursorIndex: Int
21:     @Binding var lineHeight: CGFloat
22:     @Binding var requestedLineSelection: Int?
23:     @Binding var requestedCursorIndex: Int?
24: 
25:     /// Autocomplete key handling hooks (return true if handled)
26:     let onAcceptAutocomplete: (() -> Bool)?
27:     let onDismissAutocomplete: (() -> Bool)?
28: 
29:     let isActive: Bool
30:     let fontSize: CGFloat  // Explicit parameter to trigger SwiftUI updates
31:     @EnvironmentObject var editorCore: EditorCore
32: 
33:     init(
34:         text: Binding<String>,
35:         filename: String,
36:         scrollPosition: Binding<Int>,
37:         totalLines: Binding<Int>,
38:         visibleLines: Binding<Int>,
39:         currentLineNumber: Binding<Int>,
40:         currentColumn: Binding<Int>,
41:         cursorIndex: Binding<Int> = .constant(0),
42:         lineHeight: Binding<CGFloat>,
43:         isActive: Bool,
44:         fontSize: CGFloat = 14.0,
45:         requestedLineSelection: Binding<Int?> = .constant(nil),
46:         requestedCursorIndex: Binding<Int?> = .constant(nil),
47:         onAcceptAutocomplete: (() -> Bool)? = nil,
48:         onDismissAutocomplete: (() -> Bool)? = nil
49:     ) {
50:         self._text = text
51:         self.filename = filename
52:         self._scrollPosition = scrollPosition
53:         self._totalLines = totalLines
54:         self._visibleLines = visibleLines
55:         self._currentLineNumber = currentLineNumber
56:         self._currentColumn = currentColumn
57:         self._cursorIndex = cursorIndex
58:         self._lineHeight = lineHeight
59:         self.isActive = isActive
60:         self.fontSize = fontSize
61:         self._requestedLineSelection = requestedLineSelection
62:         self._requestedCursorIndex = requestedCursorIndex
63:         self.onAcceptAutocomplete = onAcceptAutocomplete
64:         self.onDismissAutocomplete = onDismissAutocomplete
65:     }
66:     
67:     // Compatibility init for older call sites (e.g. SplitEditorView) that pass editorCore explicitly.
68:     init(
69:         text: Binding<String>,
70:         filename: String,
71:         scrollPosition: Binding<Int>,
72:         totalLines: Binding<Int>,
73:         visibleLines: Binding<Int>,
74:         currentLineNumber: Binding<Int>,
75:         currentColumn: Binding<Int>,
76:         cursorIndex: Binding<Int> = .constant(0),
77:         lineHeight: Binding<CGFloat>,
78:         isActive: Bool,
79:         editorCore: EditorCore,
80:         requestedLineSelection: Binding<Int?> = .constant(nil),
81:         requestedCursorIndex: Binding<Int?> = .constant(nil),
82:         onAcceptAutocomplete: (() -> Bool)? = nil,
83:         onDismissAutocomplete: (() -> Bool)? = nil
84:     ) {
85:         self.init(
86:             text: text,
87:             filename: filename,
88:             scrollPosition: scrollPosition,
89:             totalLines: totalLines,
90:             visibleLines: visibleLines,
91:             currentLineNumber: currentLineNumber,
92:             currentColumn: currentColumn,
93:             cursorIndex: cursorIndex,
94:             lineHeight: lineHeight,
95:             isActive: isActive,
96:             fontSize: editorCore.editorFontSize,
97:             requestedLineSelection: requestedLineSelection,
98:             requestedCursorIndex: requestedCursorIndex,
99:             onAcceptAutocomplete: onAcceptAutocomplete,
100:             onDismissAutocomplete: onDismissAutocomplete

... [truncated - 1895 more lines]


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift", "start_line": 350, "end_line": 500}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift (lines 351-500 of 1995)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
351: 
352:                 // Trigger redraw so current-line highlight/indent guides track the caret
353:                 (textView as? EditorTextView)?.setNeedsDisplay()
354: 
355:                 // Update selection in EditorCore for multi-cursor support
356:                 let range = textView.selectedRange
357:                 parent.editorCore.updateSelection(range: range, text: textView.text ?? "")
358: 
359:                 // If user clicks elsewhere (not multi-cursor operation), reset to single cursor
360:                 if !parent.editorCore.multiCursorState.isMultiCursor {
361:                     parent.editorCore.multiCursorState.reset(to: range.location + range.length)
362:                 }
363:             }
364:         }
365:         
366:         // MARK: - UIScrollViewDelegate methods for reliable user scroll detection
367:         
368:         func scrollViewWillBeginDragging(_ scrollView: UIScrollView) {
369:             // User started dragging - set flag immediately to prevent programmatic scroll fighting
370:             isUserScrolling = true
371:             userScrollDebouncer?.invalidate()
372:         }
373:         
374:         func scrollViewDidEndDragging(_ scrollView: UIScrollView, willDecelerate decelerate: Bool) {
375:             // If not decelerating, user stopped scrolling
376:             if !decelerate {
377:                 // Small delay to let any final scroll events settle
378:                 userScrollDebouncer?.invalidate()
379:                 userScrollDebouncer = Timer.scheduledTimer(withTimeInterval: 0.15, repeats: false) { [weak self] _ in
380:                     self?.isUserScrolling = false
381:                 }
382:             }
383:         }
384:         
385:         func scrollViewDidEndDecelerating(_ scrollView: UIScrollView) {
386:             // Deceleration finished - user scroll is complete
387:             userScrollDebouncer?.invalidate()
388:             userScrollDebouncer = Timer.scheduledTimer(withTimeInterval: 0.15, repeats: false) { [weak self] _ in
389:                 self?.isUserScrolling = false
390:             }
391:         }
392:         
393:         func scrollViewDidScroll(_ scrollView: UIScrollView) {
394:             guard let textView = scrollView as? UITextView, !isUpdatingFromMinimap else { return }
395:             
396:             // Note: isUserScrolling is now set by scrollViewWillBeginDragging for reliable detection
397:             // We still use debouncer as a fallback for edge cases
398:             if isUserScrolling {
399:                 userScrollDebouncer?.invalidate()
400:                 userScrollDebouncer = Timer.scheduledTimer(withTimeInterval: 0.3, repeats: false) { [weak self] _ in
401:                     self?.isUserScrolling = false
402:                 }
403:             }
404:             
405:             updateScrollPosition(textView)
406:         }
407:         
408:         func updateLineCount(_ textView: UITextView) {
409:             let lines = textView.text.components(separatedBy: .newlines)
410:             DispatchQueue.main.async {
411:                 self.parent.totalLines = max(1, lines.count)
412:             }
413:         }
414:         
415:         func updateCursorPosition(_ textView: UITextView) {
416:             guard let selectedRange = textView.selectedTextRange else { return }
417:              let cursorPosition = textView.offset(from: textView.beginningOfDocument, to: selectedRange.start)
418:              
419:              let text = textView.text ?? ""
420:              let prefix = String(text.prefix(cursorPosition))
421:              let lines = prefix.components(separatedBy: .newlines)
422:              
423:              let lineNumber = lines.count
424:              let column = (lines.last?.count ?? 0) + 1
425:              
426:              DispatchQueue.main.async {
427:                  self.parent.currentLineNumber = lineNumber
428:                  self.parent.currentColumn = column
429:                  self.parent.cursorIndex = cursorPosition
430:              }
431:         }
432:         
433:         func updateScrollPosition(_ textView: UITextView) {
434:             guard let font = textView.font else { return }
435:             let lineHeight = font.lineHeight
436:             let scrollOffset = textView.contentOffset.y
437:             let line = Int(scrollOffset / lineHeight)
438:             
439:             // Update both synchronously to prevent feedback loop:
440:             // If we update parent.scrollPosition async, there's a race where
441:             // updateUIView sees old binding value != lastKnownScrollPosition
442:             // and scrolls back to the old position, causing jaggy scrolling.
443:             lastKnownScrollPosition = line
444:             parent.scrollPosition = line
445:         }
446:         
447:         func scrollToLine(_ line: Int, in textView: UITextView) {
448:             guard !isUpdatingFromMinimap else { return }
449:             isUpdatingFromMinimap = true
450:             
451:             let lines = textView.text.components(separatedBy: .newlines)
452:             guard line >= 0 && line < lines.count else {
453:                 isUpdatingFromMinimap = false
454:                 return
455:             }
456:             
457:             var characterPosition = 0
458:             for i in 0..<line {
459:                 characterPosition += lines[i].count + 1
460:             }
461:             
462:             if let position = textView.position(from: textView.beginningOfDocument, offset: characterPosition) {
463:                 let rect = textView.caretRect(for: position)
464:                 let targetY = max(0, rect.origin.y)
465:                 textView.setContentOffset(CGPoint(x: 0, y: targetY), animated: true)
466:             }
467:             
468:             DispatchQueue.main.asyncAfter(deadline: .now() + 0.3) {
469:                 self.isUpdatingFromMinimap = false
470:             }
471:         }
472: 
473:         func scrollToAndSelectLine(_ line: Int, in textView: UITextView) {
474:             let lines = textView.text.components(separatedBy: .newlines)
475:             guard line >= 0 && line < lines.count else { return }
476: 
477:             var characterPosition = 0
478:             for i in 0..<line {
479:                 characterPosition += lines[i].count + 1
480:             }
481: 
482:             // FEAT-041: select entire line (excluding trailing newline)
483:             let lineLength = (lines[line] as NSString).length
484:             let range = NSRange(location: characterPosition, length: lineLength)
485:             textView.selectedRange = range
486: 
487:             // Ensure it's visible
488:             scrollToLine(line, in: textView)
489: 
490:             // Update SwiftUI state
491:             updateCursorPosition(textView)
492:             updateScrollPosition(textView)
493:         }
494: 
495:         func applySyntaxHighlighting(to textView: UITextView) {
496:             let theme = ThemeManager.shared.currentTheme
497:             lastThemeId = theme.id
498: 
499:             let highlighter = VSCodeSyntaxHighlighter(theme: theme, fontSize: parent.editorCore.editorFontSize)
500:             let attributedText = highlighter.highlight(textView.text, filename: parent.filename)


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift", "start_line": 1500, "end_line": 1600}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift (lines 1501-1600 of 1995)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1501:         highlightKeywords(attributed, keywords: keywords, color: UIColor(theme.keyword), text: text)
1502:         
1503:         // Constants
1504:         let constants = ["true", "false", "null", "undefined", "NaN", "Infinity"]
1505:         highlightKeywords(attributed, keywords: constants, color: UIColor(theme.variable), text: text)
1506:         
1507:         // Function names (yellow) - regular calls + arrow functions
1508:         let funcNamePattern = "\\b([a-zA-Z_$][a-zA-Z0-9_$]*)\\b(?=\\s*(?:\\(|=>))"
1509:         highlightPattern(attributed, pattern: funcNamePattern, color: UIColor(theme.function), text: text, captureGroup: 1)
1510:         
1511:         // Types (teal)
1512:         let typePattern = "\\b[A-Z][a-zA-Z0-9]*\\b"
1513:         highlightPattern(attributed, pattern: typePattern, color: UIColor(theme.type), text: text)
1514:         
1515:         highlightComments(attributed, text: text, singleLine: "//", multiLineStart: "/*", multiLineEnd: "*/")
1516:         highlightStrings(attributed, text: text)
1517:         highlightJSTemplateLiterals(attributed, text: text)
1518:         highlightNumbers(attributed, text: text)
1519:     }
1520:     
1521:     // MARK: - Python Highlighting
1522:     
1523:     private func highlightPython(_ attributed: NSMutableAttributedString, text: String) {
1524:         let keywords = ["def", "class", "if", "elif", "else", "for", "while", "return",
1525:                        "import", "from", "as", "try", "except", "finally", "raise",
1526:                        "with", "assert", "yield", "lambda", "pass", "break", "continue",
1527:                        "global", "nonlocal", "del", "in", "not", "and", "or", "is",
1528:                        "async", "await", "match", "case"]
1529:         highlightKeywords(attributed, keywords: keywords, color: UIColor(theme.keyword), text: text)
1530:         
1531:         let constants = ["True", "False", "None", "self", "cls"]
1532:         highlightKeywords(attributed, keywords: constants, color: UIColor(theme.variable), text: text)
1533:         
1534:         // Decorators (yellow)
1535:         let decoratorPattern = "@[a-zA-Z_][a-zA-Z0-9_\\.]*"
1536:         highlightPattern(attributed, pattern: decoratorPattern, color: UIColor(theme.function), text: text)
1537:         
1538:         // Function definitions (yellow)
1539:         let funcDefPattern = "(?<=def\\s)[a-zA-Z_][a-zA-Z0-9_]*"
1540:         highlightPattern(attributed, pattern: funcDefPattern, color: UIColor(theme.function), text: text)
1541:         
1542:         // Class names (teal)
1543:         let classPattern = "(?<=class\\s)[a-zA-Z_][a-zA-Z0-9_]*"
1544:         highlightPattern(attributed, pattern: classPattern, color: UIColor(theme.type), text: text)
1545:         
1546:         // Built-in functions (yellow)
1547:         let builtins = ["print", "len", "range", "str", "int", "float", "list", "dict", "set",
1548:                        "tuple", "bool", "type", "isinstance", "hasattr", "getattr", "setattr",
1549:                        "open", "input", "map", "filter", "reduce", "zip", "enumerate",
1550:                        "sorted", "reversed", "min", "max", "sum", "abs", "round",
1551:                        "super", "object", "Exception", "ValueError", "TypeError"]
1552:         highlightKeywords(attributed, keywords: builtins, color: UIColor(theme.function), text: text)
1553:         
1554:         highlightComments(attributed, text: text, singleLine: "#", multiLineStart: nil, multiLineEnd: nil)
1555:         highlightPythonStrings(attributed, text: text)
1556:         highlightNumbers(attributed, text: text)
1557:     }
1558:     
1559:     // MARK: - HTML Highlighting
1560:     
1561:     private func highlightHTML(_ attributed: NSMutableAttributedString, text: String) {
1562:         // Tags (blue)
1563:         let tagPattern = "</?\\s*([a-zA-Z][a-zA-Z0-9-]*)(?=[\\s>])"
1564:         highlightPattern(attributed, pattern: tagPattern, color: UIColor(theme.keyword), text: text)
1565:         
1566:         // Attributes (light blue)
1567:         let attrPattern = "\\s([a-zA-Z][a-zA-Z0-9-]*)\\s*="
1568:         highlightPattern(attributed, pattern: attrPattern, color: UIColor(theme.variable), text: text, captureGroup: 1)
1569:         
1570:         // Angle brackets
1571:         let bracketPattern = "[<>/?]"
1572:         highlightPattern(attributed, pattern: bracketPattern, color: UIColor.gray, text: text)
1573:         
1574:         // Comments
1575:         highlightHTMLComments(attributed, text: text)
1576:         
1577:         // Strings
1578:         highlightStrings(attributed, text: text)
1579:     }
1580:     
1581:     // MARK: - CSS Highlighting
1582:     
1583:     private func highlightCSS(_ attributed: NSMutableAttributedString, text: String) {
1584:         // Selectors (yellow)
1585:         let selectorPattern = "([.#]?[a-zA-Z][a-zA-Z0-9_-]*)\\s*\\{"
1586:         highlightPattern(attributed, pattern: selectorPattern, color: UIColor(theme.function), text: text, captureGroup: 1)
1587:         
1588:         // Properties (light blue)
1589:         let propertyPattern = "([a-zA-Z-]+)\\s*:"
1590:         highlightPattern(attributed, pattern: propertyPattern, color: UIColor(theme.variable), text: text, captureGroup: 1)
1591:         
1592:         // Values with units
1593:         let unitPattern = "\\b(\\d+)(px|em|rem|%|vh|vw|pt|cm|mm|in)\\b"
1594:         highlightPattern(attributed, pattern: unitPattern, color: UIColor(theme.number), text: text)
1595:         
1596:         // Colors
1597:         let hexPattern = "#[0-9a-fA-F]{3,8}\\b"
1598:         highlightPattern(attributed, pattern: hexPattern, color: UIColor(theme.number), text: text)
1599:         
1600:         // Keywords


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift", "start_line": 1900}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift (lines 1901-1995 of 1995)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1901:     }
1902:     
1903:     // MARK: - Helper Methods
1904:     
1905:     private func highlightKeywords(_ attributed: NSMutableAttributedString, keywords: [String], color: UIColor, text: String) {
1906:         for keyword in keywords {
1907:             let pattern = "\\b\(NSRegularExpression.escapedPattern(for: keyword))\\b"
1908:             highlightPattern(attributed, pattern: pattern, color: color, text: text)
1909:         }
1910:     }
1911:     
1912:     private func highlightPattern(_ attributed: NSMutableAttributedString, pattern: String, color: UIColor, text: String, options: NSRegularExpression.Options = [], captureGroup: Int = 0) {
1913:         guard let regex = try? NSRegularExpression(pattern: pattern, options: options) else { return }
1914:         let range = NSRange(location: 0, length: text.utf16.count)
1915:         
1916:         regex.enumerateMatches(in: text, options: [], range: range) { match, _, _ in
1917:             guard let match = match else { return }
1918:             let matchRange = captureGroup > 0 && match.numberOfRanges > captureGroup
1919:                 ? match.range(at: captureGroup)
1920:                 : match.range
1921:             if matchRange.location != NSNotFound {
1922:                 attributed.addAttribute(.foregroundColor, value: color, range: matchRange)
1923:             }
1924:         }
1925:     }
1926:     
1927:     private func highlightStrings(_ attributed: NSMutableAttributedString, text: String) {
1928:         // Double-quoted strings
1929:         let doublePattern = "\"(?:[^\"\\\\]|\\\\.)*\""
1930:         highlightPattern(attributed, pattern: doublePattern, color: UIColor(theme.string), text: text)
1931:         
1932:         // Single-quoted strings
1933:         let singlePattern = "'(?:[^'\\\\]|\\\\.)*'"
1934:         highlightPattern(attributed, pattern: singlePattern, color: UIColor(theme.string), text: text)
1935:     }
1936:     
1937:     private func highlightPythonStrings(_ attributed: NSMutableAttributedString, text: String) {
1938:         // Triple-quoted strings first
1939:         let tripleDoublePattern = "\"\"\"[\\s\\S]*?\"\"\""
1940:         highlightPattern(attributed, pattern: tripleDoublePattern, color: UIColor(theme.string), text: text)
1941:         
1942:         let tripleSinglePattern = "'''[\\s\\S]*?'''"
1943:         highlightPattern(attributed, pattern: tripleSinglePattern, color: UIColor(theme.string), text: text)
1944:         
1945:         // Then regular strings
1946:         highlightStrings(attributed, text: text)
1947:         
1948:         // F-strings (with expressions highlighted differently)
1949:         let fstringPattern = "f\"[^\"]*\"|f'[^']*'"
1950:         highlightPattern(attributed, pattern: fstringPattern, color: UIColor(theme.string), text: text)
1951:     }
1952:     
1953:     private func highlightJSTemplateLiterals(_ attributed: NSMutableAttributedString, text: String) {
1954:         // Template literals
1955:         let templatePattern = "`[^`]*`"
1956:         highlightPattern(attributed, pattern: templatePattern, color: UIColor(theme.string), text: text)
1957:     }
1958:     
1959:     private func highlightComments(_ attributed: NSMutableAttributedString, text: String, singleLine: String?, multiLineStart: String?, multiLineEnd: String?) {
1960:         // Single-line comments
1961:         if let single = singleLine {
1962:             let pattern = "\(NSRegularExpression.escapedPattern(for: single)).*$"
1963:             highlightPattern(attributed, pattern: pattern, color: UIColor(theme.comment), text: text, options: .anchorsMatchLines)
1964:         }
1965:         
1966:         // Multi-line comments
1967:         if let start = multiLineStart, let end = multiLineEnd {
1968:             let pattern = "\(NSRegularExpression.escapedPattern(for: start))[\\s\\S]*?\(NSRegularExpression.escapedPattern(for: end))"
1969:             highlightPattern(attributed, pattern: pattern, color: UIColor(theme.comment), text: text)
1970:         }
1971:     }
1972:     
1973:     private func highlightHTMLComments(_ attributed: NSMutableAttributedString, text: String) {
1974:         let pattern = "<!--[\\s\\S]*?-->"
1975:         highlightPattern(attributed, pattern: pattern, color: UIColor(theme.comment), text: text)
1976:     }
1977:     
1978:     private func highlightNumbers(_ attributed: NSMutableAttributedString, text: String) {
1979:         // Hex numbers
1980:         let hexPattern = "\\b0[xX][0-9a-fA-F]+\\b"
1981:         highlightPattern(attributed, pattern: hexPattern, color: UIColor(theme.number), text: text)
1982:         
1983:         // Binary numbers
1984:         let binPattern = "\\b0[bB][01]+\\b"
1985:         highlightPattern(attributed, pattern: binPattern, color: UIColor(theme.number), text: text)
1986:         
1987:         // Octal numbers
1988:         let octPattern = "\\b0[oO][0-7]+\\b"
1989:         highlightPattern(attributed, pattern: octPattern, color: UIColor(theme.number), text: text)
1990:         
1991:         // Decimal numbers (including floats and scientific notation)
1992:         let decPattern = "\\b\\d+\\.?\\d*([eE][+-]?\\d+)?\\b"
1993:         highlightPattern(attributed, pattern: decPattern, color: UIColor(theme.number), text: text)
1994:     }
1995: }


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift", "start_line": 150, "end_line": 300}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift (lines 151-300 of 1995)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
151:         }
152:         
153:         // Add pinch gesture for zoom
154:         let pinchGesture = UIPinchGestureRecognizer(target: context.coordinator, action: #selector(Coordinator.handlePinch(_:)))
155:         textView.addGestureRecognizer(pinchGesture)
156:         context.coordinator.pinchGesture = pinchGesture
157:         
158:         // Configure text view
159:         textView.isEditable = true
160:         textView.isSelectable = true
161:         textView.autocapitalizationType = .none
162:         textView.autocorrectionType = .no
163:         textView.smartDashesType = .no
164:         textView.smartQuotesType = .no
165:         textView.smartInsertDeleteType = .no
166:         textView.spellCheckingType = .no
167:         
168:         // Set font and appearance (use editorCore.editorFontSize)
169:         textView.font = UIFont.monospacedSystemFont(ofSize: editorCore.editorFontSize, weight: .regular)
170:         textView.textColor = UIColor(ThemeManager.shared.currentTheme.editorForeground)
171:         textView.backgroundColor = UIColor(ThemeManager.shared.currentTheme.editorBackground)
172:         textView.keyboardType = .default
173:         textView.textContainerInset = UIEdgeInsets(top: 8, left: 8, bottom: 8, right: 8)
174:         
175:         // Enable line wrapping
176:         textView.textContainer.lineBreakMode = .byCharWrapping
177:         textView.textContainer.widthTracksTextView = true
178:         
179:         // Calculate line height
180:         if let font = textView.font {
181:             DispatchQueue.main.async {
182:                 self.lineHeight = font.lineHeight
183:             }
184:         }
185:         
186:         // Set initial text with syntax highlighting
187:         textView.text = text
188:         context.coordinator.applySyntaxHighlighting(to: textView)
189:         context.coordinator.updateLineCount(textView)
190:         
191:         return textView
192:     }
193:     
194:     func updateUIView(_ textView: UITextView, context: Context) {
195:         // CRITICAL: Update coordinator's parent reference to current struct
196:         // SwiftUI creates new struct instances on each update, so this keeps
197:         // coordinator in sync with current bindings and properties
198:         context.coordinator.parent = self
199:         
200:         // CRITICAL FIX: Apply initial highlighting FIRST on the very first updateUIView call
201:         // This fixes the bug where syntax highlighting only appears after typing.
202:         // makeUIView applies it, but the view may not be fully in hierarchy yet,
203:         // causing the attributed text to be lost. This ensures it's applied reliably.
204:         if !context.coordinator.hasAppliedInitialHighlighting && !textView.text.isEmpty {
205:             context.coordinator.applySyntaxHighlighting(to: textView)
206:             context.coordinator.hasAppliedInitialHighlighting = true
207:         }
208:         
209:         // Update colors when theme changes
210:         // NOTE: Only set backgroundColor and tintColor here. Do NOT set textColor
211:         // as it interferes with attributedText syntax highlighting colors.
212:         // The foreground color is handled entirely by the attributedText.
213:         textView.backgroundColor = UIColor(ThemeManager.shared.currentTheme.editorBackground)
214:         textView.tintColor = UIColor(ThemeManager.shared.currentTheme.cursor)
215:         
216:         if let editorView = textView as? EditorTextView {
217:             editorView.updateThemeColors(theme: ThemeManager.shared.currentTheme)
218:         }
219:         
220:         // Update font size if changed (using explicit fontSize parameter for proper SwiftUI updates)
221:         if let currentFont = textView.font, currentFont.pointSize != fontSize {
222:             let selectedRange = textView.selectedRange
223:             textView.font = UIFont.monospacedSystemFont(ofSize: fontSize, weight: .regular)
224:             context.coordinator.applySyntaxHighlighting(to: textView)
225:             textView.selectedRange = selectedRange
226:             
227:             // Update line height
228:             if let font = textView.font {
229:                 DispatchQueue.main.async {
230:                     self.lineHeight = font.lineHeight
231:                 }
232:             }
233:         }
234:         
235:         // Update text if changed externally
236:         if textView.text != text {
237:             let selectedRange = textView.selectedRange
238:             textView.text = text
239:             context.coordinator.applySyntaxHighlighting(to: textView)
240:             context.coordinator.hasAppliedInitialHighlighting = true
241:             textView.selectedRange = selectedRange
242:         } else if context.coordinator.lastThemeId != ThemeManager.shared.currentTheme.id {
243:             // Re-apply highlighting if theme changed
244:             context.coordinator.applySyntaxHighlighting(to: textView)
245:         }
246:         
247:         // Handle minimap scrolling - but ONLY if user is NOT actively scrolling
248:         // This prevents the editor from fighting against user scroll due to async binding lag
249:         if scrollPosition != context.coordinator.lastKnownScrollPosition && scrollPosition >= 0 && !context.coordinator.isUserScrolling {
250:             // Update lastKnownScrollPosition FIRST to prevent race condition
251:             // where user scroll gets overridden by stale binding value
252:             context.coordinator.lastKnownScrollPosition = scrollPosition
253:             context.coordinator.scrollToLine(scrollPosition, in: textView)
254:         }
255: 
256:         // Handle line selection requests (e.g. tapping line numbers)
257:         if let requested = requestedLineSelection,
258:            requested != context.coordinator.lastRequestedLineSelection {
259:             context.coordinator.lastRequestedLineSelection = requested
260:             context.coordinator.scrollToAndSelectLine(requested, in: textView)
261:             // Defer @Binding update to avoid "Publishing changes from within view updates"
262:             DispatchQueue.main.async {
263:                 self.requestedLineSelection = nil
264:             }
265:         }
266: 
267:         // Handle cursor index requests (e.g. accepting autocomplete)
268:         if let requested = requestedCursorIndex,
269:            requested != context.coordinator.lastRequestedCursorIndex {
270:             context.coordinator.lastRequestedCursorIndex = requested
271:             textView.selectedRange = NSRange(location: max(0, requested), length: 0)
272:             // Defer @Binding update to avoid "Publishing changes from within view updates"
273:             DispatchQueue.main.async {
274:                 self.requestedCursorIndex = nil
275:             }
276: 
277:             // Update SwiftUI state
278:             context.coordinator.updateCursorPosition(textView)
279:             context.coordinator.updateScrollPosition(textView)
280:         }
281:         
282:         // Note: updateLineCount is called in textViewDidChange, no need to call here
283:         // as it causes unnecessary state churn on every updateUIView
284:     }
285:     
286:     // MARK: - Coordinator
287:     
288:     class Coordinator: NSObject, UITextViewDelegate {
289:         var parent: SyntaxHighlightingTextView
290:         var lastKnownScrollPosition: Int = 0
291:         var lastThemeId: String = ""
292:         var lastRequestedLineSelection: Int? = nil
293:         var lastRequestedCursorIndex: Int? = nil
294:         private var isUpdatingFromMinimap = false
295:         private var highlightDebouncer: Timer?
296:         weak var pinchGesture: UIPinchGestureRecognizer?
297:         private var initialFontSize: CGFloat = 0
298:         
299:         // Track user scroll to prevent programmatic scroll fighting back
300:         private var userScrollDebouncer: Timer?


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift", "start_line": 1300, "end_line": 1400}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift (lines 1301-1400 of 1995)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1301:         case "js", "mjs", "cjs": return .javascript
1302:         case "jsx": return .jsx
1303:         case "ts", "mts", "cts": return .typescript
1304:         case "tsx": return .tsx
1305: 
1306:         case "py", "pyw": return .python
1307:         case "rb", "ruby": return .ruby
1308:         case "go": return .go
1309:         case "rs": return .rust
1310:         case "java": return .java
1311:         case "kt", "kts": return .kotlin
1312: 
1313:         case "c", "h": return .c
1314:         case "cpp", "cc", "cxx", "hpp", "hh", "hxx": return .cpp
1315:         case "m", "mm": return .objectiveC
1316: 
1317:         case "html", "htm": return .html
1318:         case "css": return .css
1319:         case "scss", "sass": return .scss
1320:         case "less": return .less
1321:         case "json", "jsonc": return .json
1322:         case "xml", "plist", "svg": return .xml
1323:         case "yml", "yaml": return .yaml
1324:         case "sql": return .sql
1325: 
1326:         case "sh", "bash", "zsh", "fish": return .shell
1327:         case "dockerfile": return .dockerfile
1328: 
1329:         case "graphql", "gql": return .graphql
1330: 
1331:         case "md", "markdown": return .markdown
1332:         case "php": return .php
1333:         case "env": return .env
1334: 
1335:         default: return .plainText
1336:         }
1337:     }
1338:     
1339:     private func highlight(_ text: String, language: Language) -> NSAttributedString {
1340:         let attributed = NSMutableAttributedString(string: text)
1341:         let fullRange = NSRange(location: 0, length: text.utf16.count)
1342:         
1343:         // Base attributes
1344:         let baseFont = UIFont.monospacedSystemFont(ofSize: baseFontSize, weight: .regular)
1345:         attributed.addAttribute(.font, value: baseFont, range: fullRange)
1346:         attributed.addAttribute(.foregroundColor, value: UIColor(theme.editorForeground), range: fullRange)
1347:         
1348:         // Apply language-specific highlighting
1349:         switch language {
1350:         case .swift: highlightSwift(attributed, text: text)
1351:         case .javascript, .jsx: highlightJavaScript(attributed, text: text, isTS: false)
1352:         case .typescript, .tsx: highlightJavaScript(attributed, text: text, isTS: true)
1353:         case .python: highlightPython(attributed, text: text)
1354:         case .html, .xml: highlightHTML(attributed, text: text)
1355:         case .css, .scss, .less: highlightCSS(attributed, text: text)
1356:         case .json: highlightJSON(attributed, text: text)
1357:         case .markdown: highlightMarkdown(attributed, text: text)
1358:         case .rust: highlightRust(attributed, text: text)
1359:         case .go: highlightGo(attributed, text: text)
1360:         case .java, .kotlin: highlightJava(attributed, text: text)
1361:         case .c, .cpp, .objectiveC: highlightCpp(attributed, text: text)
1362:         case .ruby: highlightRuby(attributed, text: text)
1363:         case .php: highlightPHP(attributed, text: text)
1364:         case .shell, .dockerfile: highlightShell(attributed, text: text)
1365:         case .yaml, .env: highlightYAML(attributed, text: text)
1366:         case .sql: highlightSQL(attributed, text: text)
1367:         case .graphql: highlightGraphQL(attributed, text: text)
1368:         case .plainText: break
1369:         }
1370:         
1371:         // FEAT-038: Bracket Pair Colorization (applied last)
1372:         highlightBracketPairs(attributed, text: text)
1373:         
1374:         return attributed
1375:     }
1376:     
1377:     // MARK: - Bracket Pair Colorization
1378:     
1379:     private func highlightBracketPairs(_ attributed: NSMutableAttributedString, text: String) {
1380:         let brackets: [Character] = ["{", "}", "[", "]", "(", ")"]
1381:         let pairs: [Character: Character] = ["}": "{", "]": "[", ")": "("]
1382:         
1383:         var stack: [(char: Character, index: Int, depth: Int)] = []
1384:         let colors = [
1385:             UIColor(theme.bracketPair1),
1386:             UIColor(theme.bracketPair2),
1387:             UIColor(theme.bracketPair3),
1388:             UIColor(theme.bracketPair4),
1389:             UIColor(theme.bracketPair5),
1390:             UIColor(theme.bracketPair6)
1391:         ]
1392:         
1393:         // Scan text for brackets
1394:         // Note: In a real implementation, we should skip brackets inside strings/comments
1395:         // But since we apply this LAST, we can try to respect existing string/comment colors
1396:         // OR implement a more robust parser. For now, simple scan.
1397:         
1398:         // Optimization: Use scanner or direct iteration
1399:         let nsString = text as NSString
1400:         var index = 0


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift", "start_line": 1600, "end_line": 1700}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift (lines 1601-1700 of 1995)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1601:         let keywords = ["important", "inherit", "initial", "unset", "none", "auto",
1602:                        "block", "inline", "flex", "grid", "absolute", "relative", "fixed"]
1603:         highlightKeywords(attributed, keywords: keywords, color: UIColor(theme.keyword), text: text)
1604:         
1605:         highlightComments(attributed, text: text, singleLine: nil, multiLineStart: "/*", multiLineEnd: "*/")
1606:         highlightStrings(attributed, text: text)
1607:         highlightNumbers(attributed, text: text)
1608:     }
1609:     
1610:     // MARK: - JSON Highlighting
1611:     
1612:     private func highlightJSON(_ attributed: NSMutableAttributedString, text: String) {
1613:         // Keys (light blue)
1614:         let keyPattern = "\"([^\"]+)\"\\s*:"
1615:         highlightPattern(attributed, pattern: keyPattern, color: UIColor(theme.variable), text: text, captureGroup: 1)
1616:         
1617:         // String values (orange)
1618:         highlightStrings(attributed, text: text)
1619:         
1620:         // Numbers (light green)
1621:         highlightNumbers(attributed, text: text)
1622:         
1623:         // Booleans and null (use keyword color)
1624:         let constants = ["true", "false", "null"]
1625:         highlightKeywords(attributed, keywords: constants, color: UIColor(theme.keyword), text: text)
1626:     }
1627:     
1628:     // MARK: - Markdown Highlighting
1629:     
1630:     private func highlightMarkdown(_ attributed: NSMutableAttributedString, text: String) {
1631:         // Headers (blue + bold)
1632:         let headerPattern = "^#{1,6}\\s+.+$"
1633:         highlightPattern(attributed, pattern: headerPattern, color: UIColor(theme.keyword), text: text, options: .anchorsMatchLines)
1634:         
1635:         // Bold (orange)
1636:         let boldPattern = "\\*\\*[^*]+\\*\\*|__[^_]+__"
1637:         highlightPattern(attributed, pattern: boldPattern, color: UIColor(theme.string), text: text)
1638:         
1639:         // Italic
1640:         let italicPattern = "(?<!\\*)\\*[^*]+\\*(?!\\*)|(?<!_)_[^_]+_(?!_)"
1641:         highlightPattern(attributed, pattern: italicPattern, color: UIColor.secondaryLabel, text: text)
1642:         
1643:         // Code blocks (green)
1644:         let codeBlockPattern = "```[\\s\\S]*?```|`[^`]+`"
1645:         highlightPattern(attributed, pattern: codeBlockPattern, color: UIColor(theme.comment), text: text)
1646:         
1647:         // Links (light blue)
1648:         let linkPattern = "\\[[^\\]]+\\]\\([^)]+\\)"
1649:         highlightPattern(attributed, pattern: linkPattern, color: UIColor(theme.variable), text: text)
1650:         
1651:         // Lists
1652:         let listPattern = "^\\s*[-*+]\\s"
1653:         highlightPattern(attributed, pattern: listPattern, color: UIColor(theme.keyword), text: text, options: .anchorsMatchLines)
1654:     }
1655:     
1656:     // MARK: - Rust Highlighting
1657:     
1658:     private func highlightRust(_ attributed: NSMutableAttributedString, text: String) {
1659:         let keywords = ["fn", "let", "mut", "const", "if", "else", "match", "loop", "while", "for",
1660:                        "return", "struct", "enum", "impl", "trait", "type", "use", "mod", "pub",
1661:                        "self", "Self", "super", "crate", "as", "in", "ref", "move", "async", "await",
1662:                        "where", "unsafe", "extern", "dyn", "static", "break", "continue"]
1663:         highlightKeywords(attributed, keywords: keywords, color: UIColor(theme.keyword), text: text)
1664:         
1665:         let types = ["i8", "i16", "i32", "i64", "i128", "isize", "u8", "u16", "u32", "u64", "u128", "usize",
1666:                     "f32", "f64", "bool", "char", "str", "String", "Vec", "Option", "Result", "Box"]
1667:         highlightKeywords(attributed, keywords: types, color: UIColor(theme.type), text: text)
1668:         
1669:         let constants = ["true", "false", "None", "Some", "Ok", "Err"]
1670:         highlightKeywords(attributed, keywords: constants, color: UIColor(theme.variable), text: text)
1671:         
1672:         // Macros (yellow)
1673:         let macroPattern = "[a-zA-Z_][a-zA-Z0-9_]*!"
1674:         highlightPattern(attributed, pattern: macroPattern, color: UIColor(theme.function), text: text)
1675:         
1676:         // Lifetimes (orange)
1677:         let lifetimePattern = "'[a-zA-Z_][a-zA-Z0-9_]*"
1678:         highlightPattern(attributed, pattern: lifetimePattern, color: UIColor(theme.string), text: text)
1679:         
1680:         highlightComments(attributed, text: text, singleLine: "//", multiLineStart: "/*", multiLineEnd: "*/")
1681:         highlightStrings(attributed, text: text)
1682:         highlightNumbers(attributed, text: text)
1683:     }
1684:     
1685:     // MARK: - Go Highlighting
1686:     
1687:     private func highlightGo(_ attributed: NSMutableAttributedString, text: String) {
1688:         let keywords = ["func", "var", "const", "type", "struct", "interface", "map", "chan",
1689:                        "if", "else", "for", "range", "switch", "case", "default", "select",
1690:                        "return", "break", "continue", "goto", "fallthrough", "defer", "go",
1691:                        "package", "import"]
1692:         highlightKeywords(attributed, keywords: keywords, color: UIColor(theme.keyword), text: text)
1693:         
1694:         let types = ["int", "int8", "int16", "int32", "int64", "uint", "uint8", "uint16", "uint32", "uint64",
1695:                     "float32", "float64", "complex64", "complex128", "byte", "rune", "string", "bool", "error"]
1696:         highlightKeywords(attributed, keywords: types, color: UIColor(theme.type), text: text)
1697:         
1698:         let constants = ["true", "false", "nil", "iota"]
1699:         highlightKeywords(attributed, keywords: constants, color: UIColor(theme.variable), text: text)
1700:         


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift", "start_line": 1800, "end_line": 1900}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift (lines 1801-1900 of 1995)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1801:         let varPattern = "\\$[a-zA-Z_][a-zA-Z0-9_]*"
1802:         highlightPattern(attributed, pattern: varPattern, color: UIColor(theme.variable), text: text)
1803:         
1804:         highlightComments(attributed, text: text, singleLine: "//", multiLineStart: "/*", multiLineEnd: "*/")
1805:         highlightStrings(attributed, text: text)
1806:         highlightNumbers(attributed, text: text)
1807:     }
1808:     
1809:     // MARK: - Shell Highlighting
1810:     
1811:     private func highlightShell(_ attributed: NSMutableAttributedString, text: String) {
1812:         let keywords = ["if", "then", "else", "elif", "fi", "for", "while", "do", "done", "case", "esac",
1813:                        "function", "return", "exit", "break", "continue", "local", "export", "readonly",
1814:                        "source", "alias", "unalias", "set", "unset", "shift", "eval", "exec",
1815:                        "echo", "printf", "read", "cd", "pwd", "ls", "mkdir", "rm", "cp", "mv"]
1816:         highlightKeywords(attributed, keywords: keywords, color: UIColor(theme.keyword), text: text)
1817:         
1818:         // Variables (light blue)
1819:         let varPattern = "\\$[a-zA-Z_][a-zA-Z0-9_]*|\\$\\{[^}]+\\}"
1820:         highlightPattern(attributed, pattern: varPattern, color: UIColor(theme.variable), text: text)
1821:         
1822:         highlightComments(attributed, text: text, singleLine: "#", multiLineStart: nil, multiLineEnd: nil)
1823:         highlightStrings(attributed, text: text)
1824:         highlightNumbers(attributed, text: text)
1825:     }
1826:     
1827:     // MARK: - YAML Highlighting
1828:     
1829:     private func highlightYAML(_ attributed: NSMutableAttributedString, text: String) {
1830:         // Keys (light blue)
1831:         let keyPattern = "^\\s*([a-zA-Z_][a-zA-Z0-9_-]*)\\s*:"
1832:         highlightPattern(attributed, pattern: keyPattern, color: UIColor(theme.variable), text: text, options: .anchorsMatchLines, captureGroup: 1)
1833:         
1834:         // Booleans and null
1835:         let constants = ["true", "false", "yes", "no", "on", "off", "null", "~"]
1836:         highlightKeywords(attributed, keywords: constants, color: UIColor(theme.variable), text: text)
1837:         
1838:         highlightComments(attributed, text: text, singleLine: "#", multiLineStart: nil, multiLineEnd: nil)
1839:         highlightStrings(attributed, text: text)
1840:         highlightNumbers(attributed, text: text)
1841:     }
1842:     
1843:     // MARK: - SQL Highlighting
1844:     
1845:     private func highlightSQL(_ attributed: NSMutableAttributedString, text: String) {
1846:         let keywords = ["SELECT", "FROM", "WHERE", "AND", "OR", "NOT", "IN", "LIKE", "BETWEEN",
1847:                        "INSERT", "INTO", "VALUES", "UPDATE", "SET", "DELETE", "CREATE", "ALTER", "DROP",
1848:                        "TABLE", "INDEX", "VIEW", "DATABASE", "SCHEMA", "PRIMARY", "KEY", "FOREIGN", "REFERENCES",
1849:                        "JOIN", "INNER", "LEFT", "RIGHT", "OUTER", "FULL", "ON", "AS", "DISTINCT",
1850:                        "ORDER", "BY", "ASC", "DESC", "GROUP", "HAVING", "LIMIT", "OFFSET", "UNION",
1851:                        "NULL", "IS", "TRUE", "FALSE", "CASE", "WHEN", "THEN", "ELSE", "END",
1852:                        "COUNT", "SUM", "AVG", "MIN", "MAX", "COALESCE", "CAST",
1853:                        "select", "from", "where", "and", "or", "not", "in", "like", "between",
1854:                        "insert", "into", "values", "update", "set", "delete", "create", "alter", "drop",
1855:                        "table", "index", "view", "database", "schema", "primary", "key", "foreign", "references",
1856:                        "join", "inner", "left", "right", "outer", "full", "on", "as", "distinct",
1857:                        "order", "by", "asc", "desc", "group", "having", "limit", "offset", "union",
1858:                        "null", "is", "true", "false", "case", "when", "then", "else", "end"]
1859:         highlightKeywords(attributed, keywords: keywords, color: UIColor(theme.keyword), text: text)
1860:         
1861:         let types = ["INT", "INTEGER", "BIGINT", "SMALLINT", "TINYINT", "FLOAT", "DOUBLE", "DECIMAL",
1862:                     "VARCHAR", "CHAR", "TEXT", "BLOB", "DATE", "TIME", "DATETIME", "TIMESTAMP", "BOOLEAN",
1863:                     "int", "integer", "bigint", "smallint", "tinyint", "float", "double", "decimal",
1864:                     "varchar", "char", "text", "blob", "date", "time", "datetime", "timestamp", "boolean"]
1865:         highlightKeywords(attributed, keywords: types, color: UIColor(theme.type), text: text)
1866:         
1867:         highlightComments(attributed, text: text, singleLine: "--", multiLineStart: "/*", multiLineEnd: "*/")
1868:         highlightStrings(attributed, text: text)
1869:         highlightNumbers(attributed, text: text)
1870:     }
1871:     
1872:     // MARK: - GraphQL Highlighting
1873:     
1874:     private func highlightGraphQL(_ attributed: NSMutableAttributedString, text: String) {
1875:         // Keywords
1876:         let keywords = ["query", "mutation", "subscription", "fragment", "on", "type", 
1877:                        "interface", "union", "enum", "scalar", "input", "extend", 
1878:                        "directive", "schema", "implements"]
1879:         highlightKeywords(attributed, keywords: keywords, color: UIColor(theme.keyword), text: text)
1880:         
1881:         // Built-in scalar types
1882:         let types = ["Int", "Float", "String", "Boolean", "ID"]
1883:         highlightKeywords(attributed, keywords: types, color: UIColor(theme.type), text: text)
1884:         
1885:         // Variables ($name)
1886:         let variablePattern = "\\$[a-zA-Z_][a-zA-Z0-9_]*"
1887:         highlightPattern(attributed, pattern: variablePattern, color: UIColor(theme.variable), text: text)
1888:         
1889:         // Directives (@deprecated, @skip, @include, etc.)
1890:         let directivePattern = "@[a-zA-Z_][a-zA-Z0-9_]*"
1891:         highlightPattern(attributed, pattern: directivePattern, color: UIColor(theme.function), text: text)
1892:         
1893:         // Comments (# single line)
1894:         highlightComments(attributed, text: text, singleLine: "#", multiLineStart: nil, multiLineEnd: nil)
1895:         
1896:         // Strings
1897:         highlightStrings(attributed, text: text)
1898:         
1899:         // Numbers
1900:         highlightNumbers(attributed, text: text)


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift", "start_line": 950, "end_line": 1050}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift (lines 951-1050 of 1995)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
951:         ))
952:         
953:         // Toggle Terminal: Cmd+J (VS Code's shortcut)
954:         let toggleTerminalCmd = UIKeyCommand(
955:             input: "j",
956:             modifierFlags: .command,
957:             action: #selector(handleToggleTerminal),
958:             discoverabilityTitle: "Toggle Terminal"
959:         )
960:         toggleTerminalCmd.wantsPriorityOverSystemBehavior = true
961:         commands.append(toggleTerminalCmd)
962:         
963:         // AI Assistant: Cmd+Shift+A
964:         commands.append(UIKeyCommand(
965:             input: "a",
966:             modifierFlags: [.command, .shift],
967:             action: #selector(handleShowAIAssistant),
968:             discoverabilityTitle: "AI Assistant"
969:         ))
970:         
971:         // Toggle Sidebar: Cmd+B
972:         commands.append(UIKeyCommand(
973:             input: "b",
974:             modifierFlags: .command,
975:             action: #selector(handleToggleSidebar),
976:             discoverabilityTitle: "Toggle Sidebar"
977:         ))
978:         
979:         // Quick Open: Cmd+P
980:         commands.append(UIKeyCommand(
981:             input: "p",
982:             modifierFlags: .command,
983:             action: #selector(handleShowQuickOpen),
984:             discoverabilityTitle: "Quick Open"
985:         ))
986:         
987:         // New File: Cmd+N
988:         let newFileCmd = UIKeyCommand(
989:             input: "n",
990:             modifierFlags: .command,
991:             action: #selector(handleNewFile),
992:             discoverabilityTitle: "New File"
993:         )
994:         newFileCmd.wantsPriorityOverSystemBehavior = true
995:         commands.append(newFileCmd)
996:         
997:         // Save: Cmd+S
998:         commands.append(UIKeyCommand(
999:             input: "s",
1000:             modifierFlags: .command,
1001:             action: #selector(handleSaveFile),
1002:             discoverabilityTitle: "Save"
1003:         ))
1004:         
1005:         // Close Tab: Cmd+W
1006:         let closeTabCmd = UIKeyCommand(
1007:             input: "w",
1008:             modifierFlags: .command,
1009:             action: #selector(handleCloseTab),
1010:             discoverabilityTitle: "Close Tab"
1011:         )
1012:         closeTabCmd.wantsPriorityOverSystemBehavior = true
1013:         commands.append(closeTabCmd)
1014:         
1015:         // Find: Cmd+F
1016:         let findCmd = UIKeyCommand(
1017:             input: "f",
1018:             modifierFlags: .command,
1019:             action: #selector(handleFind),
1020:             discoverabilityTitle: "Find"
1021:         )
1022:         findCmd.wantsPriorityOverSystemBehavior = true
1023:         commands.append(findCmd)
1024:         
1025:         // Zoom In: Cmd+=
1026:         commands.append(UIKeyCommand(
1027:             input: "=",
1028:             modifierFlags: .command,
1029:             action: #selector(handleZoomIn),
1030:             discoverabilityTitle: "Zoom In"
1031:         ))
1032:         
1033:         // Zoom Out: Cmd+-
1034:         commands.append(UIKeyCommand(
1035:             input: "-",
1036:             modifierFlags: .command,
1037:             action: #selector(handleZoomOut),
1038:             discoverabilityTitle: "Zoom Out"
1039:         ))
1040:         
1041:         return commands
1042:     }
1043:     
1044:     @objc func handlePeekDefinition() {
1045:         onPeekDefinition?()
1046:     }
1047: 
1048:     @objc func handleGoToLine() {
1049:         onGoToLine?()
1050:     }


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift", "start_line": 1200, "end_line": 1300}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift (lines 1201-1300 of 1995)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1201:             identifier: UIAction.Identifier("com.vscode.formatDocument"),
1202:             handler: { [weak self] _ in
1203:                 self?.formatDocument(nil)
1204:             }
1205:         )
1206:         
1207:         let toggleCommentAction = UIAction(
1208:             title: "Toggle Comment",
1209:             image: UIImage(systemName: "text.quote"),
1210:             identifier: UIAction.Identifier("com.vscode.toggleComment"),
1211:             handler: { [weak self] _ in
1212:                 self?.toggleComment(nil)
1213:             }
1214:         )
1215:         
1216:         // Group custom actions
1217:         let customMenu = UIMenu(
1218:             title: "",
1219:             identifier: UIMenu.Identifier("com.vscode.customActions"),
1220:             options: [.displayInline],
1221:             children: [
1222:                 goToDefinitionAction,
1223:                 peekDefinitionAction,
1224:                 findReferencesAction,
1225:                 formatDocumentAction,
1226:                 toggleCommentAction
1227:             ]
1228:         )
1229:         
1230:         // Insert custom menu after standard edit menu
1231:         builder.insertChild(customMenu, atStartOfMenu: .text)
1232:     }
1233: }
1234: 
1235: // MARK: - VSCode-Style Syntax Highlighter
1236: 
1237: enum Language {
1238:     case swift
1239: 
1240:     case javascript
1241:     case typescript
1242:     case jsx
1243:     case tsx
1244: 
1245:     case python
1246:     case ruby
1247:     case go
1248:     case rust
1249:     case java
1250:     case kotlin
1251: 
1252:     case c
1253:     case cpp
1254:     case objectiveC
1255: 
1256:     case html
1257:     case css
1258:     case scss
1259:     case less
1260:     case json
1261:     case xml
1262:     case yaml
1263:     case sql
1264: 
1265:     case shell
1266:     case dockerfile
1267:     case graphql
1268:     case markdown
1269:     case php
1270:     case env
1271: 
1272:     case plainText
1273: }
1274: 
1275: struct VSCodeSyntaxHighlighter {
1276:     private let baseFontSize: CGFloat
1277:     let theme: Theme
1278:     
1279:     init(theme: Theme = ThemeManager.shared.currentTheme, fontSize: CGFloat = 14) {
1280:         self.theme = theme
1281:         self.baseFontSize = fontSize
1282:     }
1283:     
1284:     func highlight(_ text: String, filename: String) -> NSAttributedString {
1285:         let language = detectLanguage(from: filename)
1286:         return highlight(text, language: language)
1287:     }
1288:     
1289:     private func detectLanguage(from filename: String) -> Language {
1290:         let lower = filename.lowercased()
1291:         let ext = (filename as NSString).pathExtension.lowercased()
1292: 
1293:         // Special-case filenames without extensions
1294:         if (filename as NSString).lastPathComponent.lowercased() == "dockerfile" { return .dockerfile }
1295:         if (filename as NSString).lastPathComponent.lowercased() == ".env" { return .env }
1296:         if lower.hasSuffix("/.env") { return .env }
1297: 
1298:         switch ext {
1299:         case "swift": return .swift
1300: 


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift", "start_line": 200, "end_line": 400}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift (lines 201-400 of 1995)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
201:         // This fixes the bug where syntax highlighting only appears after typing.
202:         // makeUIView applies it, but the view may not be fully in hierarchy yet,
203:         // causing the attributed text to be lost. This ensures it's applied reliably.
204:         if !context.coordinator.hasAppliedInitialHighlighting && !textView.text.isEmpty {
205:             context.coordinator.applySyntaxHighlighting(to: textView)
206:             context.coordinator.hasAppliedInitialHighlighting = true
207:         }
208:         
209:         // Update colors when theme changes
210:         // NOTE: Only set backgroundColor and tintColor here. Do NOT set textColor
211:         // as it interferes with attributedText syntax highlighting colors.
212:         // The foreground color is handled entirely by the attributedText.
213:         textView.backgroundColor = UIColor(ThemeManager.shared.currentTheme.editorBackground)
214:         textView.tintColor = UIColor(ThemeManager.shared.currentTheme.cursor)
215:         
216:         if let editorView = textView as? EditorTextView {
217:             editorView.updateThemeColors(theme: ThemeManager.shared.currentTheme)
218:         }
219:         
220:         // Update font size if changed (using explicit fontSize parameter for proper SwiftUI updates)
221:         if let currentFont = textView.font, currentFont.pointSize != fontSize {
222:             let selectedRange = textView.selectedRange
223:             textView.font = UIFont.monospacedSystemFont(ofSize: fontSize, weight: .regular)
224:             context.coordinator.applySyntaxHighlighting(to: textView)
225:             textView.selectedRange = selectedRange
226:             
227:             // Update line height
228:             if let font = textView.font {
229:                 DispatchQueue.main.async {
230:                     self.lineHeight = font.lineHeight
231:                 }
232:             }
233:         }
234:         
235:         // Update text if changed externally
236:         if textView.text != text {
237:             let selectedRange = textView.selectedRange
238:             textView.text = text
239:             context.coordinator.applySyntaxHighlighting(to: textView)
240:             context.coordinator.hasAppliedInitialHighlighting = true
241:             textView.selectedRange = selectedRange
242:         } else if context.coordinator.lastThemeId != ThemeManager.shared.currentTheme.id {
243:             // Re-apply highlighting if theme changed
244:             context.coordinator.applySyntaxHighlighting(to: textView)
245:         }
246:         
247:         // Handle minimap scrolling - but ONLY if user is NOT actively scrolling
248:         // This prevents the editor from fighting against user scroll due to async binding lag
249:         if scrollPosition != context.coordinator.lastKnownScrollPosition && scrollPosition >= 0 && !context.coordinator.isUserScrolling {
250:             // Update lastKnownScrollPosition FIRST to prevent race condition
251:             // where user scroll gets overridden by stale binding value
252:             context.coordinator.lastKnownScrollPosition = scrollPosition
253:             context.coordinator.scrollToLine(scrollPosition, in: textView)
254:         }
255: 
256:         // Handle line selection requests (e.g. tapping line numbers)
257:         if let requested = requestedLineSelection,
258:            requested != context.coordinator.lastRequestedLineSelection {
259:             context.coordinator.lastRequestedLineSelection = requested
260:             context.coordinator.scrollToAndSelectLine(requested, in: textView)
261:             // Defer @Binding update to avoid "Publishing changes from within view updates"
262:             DispatchQueue.main.async {
263:                 self.requestedLineSelection = nil
264:             }
265:         }
266: 
267:         // Handle cursor index requests (e.g. accepting autocomplete)
268:         if let requested = requestedCursorIndex,
269:            requested != context.coordinator.lastRequestedCursorIndex {
270:             context.coordinator.lastRequestedCursorIndex = requested
271:             textView.selectedRange = NSRange(location: max(0, requested), length: 0)
272:             // Defer @Binding update to avoid "Publishing changes from within view updates"
273:             DispatchQueue.main.async {
274:                 self.requestedCursorIndex = nil
275:             }
276: 
277:             // Update SwiftUI state
278:             context.coordinator.updateCursorPosition(textView)
279:             context.coordinator.updateScrollPosition(textView)
280:         }
281:         
282:         // Note: updateLineCount is called in textViewDidChange, no need to call here
283:         // as it causes unnecessary state churn on every updateUIView
284:     }
285:     
286:     // MARK: - Coordinator
287:     
288:     class Coordinator: NSObject, UITextViewDelegate {
289:         var parent: SyntaxHighlightingTextView
290:         var lastKnownScrollPosition: Int = 0
291:         var lastThemeId: String = ""
292:         var lastRequestedLineSelection: Int? = nil
293:         var lastRequestedCursorIndex: Int? = nil
294:         private var isUpdatingFromMinimap = false
295:         private var highlightDebouncer: Timer?
296:         weak var pinchGesture: UIPinchGestureRecognizer?
297:         private var initialFontSize: CGFloat = 0
298:         
299:         // Track user scroll to prevent programmatic scroll fighting back
300:         private var userScrollDebouncer: Timer?
301:         var isUserScrolling = false
302: 
303:         // FEAT-044: Matching bracket highlight state
304:         private var bracketHighlightRanges: [NSRange] = []
305:         
306:         // Track if initial highlighting has been applied (fixes highlighting not appearing on file open)
307:         var hasAppliedInitialHighlighting = false
308:         
309:         init(_ parent: SyntaxHighlightingTextView) {
310:             self.parent = parent
311:         }
312:         
313:         func textViewDidBeginEditing(_ textView: UITextView) {
314:             // Ensure syntax highlighting is current when user begins editing
315:             // This handles cases where text was set but highlighting hasn't run yet
316:             applySyntaxHighlighting(to: textView)
317:         }
318:         
319:         func textViewDidChange(_ textView: UITextView) {
320:             // Update parent text
321:             parent.text = textView.text
322:             
323:             // Set typing attributes IMMEDIATELY so new characters have proper base styling
324:             // This prevents flicker during the debounce period
325:             let theme = ThemeManager.shared.currentTheme
326:             let fontSize = parent.editorCore.editorFontSize
327:             textView.typingAttributes = [
328:                 .font: UIFont.monospacedSystemFont(ofSize: fontSize, weight: .regular),
329:                 .foregroundColor: UIColor(theme.editorForeground)
330:             ]
331:             
332:             // Debounced syntax highlighting for performance (reduced from 0.15s to 0.08s)
333:             highlightDebouncer?.invalidate()
334:             highlightDebouncer = Timer.scheduledTimer(withTimeInterval: 0.08, repeats: false) { [weak self] _ in
335:                 DispatchQueue.main.async {
336:                     self?.applySyntaxHighlighting(to: textView)
337:                 }
338:             }
339:             
340:             updateLineCount(textView)
341:             updateCursorPosition(textView)
342:         }
343:         
344:         func textViewDidChangeSelection(_ textView: UITextView) {
345:             if !isUpdatingFromMinimap {
346:                 updateCursorPosition(textView)
347:                 updateScrollPosition(textView)
348: 
349:                 // FEAT-044: Matching bracket highlight
350:                 updateMatchingBracketHighlight(textView)
351: 
352:                 // Trigger redraw so current-line highlight/indent guides track the caret
353:                 (textView as? EditorTextView)?.setNeedsDisplay()
354: 
355:                 // Update selection in EditorCore for multi-cursor support
356:                 let range = textView.selectedRange
357:                 parent.editorCore.updateSelection(range: range, text: textView.text ?? "")
358: 
359:                 // If user clicks elsewhere (not multi-cursor operation), reset to single cursor
360:                 if !parent.editorCore.multiCursorState.isMultiCursor {
361:                     parent.editorCore.multiCursorState.reset(to: range.location + range.length)
362:                 }
363:             }
364:         }
365:         
366:         // MARK: - UIScrollViewDelegate methods for reliable user scroll detection
367:         
368:         func scrollViewWillBeginDragging(_ scrollView: UIScrollView) {
369:             // User started dragging - set flag immediately to prevent programmatic scroll fighting
370:             isUserScrolling = true
371:             userScrollDebouncer?.invalidate()
372:         }
373:         
374:         func scrollViewDidEndDragging(_ scrollView: UIScrollView, willDecelerate decelerate: Bool) {
375:             // If not decelerating, user stopped scrolling
376:             if !decelerate {
377:                 // Small delay to let any final scroll events settle
378:                 userScrollDebouncer?.invalidate()
379:                 userScrollDebouncer = Timer.scheduledTimer(withTimeInterval: 0.15, repeats: false) { [weak self] _ in
380:                     self?.isUserScrolling = false
381:                 }
382:             }
383:         }
384:         
385:         func scrollViewDidEndDecelerating(_ scrollView: UIScrollView) {
386:             // Deceleration finished - user scroll is complete
387:             userScrollDebouncer?.invalidate()
388:             userScrollDebouncer = Timer.scheduledTimer(withTimeInterval: 0.15, repeats: false) { [weak self] _ in
389:                 self?.isUserScrolling = false
390:             }
391:         }
392:         
393:         func scrollViewDidScroll(_ scrollView: UIScrollView) {
394:             guard let textView = scrollView as? UITextView, !isUpdatingFromMinimap else { return }
395:             
396:             // Note: isUserScrolling is now set by scrollViewWillBeginDragging for reliable detection
397:             // We still use debouncer as a fallback for edge cases
398:             if isUserScrolling {
399:                 userScrollDebouncer?.invalidate()
400:                 userScrollDebouncer = Timer.scheduledTimer(withTimeInterval: 0.3, repeats: false) { [weak self] _ in


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift", "start_line": 50, "end_line": 150}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift (lines 51-150 of 1995)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
51:         self.filename = filename
52:         self._scrollPosition = scrollPosition
53:         self._totalLines = totalLines
54:         self._visibleLines = visibleLines
55:         self._currentLineNumber = currentLineNumber
56:         self._currentColumn = currentColumn
57:         self._cursorIndex = cursorIndex
58:         self._lineHeight = lineHeight
59:         self.isActive = isActive
60:         self.fontSize = fontSize
61:         self._requestedLineSelection = requestedLineSelection
62:         self._requestedCursorIndex = requestedCursorIndex
63:         self.onAcceptAutocomplete = onAcceptAutocomplete
64:         self.onDismissAutocomplete = onDismissAutocomplete
65:     }
66:     
67:     // Compatibility init for older call sites (e.g. SplitEditorView) that pass editorCore explicitly.
68:     init(
69:         text: Binding<String>,
70:         filename: String,
71:         scrollPosition: Binding<Int>,
72:         totalLines: Binding<Int>,
73:         visibleLines: Binding<Int>,
74:         currentLineNumber: Binding<Int>,
75:         currentColumn: Binding<Int>,
76:         cursorIndex: Binding<Int> = .constant(0),
77:         lineHeight: Binding<CGFloat>,
78:         isActive: Bool,
79:         editorCore: EditorCore,
80:         requestedLineSelection: Binding<Int?> = .constant(nil),
81:         requestedCursorIndex: Binding<Int?> = .constant(nil),
82:         onAcceptAutocomplete: (() -> Bool)? = nil,
83:         onDismissAutocomplete: (() -> Bool)? = nil
84:     ) {
85:         self.init(
86:             text: text,
87:             filename: filename,
88:             scrollPosition: scrollPosition,
89:             totalLines: totalLines,
90:             visibleLines: visibleLines,
91:             currentLineNumber: currentLineNumber,
92:             currentColumn: currentColumn,
93:             cursorIndex: cursorIndex,
94:             lineHeight: lineHeight,
95:             isActive: isActive,
96:             fontSize: editorCore.editorFontSize,
97:             requestedLineSelection: requestedLineSelection,
98:             requestedCursorIndex: requestedCursorIndex,
99:             onAcceptAutocomplete: onAcceptAutocomplete,
100:             onDismissAutocomplete: onDismissAutocomplete
101:         )
102:     }
103: 
104:     func makeCoordinator() -> Coordinator {
105:         Coordinator(self)
106:     }
107:     
108:     func makeUIView(context: Context) -> UITextView {
109:         let textView = EditorTextView()
110:         textView.delegate = context.coordinator
111: 
112:         // Autocomplete hooks
113:         textView.onAcceptAutocomplete = onAcceptAutocomplete
114:         textView.onDismissAutocomplete = onDismissAutocomplete
115: 
116:         textView.onPeekDefinition = {
117:             context.coordinator.handlePeekDefinition(in: textView)
118:         }
119: 
120:         textView.onEscape = {
121:             context.coordinator.handleEscape()
122:         }
123: 
124:         textView.onGoToLine = {
125:             self.editorCore.showGoToLine = true
126:         }
127:         
128:         // Wire up custom context menu actions
129:         textView.onGoToDefinition = {
130:             context.coordinator.handleGoToDefinition(in: textView)
131:         }
132:         
133:         textView.onFindReferences = {
134:             context.coordinator.handleFindReferences(in: textView)
135:         }
136:         
137:         textView.onFormatDocument = {
138:             context.coordinator.handleFormatDocument(in: textView)
139:         }
140:         
141:         textView.onToggleComment = {
142:             context.coordinator.handleToggleComment(in: textView)
143:         }
144:         
145:         textView.onFold = {
146:             context.coordinator.handleFold(in: textView)
147:         }
148:         
149:         textView.onUnfold = {
150:             context.coordinator.handleUnfold(in: textView)


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift", "start_line": 200, "end_line": 250}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift (lines 201-250 of 1995)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
201:         // This fixes the bug where syntax highlighting only appears after typing.
202:         // makeUIView applies it, but the view may not be fully in hierarchy yet,
203:         // causing the attributed text to be lost. This ensures it's applied reliably.
204:         if !context.coordinator.hasAppliedInitialHighlighting && !textView.text.isEmpty {
205:             context.coordinator.applySyntaxHighlighting(to: textView)
206:             context.coordinator.hasAppliedInitialHighlighting = true
207:         }
208:         
209:         // Update colors when theme changes
210:         // NOTE: Only set backgroundColor and tintColor here. Do NOT set textColor
211:         // as it interferes with attributedText syntax highlighting colors.
212:         // The foreground color is handled entirely by the attributedText.
213:         textView.backgroundColor = UIColor(ThemeManager.shared.currentTheme.editorBackground)
214:         textView.tintColor = UIColor(ThemeManager.shared.currentTheme.cursor)
215:         
216:         if let editorView = textView as? EditorTextView {
217:             editorView.updateThemeColors(theme: ThemeManager.shared.currentTheme)
218:         }
219:         
220:         // Update font size if changed (using explicit fontSize parameter for proper SwiftUI updates)
221:         if let currentFont = textView.font, currentFont.pointSize != fontSize {
222:             let selectedRange = textView.selectedRange
223:             textView.font = UIFont.monospacedSystemFont(ofSize: fontSize, weight: .regular)
224:             context.coordinator.applySyntaxHighlighting(to: textView)
225:             textView.selectedRange = selectedRange
226:             
227:             // Update line height
228:             if let font = textView.font {
229:                 DispatchQueue.main.async {
230:                     self.lineHeight = font.lineHeight
231:                 }
232:             }
233:         }
234:         
235:         // Update text if changed externally
236:         if textView.text != text {
237:             let selectedRange = textView.selectedRange
238:             textView.text = text
239:             context.coordinator.applySyntaxHighlighting(to: textView)
240:             context.coordinator.hasAppliedInitialHighlighting = true
241:             textView.selectedRange = selectedRange
242:         } else if context.coordinator.lastThemeId != ThemeManager.shared.currentTheme.id {
243:             // Re-apply highlighting if theme changed
244:             context.coordinator.applySyntaxHighlighting(to: textView)
245:         }
246:         
247:         // Handle minimap scrolling - but ONLY if user is NOT actively scrolling
248:         // This prevents the editor from fighting against user scroll due to async binding lag
249:         if scrollPosition != context.coordinator.lastKnownScrollPosition && scrollPosition >= 0 && !context.coordinator.isUserScrolling {
250:             // Update lastKnownScrollPosition FIRST to prevent race condition


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift", "start_line": 650, "end_line": 700}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift (lines 651-700 of 1995)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
651: 
652:         private func updateMatchingBracketHighlight(_ textView: UITextView) {
653:             // Clear any existing highlights
654:             if !bracketHighlightRanges.isEmpty {
655:                 for r in bracketHighlightRanges {
656:                     textView.textStorage.removeAttribute(.backgroundColor, range: r)
657:                     textView.textStorage.removeAttribute(.underlineStyle, range: r)
658:                 }
659:                 bracketHighlightRanges.removeAll()
660:             }
661: 
662:             // Only highlight when there's a caret (no selection)
663:             let selection = textView.selectedRange
664:             guard selection.length == 0 else { return }
665: 
666:             let nsText = (textView.text ?? "") as NSString
667:             let length = nsText.length
668:             guard length > 0 else { return }
669: 
670:             let caret = selection.location
671: 
672:             // Candidate bracket location: char before caret, else at caret
673:             let candidateIndices: [Int] = [
674:                 caret - 1,
675:                 caret
676:             ].filter { $0 >= 0 && $0 < length }
677: 
678:             func isBracket(_ c: unichar) -> Bool {
679:                 c == 123 || c == 125 || c == 40 || c == 41 || c == 91 || c == 93 // { } ( ) [ ]
680:             }
681: 
682:             var bracketIndex: Int?
683:             var bracketChar: unichar = 0
684: 
685:             for idx in candidateIndices {
686:                 let c = nsText.character(at: idx)
687:                 if isBracket(c) {
688:                     bracketIndex = idx
689:                     bracketChar = c
690:                     break
691:                 }
692:             }
693: 
694:             guard let idx = bracketIndex else { return }
695: 
696:             // Define bracket pairs
697:             let openToClose: [unichar: unichar] = [123: 125, 40: 41, 91: 93] // { -> }, ( -> ), [ -> ]
698:             let closeToOpen: [unichar: unichar] = [125: 123, 41: 40, 93: 91] // } -> {, ) -> (, ] -> [
699: 
700:             let theme = ThemeManager.shared.currentTheme


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift", "start_line": 700, "end_line": 750}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift (lines 701-750 of 1995)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
701:             let bg = UIColor(theme.selection).withAlphaComponent(theme.isDark ? 0.35 : 0.22)
702: 
703:             var matchIndex: Int?
704: 
705:             if let close = openToClose[bracketChar] {
706:                 // Opening bracket: scan forward
707:                 var depth = 0
708:                 var i = idx + 1
709:                 while i < length {
710:                     let c = nsText.character(at: i)
711:                     if c == bracketChar {
712:                         depth += 1
713:                     } else if c == close {
714:                         if depth == 0 {
715:                             matchIndex = i
716:                             break
717:                         } else {
718:                             depth -= 1
719:                         }
720:                     }
721:                     i += 1
722:                 }
723:             } else if let open = closeToOpen[bracketChar] {
724:                 // Closing bracket: scan backward
725:                 var depth = 0
726:                 var i = idx - 1
727:                 while i >= 0 {
728:                     let c = nsText.character(at: i)
729:                     if c == bracketChar {
730:                         depth += 1
731:                     } else if c == open {
732:                         if depth == 0 {
733:                             matchIndex = i
734:                             break
735:                         } else {
736:                             depth -= 1
737:                         }
738:                     }
739:                     i -= 1
740:                 }
741:             }
742: 
743:             guard let match = matchIndex else { return }
744: 
745:             let r1 = NSRange(location: idx, length: 1)
746:             let r2 = NSRange(location: match, length: 1)
747: 
748:             textView.textStorage.addAttribute(.backgroundColor, value: bg, range: r1)
749:             textView.textStorage.addAttribute(.backgroundColor, value: bg, range: r2)
750: 


>>>TOOL search
{"query": "class EditorTextView", "glob": "VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift"}
>>>END

---

## üîß TOOL RESULTS

[search]
Found 1 matches:
VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift:760: class EditorTextView: UITextView {


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift", "start_line": 760, "end_line": 860}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift (lines 761-860 of 1995)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
761:     var onPeekDefinition: (() -> Void)?
762:     var onEscape: (() -> Void)?
763:     var onGoToLine: (() -> Void)?
764:     
765:     // Custom action closures for context menu
766:     var onGoToDefinition: (() -> Void)?
767:     var onFindReferences: (() -> Void)?
768:     var onFormatDocument: (() -> Void)?
769:     var onToggleComment: (() -> Void)?
770:     var onFold: (() -> Void)?
771:     var onUnfold: (() -> Void)?
772: 
773:     // Autocomplete key handling hooks (return true if handled)
774:     var onAcceptAutocomplete: (() -> Bool)?
775:     var onDismissAutocomplete: (() -> Bool)?
776:     
777:     // FEAT-039 & FEAT-043
778:     private var indentGuideColor: UIColor = .separator
779:     private var activeIndentGuideColor: UIColor = .label
780:     private var currentLineHighlightColor: UIColor = .clear
781:     
782:     override init(frame: CGRect, textContainer: NSTextContainer?) {
783:         super.init(frame: frame, textContainer: textContainer)
784:         setup()
785:     }
786:     
787:     required init?(coder: NSCoder) {
788:         super.init(coder: coder)
789:         setup()
790:     }
791:     
792:     private func setup() {
793:         // Ensure we redraw when bounds/selection change
794:         contentMode = .redraw
795:     }
796:     
797:     func updateThemeColors(theme: Theme) {
798:         self.indentGuideColor = UIColor(theme.indentGuide)
799:         self.activeIndentGuideColor = UIColor(theme.indentGuideActive)
800:         self.currentLineHighlightColor = UIColor(theme.currentLineHighlight)
801:         setNeedsDisplay()
802:     }
803:     
804:     override func draw(_ rect: CGRect) {
805:         guard let context = UIGraphicsGetCurrentContext(), let font = self.font else {
806:             super.draw(rect)
807:             return
808:         }
809:         
810:         // 1. Draw Current Line Highlight (FEAT-043)
811:         if let selectedRange = selectedTextRange {
812:             // Get the line rect for the cursor position
813:             let caretRect = self.caretRect(for: selectedRange.start)
814:             let lineRect = CGRect(x: 0, y: caretRect.minY, width: bounds.width, height: caretRect.height)
815:             
816:             context.setFillColor(currentLineHighlightColor.cgColor)
817:             context.fill(lineRect)
818:         }
819:         
820:         // 2. Draw Text (super implementation)
821:         super.draw(rect)
822:         
823:         // 3. Draw Indent Guides (FEAT-039)
824:         // We iterate visible lines and draw vertical lines for indentation
825:         // Optimization: Only draw for visible range
826: 
827:         context.setLineWidth(1.0)
828: 
829:         // Respect editor tab size setting (default 4)
830:         let storedTabSize = UserDefaults.standard.integer(forKey: "tabSize")
831:         let tabSize = storedTabSize > 0 ? storedTabSize : 4
832: 
833:         let spaceWidth = " ".size(withAttributes: [.font: font]).width
834:         let indentWidth = spaceWidth * CGFloat(tabSize)
835: 
836:         // Determine active indent level for caret line (for indentGuideActive)
837:         var activeIndentLevel: Int = 0
838:         if let selected = selectedTextRange {
839:             let caretPos = offset(from: beginningOfDocument, to: selected.start)
840:             let nsText = (self.text ?? "") as NSString
841:             let safeLoc = min(max(0, caretPos), nsText.length)
842:             let caretLineRange = nsText.lineRange(for: NSRange(location: safeLoc, length: 0))
843:             let caretLineText = nsText.substring(with: caretLineRange)
844: 
845:             var spaces = 0
846:             for ch in caretLineText {
847:                 if ch == " " { spaces += 1 }
848:                 else if ch == "\t" { spaces += tabSize }
849:                 else { break }
850:             }
851:             activeIndentLevel = spaces / tabSize
852:         }
853: 
854:         // Iterate visible glyphs/lines
855:         let visibleRect = CGRect(origin: contentOffset, size: bounds.size)
856:         let glyphRange = layoutManager.glyphRange(forBoundingRect: visibleRect, in: textContainer)
857: 
858:         let caretY = selectedTextRange.map { caretRect(for: $0.start).minY }
859: 
860:         layoutManager.enumerateLineFragments(forGlyphRange: glyphRange) { (rect, usedRect, textContainer, glyphRange, stop) in


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift", "start_line": 861, "end_line": 950}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift (lines 862-950 of 1995)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
862:             guard let range = self.layoutManager.characterRange(forGlyphRange: glyphRange, actualGlyphRange: nil) as NSRange?,
863:                   let text = self.text as NSString? else { return }
864: 
865:             let lineText = text.substring(with: range)
866: 
867:             // Calculate indentation level
868:             var spaces = 0
869:             for char in lineText {
870:                 if char == " " { spaces += 1 }
871:                 else if char == "\t" { spaces += tabSize } // Handle tabs if present
872:                 else { break }
873:             }
874: 
875:             let indentLevel = spaces / tabSize
876:             guard indentLevel > 0 else { return }
877: 
878:             let isCaretLine = (caretY != nil) && abs(rect.minY - (caretY ?? 0)) < 0.5
879: 
880:             for i in 1...indentLevel {
881:                 let x = CGFloat(i) * indentWidth + self.textContainerInset.left
882:                 let startPoint = CGPoint(x: x, y: rect.minY)
883:                 let endPoint = CGPoint(x: x, y: rect.maxY)
884: 
885:                 let stroke = (isCaretLine && i == activeIndentLevel) ? self.activeIndentGuideColor : self.indentGuideColor
886:                 context.setStrokeColor(stroke.cgColor)
887: 
888:                 context.move(to: startPoint)
889:                 context.addLine(to: endPoint)
890:                 context.strokePath()
891:             }
892:         }
893:     }
894:     
895:     override var keyCommands: [UIKeyCommand]? {
896:         var commands = super.keyCommands ?? []
897:         
898:         // Peek Definition: Alt+F12 (using special key input)
899:         // Note: F12 is not directly available on iPadOS keyboards
900:         // Using Option+D as alternative
901:         commands.append(UIKeyCommand(
902:             input: "d",
903:             modifierFlags: .alternate,
904:             action: #selector(handlePeekDefinition)
905:         ))
906: 
907:         // Go to Line: Cmd+G
908:         commands.append(UIKeyCommand(
909:             input: "g",
910:             modifierFlags: .command,
911:             action: #selector(handleGoToLine)
912:         ))
913: 
914:         // Tab: accept autocomplete if visible, else insert tab
915:         commands.append(UIKeyCommand(
916:             input: "\t",
917:             modifierFlags: [],
918:             action: #selector(handleTab)
919:         ))
920:         
921:         // Escape: dismiss autocomplete if visible, else normal escape behavior
922:         commands.append(UIKeyCommand(
923:             input: UIKeyCommand.inputEscape,
924:             modifierFlags: [],
925:             action: #selector(handleEscape)
926:         ))
927:         
928:         // Fold: Cmd+Opt+[
929:         commands.append(UIKeyCommand(
930:             input: "[",
931:             modifierFlags: [.command, .alternate],
932:             action: #selector(handleFold)
933:         ))
934:         
935:         // Unfold: Cmd+Opt+]
936:         commands.append(UIKeyCommand(
937:             input: "]",
938:             modifierFlags: [.command, .alternate],
939:             action: #selector(handleUnfold)
940:         ))
941:         
942:         // MARK: - App-Level Shortcuts (UITextView captures keyboard, so we MUST register here)
943:         // These post to NotificationCenter so ContentView can handle them
944:         
945:         // Command Palette: Cmd+Shift+P
946:         commands.append(UIKeyCommand(
947:             input: "p",
948:             modifierFlags: [.command, .shift],
949:             action: #selector(handleShowCommandPalette),
950:             discoverabilityTitle: "Command Palette"


>>>TOOL list_dir
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views"}
>>>END

---

## üîß TOOL RESULTS

[list_dir]
üìÅ VSCodeiPadOS/VSCodeiPadOS/Views/
üìÅ Editor/
üìÅ Panels/
   _tmp.txt
   BranchMenu.swift
   CommandPalette.swift
   CommandPaletteView.swift
   DiffComponents.swift
   FileIconView.swift
   FileTreeView.swift
   GoToSymbol.swift
   LaunchConfigView.swift
   QuickOpen.swift
   RunConfigView.swift
   SidebarView.swift
   SnippetPickerView.swift
   StatusBarView.swift
   TabBarView.swift
   TasksView.swift
   WorkspaceSettingsView.swift
   WorkspaceTrustDialog.swift


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/SidebarView.swift"}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/SidebarView.swift (lines 1-288 of 288)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1: import SwiftUI
2: 
3: // MARK: - Sidebar View Structure
4: 
5: struct SidebarView: View {
6:     @ObservedObject var editorCore: EditorCore
7:     @ObservedObject var fileNavigator: FileSystemNavigator
8:     @Binding var selectedTab: Int
9:     @Binding var showSettings: Bool
10:     @Binding var showTerminal: Bool
11:     @Binding var showFolderPicker: Bool
12:     var theme: Theme = ThemeManager.shared.currentTheme
13:     
14:     var body: some View {
15:         HStack(spacing: 0) {
16:             // 1. Activity Bar (Far Left)
17:             IDEActivityBar(
18:                 editorCore: editorCore,
19:                 selectedTab: $selectedTab,
20:                 showSettings: $showSettings,
21:                 showTerminal: $showTerminal
22:             )
23:             
24:             // 2. Sidebar Panel (Resizable)
25:             if editorCore.showSidebar {
26:                 ZStack(alignment: .trailing) {
27:                     VStack(spacing: 0) {
28:                         // Header Area
29:                         HStack {
30:                             Text(sidebarTitle)
31:                                 .font(.system(size: 11, weight: .medium))
32:                                 .foregroundColor(.secondary)
33:                                 .textCase(.uppercase)
34:                                 .accessibilityIdentifier("sidebar.header.title")
35:                             Spacer()
36:                             sidebarHeaderActions
37:                         }
38:                         .padding(.horizontal, 20)
39:                         .padding(.vertical, 10)
40:                         
41:                         Divider()
42:                             .background(Color(UIColor.separator))
43:                         
44:                         // Content Area
45:                         sidebarContent
46:                             .frame(maxWidth: .infinity, maxHeight: .infinity)
47:                     }
48:                     .frame(width: editorCore.sidebarWidth)
49:                     .background(Color(UIColor.secondarySystemBackground)) // Theme aware
50:                     .accessibilityIdentifier("sidebar.panel")
51:                     
52:                     // 5. Resize Handle
53:                     ResizeHandle(width: $editorCore.sidebarWidth)
54:                 }
55:             }
56:         }
57:     }
58:     
59:     // Dynamic Title based on selection
60:     private var sidebarTitle: String {
61:         switch selectedTab {
62:         case 0: return "EXPLORER"
63:         case 1: return "SEARCH"
64:         case 2: return "SOURCE CONTROL"
65:         case 3: return "RUN AND DEBUG"
66:         case 4: return "EXTENSIONS"
67:         case 5: return "TESTING"
68:         default: return "EXPLORER"
69:         }
70:     }
71:     
72:     // Header Actions
73:     @ViewBuilder
74:     private var sidebarHeaderActions: some View {
75:         if selectedTab == 0 {
76:             HStack(spacing: 12) {
77:                 Button(action: { showFolderPicker = true }) {
78:                     Image(systemName: "folder.badge.plus")
79:                         .font(.system(size: 14))
80:                         .foregroundColor(.secondary)
81:                 }
82:                 .help("Open Folder")
83:                 
84:                 Button(action: { editorCore.addTab() }) {
85:                     Image(systemName: "doc.badge.plus")
86:                         .font(.system(size: 14))
87:                         .foregroundColor(.secondary)
88:                 }
89:                 .help("New File")
90:                 
91:                 Button(action: { fileNavigator.refreshFileTree() }) {
92:                     Image(systemName: "arrow.clockwise")
93:                         .font(.system(size: 14))
94:                         .foregroundColor(.secondary)
95:                 }
96:                 .help("Refresh")
97:                 
98:                 Button(action: { 
99:                      // Collapse All Action 
100:                      fileNavigator.expandedPaths.removeAll()
101:                 }) {
102:                     Image(systemName: "arrow.up.left.and.arrow.down.right") // Collapse icon
103:                         .font(.system(size: 14))
104:                         .foregroundColor(.secondary)
105:                 }
106:                 .help("Collapse All Folders")
107:             }
108:         }
109:     }
110:     
111:     // Content Switching
112:     @ViewBuilder
113:     private var sidebarContent: some View {
114:         switch selectedTab {
115:         case 0:
116:             IDESidebarFiles(editorCore: editorCore, fileNavigator: fileNavigator, showFolderPicker: $showFolderPicker, theme: theme)
117:         case 1:
118:             SidebarSearchView(theme: theme)
119:         case 2:
120:             GitView()
121:         case 3:
122:             DebugView()
123:         case 4:
124:             ExtensionsView()
125:         case 5:
126:             TestView()
127:         default:
128:             IDESidebarFiles(editorCore: editorCore, fileNavigator: fileNavigator, showFolderPicker: $showFolderPicker, theme: theme)
129:         }
130:     }
131: }
132: 
133: // MARK: - Activity Bar Implementation
134: 
135: struct IDEActivityBar: View {
136:     @ObservedObject var editorCore: EditorCore
137:     @Binding var selectedTab: Int
138:     @Binding var showSettings: Bool
139:     @Binding var showTerminal: Bool
140:     
141:     var body: some View {
142:         VStack(spacing: 0) {
143:             // Top Group
144:             Group {
145:                 ActivityBarIcon(icon: "doc.on.doc", title: "Explorer", index: 0, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.explorer")
146:                 ActivityBarIcon(icon: "magnifyingglass", title: "Search", index: 1, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.search")
147:                 ActivityBarIcon(icon: "arrow.triangle.branch", title: "Source Control", index: 2, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.sourceControl")
148:                 ActivityBarIcon(icon: "play.fill", title: "Run and Debug", index: 3, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.runAndDebug")
149:                 ActivityBarIcon(icon: "square.grid.2x2", title: "Extensions", index: 4, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.extensions")
150:                 ActivityBarIcon(icon: "testtube.2", title: "Testing", index: 5, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.testing")
151:             }
152:             
153:             Spacer()
154:             
155:             // Bottom Group
156:             Group {
157:                 ActivityBarButton(icon: "person.circle", title: "Accounts") {}
158:                 ActivityBarButton(icon: "gear", title: "Manage") {
159:                     showSettings = true
160:                 }
161:             }
162:             .padding(.bottom, 10)
163:         }
164:         .frame(width: 50)
165:         .background(Color(UIColor.secondarySystemBackground).opacity(0.8)) // Darker shade for activity bar
166:         .border(width: 1, edges: [.trailing], color: Color(UIColor.separator))
167:     }
168: }
169: 
170: struct ActivityBarIcon: View {
171:     let icon: String
172:     let title: String
173:     let index: Int
174:     @Binding var selectedTab: Int
175:     @ObservedObject var editorCore: EditorCore
176:     let accessibilityID: String
177:     
178:     var isSelected: Bool { selectedTab == index }
179:     
180:     var body: some View {
181:         Button(action: {
182:             if isSelected {
183:                 // Toggle sidebar visibility if clicking already selected tab
184:                 editorCore.toggleSidebar()
185:             } else {
186:                 selectedTab = index
187:                 if !editorCore.showSidebar { editorCore.toggleSidebar() }
188:             }
189:         }) {
190:             ZStack {
191:                 // Active indicator line on left
192:                 if isSelected && editorCore.showSidebar {
193:                     HStack {
194:                         Rectangle()
195:                             .fill(Color.accentColor)
196:                             .frame(width: 2)
197:                         Spacer()
198:                     }
199:                 }
200:                 
201:                 Image(systemName: icon)
202:                     .font(.system(size: 20, weight: .light))
203:                     .foregroundColor(isSelected && editorCore.showSidebar ? .primary : .secondary)
204:                     .frame(width: 50, height: 50)
205:                     .contentShape(Rectangle())
206:             }
207:         }
208:         .buttonStyle(PlainButtonStyle())
209:         .help(title)
210:         .accessibilityIdentifier(accessibilityID)
211:     }
212: }
213: 
214: struct ActivityBarButton: View {
215:     let icon: String
216:     let title: String
217:     let action: () -> Void
218:     
219:     var body: some View {
220:         Button(action: action) {
221:             Image(systemName: icon)
222:                 .font(.system(size: 20, weight: .light))
223:                 .foregroundColor(.secondary)
224:                 .frame(width: 50, height: 50)
225:                 .contentShape(Rectangle())
226:         }
227:         .buttonStyle(PlainButtonStyle())
228:         .help(title)
229:     }
230: }
231: 
232: // MARK: - Resize Handle (iPad Compatible)
233: 
234: struct ResizeHandle: View {
235:     @Binding var width: CGFloat
236:     @State private var isDragging = false
237:     
238:     var body: some View {
239:         HStack(spacing: 0) {
240:             Spacer()
241:             ZStack {
242:                 // Invisible larger hit area
243:                 Rectangle()
244:                     .fill(Color.clear)
245:                     .frame(width: 10)
246:                 
247:                 // Visible separator line
248:                 Rectangle()
249:                     .fill(isDragging ? Color.accentColor : Color(UIColor.separator))
250:                     .frame(width: 1)
251:             }
252:             .contentShape(Rectangle())
253:             .gesture(
254:                 DragGesture()
255:                     .onChanged { value in
256:                         isDragging = true
257:                         let newWidth = width + value.translation.width
258:                         // Clamp width (Min 170, Max 600)
259:                         if newWidth >= 170 && newWidth <= 600 {
260:                             width = newWidth
261:                         }
262:                     }
263:                     .onEnded { _ in
264:                         isDragging = false
265:                     }
266:             )
267:         }
268:     }
269: }
270: 
271: // MARK: - Placeholders for Missing Views
272: 
273: 
274: 
275: struct ExtensionsView: View {
276:     var body: some View {
277:         VStack {
278:             Text("Extensions")
279:                 .font(.caption)
280:                 .foregroundColor(.secondary)
281:                 .padding()
282:             Spacer()
283:         }
284:     }
285: }
286: 
287: 
288: 


>>>TOOL list_dir
{"path": "VSCodeiPadOS/VSCodeiPadOS/Models"}
>>>END

---

## üîß TOOL RESULTS

[list_dir]
üìÅ VSCodeiPadOS/VSCodeiPadOS/Models/
   EditorState.swift
   FileItem.swift
   FileItemUTType.swift
   FindViewModel.swift
   MultiCursor.swift
   Tab.swift
   Theme.swift
   ThemeManager.swift


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Models/ThemeManager.swift"}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Models/ThemeManager.swift (lines 1-77 of 77)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1: import SwiftUI
2: import Combine
3: 
4: class ThemeManager: ObservableObject {
5:     @AppStorage("selectedThemeId") var selectedThemeId: String = "dark_plus"
6:     @Published var currentTheme: Theme
7:     
8:     static let shared = ThemeManager()
9:     
10:     // Quick access to current theme
11:     static var current: Theme { shared.currentTheme }
12:     
13:     init() {
14:         let themeId = UserDefaults.standard.string(forKey: "selectedThemeId") ?? "dark_plus"
15:         self.currentTheme = Theme.allThemes.first(where: { $0.id == themeId }) ?? .darkPlus
16:     }
17:     
18:     func switchTheme(to themeId: String) {
19:         if let theme = Theme.allThemes.first(where: { $0.id == themeId }) {
20:             withAnimation(.easeInOut(duration: 0.2)) {
21:                 self.currentTheme = theme
22:             }
23:             self.selectedThemeId = themeId
24:         }
25:     }
26:     
27:     func switchTheme(to theme: Theme) {
28:         switchTheme(to: theme.id)
29:     }
30:     
31:     // Cycle to next theme
32:     func nextTheme() {
33:         let themes = Theme.allThemes
34:         guard let currentIndex = themes.firstIndex(where: { $0.id == currentTheme.id }) else {
35:             switchTheme(to: themes.first!)
36:             return
37:         }
38:         let nextIndex = (currentIndex + 1) % themes.count
39:         switchTheme(to: themes[nextIndex])
40:     }
41:     
42:     // Cycle to previous theme
43:     func previousTheme() {
44:         let themes = Theme.allThemes
45:         guard let currentIndex = themes.firstIndex(where: { $0.id == currentTheme.id }) else {
46:             switchTheme(to: themes.first!)
47:             return
48:         }
49:         let prevIndex = currentIndex == 0 ? themes.count - 1 : currentIndex - 1
50:         switchTheme(to: themes[prevIndex])
51:     }
52:     
53:     // Get themes by category
54:     var darkThemes: [Theme] {
55:         Theme.allThemes.filter { $0.isDark }
56:     }
57:     
58:     var lightThemes: [Theme] {
59:         Theme.allThemes.filter { !$0.isDark }
60:     }
61:     
62:     // Helper for file colors that adapts to theme
63:     func color(for filename: String) -> Color {
64:         let ext = (filename as NSString).pathExtension.lowercased()
65:         switch ext {
66:         case "swift": return .orange
67:         case "js", "jsx": return .yellow
68:         case "ts", "tsx": return .blue
69:         case "py": return .green
70:         case "html", "htm": return .red
71:         case "css", "scss": return .purple
72:         case "json": return .green
73:         case "md": return .blue
74:         default: return currentTheme.isDark ? .white : .black
75:         }
76:     }
77: }


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Models/Theme.swift"}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Models/Theme.swift (lines 1-887 of 887)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1: import SwiftUI
2: 
3: struct Theme: Identifiable, Equatable, Hashable {
4:     let id: String
5:     let name: String
6:     let isDark: Bool
7:     
8:     // Editor Colors
9:     let editorBackground: Color
10:     let editorForeground: Color
11:     let selection: Color
12:     let cursor: Color
13:     let lineNumber: Color
14:     let lineNumberActive: Color
15:     let currentLineHighlight: Color
16:     let bracketPair1: Color
17:     let bracketPair2: Color
18:     let bracketPair3: Color
19:     let bracketPair4: Color
20:     let bracketPair5: Color
21:     let bracketPair6: Color
22:     let indentGuide: Color
23:     let indentGuideActive: Color
24:     
25:     // UI Colors
26:     let sidebarBackground: Color
27:     let sidebarForeground: Color
28:     let sidebarSectionHeader: Color
29:     let sidebarSelection: Color
30:     let activityBarBackground: Color
31:     let activityBarForeground: Color
32:     let activityBarSelection: Color
33:     let tabBarBackground: Color
34:     let tabActiveBackground: Color
35:     let tabInactiveBackground: Color
36:     let tabActiveForeground: Color
37:     let tabInactiveForeground: Color
38:     let statusBarBackground: Color
39:     let statusBarForeground: Color
40:     
41:     // Syntax Colors
42:     let keyword: Color
43:     let string: Color
44:     let number: Color
45:     let comment: Color
46:     let function: Color
47:     let type: Color
48:     let variable: Color
49:     
50:     // Helper for Hex Colors
51:     static func hex(_ hex: String) -> Color {
52:         var hexSanitized = hex.trimmingCharacters(in: .whitespacesAndNewlines)
53:         hexSanitized = hexSanitized.replacingOccurrences(of: "#", with: "")
54:         
55:         var rgb: UInt64 = 0
56:         Scanner(string: hexSanitized).scanHexInt64(&rgb)
57:         
58:         let r = Double((rgb & 0xFF0000) >> 16) / 255.0
59:         let g = Double((rgb & 0x00FF00) >> 8) / 255.0
60:         let b = Double(rgb & 0x0000FF) / 255.0
61:         
62:         return Color(red: r, green: g, blue: b)
63:     }
64:     
65:     // MARK: - VS Code Default Themes
66:     
67:     static let darkPlus = Theme(
68:         id: "dark_plus",
69:         name: "Dark+ (Default Dark)",
70:         isDark: true,
71:         editorBackground: hex("#1E1E1E"),
72:         editorForeground: hex("#D4D4D4"),
73:         selection: hex("#264F78"),
74:         cursor: hex("#AEAFAD"),
75:         lineNumber: hex("#858585"),
76:         lineNumberActive: hex("#C6C6C6"),
77:         currentLineHighlight: hex("#FFFFFF").opacity(0.1),
78:         bracketPair1: hex("#FFD700"),
79:         bracketPair2: hex("#DA70D6"),
80:         bracketPair3: hex("#179FFF"),
81:         bracketPair4: hex("#FFD700"),
82:         bracketPair5: hex("#DA70D6"),
83:         bracketPair6: hex("#179FFF"),
84:         indentGuide: hex("#404040"),
85:         indentGuideActive: hex("#707070"),
86:         sidebarBackground: hex("#252526"),
87:         sidebarForeground: hex("#CCCCCC"),
88:         sidebarSectionHeader: hex("#383838"),
89:         sidebarSelection: hex("#37373D"),
90:         activityBarBackground: hex("#333333"),
91:         activityBarForeground: hex("#FFFFFF"),
92:         activityBarSelection: hex("#FFFFFF"),
93:         tabBarBackground: hex("#252526"),
94:         tabActiveBackground: hex("#1E1E1E"),
95:         tabInactiveBackground: hex("#2D2D2D"),
96:         tabActiveForeground: hex("#FFFFFF"),
97:         tabInactiveForeground: hex("#969696"),
98:         statusBarBackground: hex("#007ACC"),
99:         statusBarForeground: hex("#FFFFFF"),
100:         keyword: hex("#569CD6"),
101:         string: hex("#CE9178"),
102:         number: hex("#B5CEA8"),
103:         comment: hex("#6A9955"),
104:         function: hex("#DCDCAA"),
105:         type: hex("#4EC9B0"),
106:         variable: hex("#9CDCFE")
107:     )
108:     
109:     static let lightPlus = Theme(
110:         id: "light_plus",
111:         name: "Light+ (Default Light)",
112:         isDark: false,
113:         editorBackground: hex("#FFFFFF"),
114:         editorForeground: hex("#000000"),
115:         selection: hex("#ADD6FF"),
116:         cursor: hex("#000000"),
117:         lineNumber: hex("#237893"),
118:         lineNumberActive: hex("#0B216F"),
119:         currentLineHighlight: hex("#000000").opacity(0.07),
120:         bracketPair1: hex("#0431FA"),
121:         bracketPair2: hex("#319331"),
122:         bracketPair3: hex("#7B3814"),
123:         bracketPair4: hex("#0431FA"),
124:         bracketPair5: hex("#319331"),
125:         bracketPair6: hex("#7B3814"),
126:         indentGuide: hex("#D3D3D3"),
127:         indentGuideActive: hex("#939393"),
128:         sidebarBackground: hex("#F3F3F3"),
129:         sidebarForeground: hex("#616161"),
130:         sidebarSectionHeader: hex("#E7E7E7"),
131:         sidebarSelection: hex("#E4E6F1"),
132:         activityBarBackground: hex("#2C2C2C"),
133:         activityBarForeground: hex("#FFFFFF"),
134:         activityBarSelection: hex("#FFFFFF"),
135:         tabBarBackground: hex("#F3F3F3"),
136:         tabActiveBackground: hex("#FFFFFF"),
137:         tabInactiveBackground: hex("#ECECEC"),
138:         tabActiveForeground: hex("#333333"),
139:         tabInactiveForeground: hex("#8E8E8E"),
140:         statusBarBackground: hex("#007ACC"),
141:         statusBarForeground: hex("#FFFFFF"),
142:         keyword: hex("#AF00DB"),
143:         string: hex("#A31515"),
144:         number: hex("#098658"),
145:         comment: hex("#008000"),
146:         function: hex("#795E26"),
147:         type: hex("#267F99"),
148:         variable: hex("#001080")
149:     )
150:     
151:     static let monokai = Theme(
152:         id: "monokai",
153:         name: "Monokai",
154:         isDark: true,
155:         editorBackground: hex("#272822"),
156:         editorForeground: hex("#F8F8F2"),
157:         selection: hex("#49483E"),
158:         cursor: hex("#F8F8F0"),
159:         lineNumber: hex("#90908A"),
160:         lineNumberActive: hex("#F8F8F2"),
161:         currentLineHighlight: hex("#3E3D32"),
162:         bracketPair1: hex("#F8F8F2"),
163:         bracketPair2: hex("#F92672"),
164:         bracketPair3: hex("#A6E22E"),
165:         bracketPair4: hex("#F8F8F2"),
166:         bracketPair5: hex("#F92672"),
167:         bracketPair6: hex("#A6E22E"),
168:         indentGuide: hex("#464741"),
169:         indentGuideActive: hex("#75715E"),
170:         sidebarBackground: hex("#272822"),
171:         sidebarForeground: hex("#F8F8F2"),
172:         sidebarSectionHeader: hex("#1E1F1C"),
173:         sidebarSelection: hex("#49483E"),
174:         activityBarBackground: hex("#1E1F1C"),
175:         activityBarForeground: hex("#F8F8F2"),
176:         activityBarSelection: hex("#F8F8F2"),
177:         tabBarBackground: hex("#1E1F1C"),
178:         tabActiveBackground: hex("#272822"),
179:         tabInactiveBackground: hex("#34352F"),
180:         tabActiveForeground: hex("#F8F8F2"),
181:         tabInactiveForeground: hex("#88846F"),
182:         statusBarBackground: hex("#75715E"),
183:         statusBarForeground: hex("#F8F8F2"),
184:         keyword: hex("#F92672"),
185:         string: hex("#E6DB74"),
186:         number: hex("#AE81FF"),
187:         comment: hex("#75715E"),
188:         function: hex("#A6E22E"),
189:         type: hex("#66D9EF"),
190:         variable: hex("#FD971F")
191:     )
192:     
193:     static let solarizedDark = Theme(
194:         id: "solarized_dark",
195:         name: "Solarized Dark",
196:         isDark: true,
197:         editorBackground: hex("#002B36"),
198:         editorForeground: hex("#839496"),
199:         selection: hex("#274642"),
200:         cursor: hex("#D30102"),
201:         lineNumber: hex("#586E75"),
202:         lineNumberActive: hex("#93A1A1"),
203:         currentLineHighlight: hex("#0A2933"),
204:         bracketPair1: hex("#859900"),
205:         bracketPair2: hex("#2AA198"),
206:         bracketPair3: hex("#268BD2"),
207:         bracketPair4: hex("#859900"),
208:         bracketPair5: hex("#2AA198"),
209:         bracketPair6: hex("#268BD2"),
210:         indentGuide: hex("#073642"),
211:         indentGuideActive: hex("#586E75"),
212:         sidebarBackground: hex("#00252E"),
213:         sidebarForeground: hex("#93A1A1"),
214:         sidebarSectionHeader: hex("#001F27"),
215:         sidebarSelection: hex("#073642"),
216:         activityBarBackground: hex("#002B36"),
217:         activityBarForeground: hex("#93A1A1"),
218:         activityBarSelection: hex("#FDF6E3"),
219:         tabBarBackground: hex("#002B36"),
220:         tabActiveBackground: hex("#002B36"),
221:         tabInactiveBackground: hex("#00212B"),
222:         tabActiveForeground: hex("#93A1A1"),
223:         tabInactiveForeground: hex("#586E75"),
224:         statusBarBackground: hex("#00212B"),
225:         statusBarForeground: hex("#93A1A1"),
226:         keyword: hex("#859900"),
227:         string: hex("#2AA198"),
228:         number: hex("#D33682"),
229:         comment: hex("#586E75"),
230:         function: hex("#268BD2"),
231:         type: hex("#CB4B16"),
232:         variable: hex("#B58900")
233:     )
234:     
235:     static let solarizedLight = Theme(
236:         id: "solarized_light",
237:         name: "Solarized Light",
238:         isDark: false,
239:         editorBackground: hex("#FDF6E3"),
240:         editorForeground: hex("#657B83"),
241:         selection: hex("#EEE8D5"),
242:         cursor: hex("#D30102"),
243:         lineNumber: hex("#93A1A1"),
244:         lineNumberActive: hex("#586E75"),
245:         currentLineHighlight: hex("#EEE8D5"),
246:         bracketPair1: hex("#859900"),
247:         bracketPair2: hex("#2AA198"),
248:         bracketPair3: hex("#268BD2"),
249:         bracketPair4: hex("#859900"),
250:         bracketPair5: hex("#2AA198"),
251:         bracketPair6: hex("#268BD2"),
252:         indentGuide: hex("#EEE8D5"),
253:         indentGuideActive: hex("#93A1A1"),
254:         sidebarBackground: hex("#EEE8D5"),
255:         sidebarForeground: hex("#586E75"),
256:         sidebarSectionHeader: hex("#DDD6C1"),
257:         sidebarSelection: hex("#D3CBB8"),
258:         activityBarBackground: hex("#DDD6C1"),
259:         activityBarForeground: hex("#586E75"),
260:         activityBarSelection: hex("#073642"),
261:         tabBarBackground: hex("#EEE8D5"),
262:         tabActiveBackground: hex("#FDF6E3"),
263:         tabInactiveBackground: hex("#EEE8D5"),
264:         tabActiveForeground: hex("#073642"),
265:         tabInactiveForeground: hex("#93A1A1"),
266:         statusBarBackground: hex("#EEE8D5"),
267:         statusBarForeground: hex("#586E75"),
268:         keyword: hex("#859900"),
269:         string: hex("#2AA198"),
270:         number: hex("#D33682"),
271:         comment: hex("#93A1A1"),
272:         function: hex("#268BD2"),
273:         type: hex("#CB4B16"),
274:         variable: hex("#B58900")
275:     )
276:     
277:     static let dracula = Theme(
278:         id: "dracula",
279:         name: "Dracula",
280:         isDark: true,
281:         editorBackground: hex("#282A36"),
282:         editorForeground: hex("#F8F8F2"),
283:         selection: hex("#44475A"),
284:         cursor: hex("#F8F8F2"),
285:         lineNumber: hex("#6272A4"),
286:         lineNumberActive: hex("#F8F8F2"),
287:         currentLineHighlight: hex("#44475A"),
288:         bracketPair1: hex("#F8F8F2"),
289:         bracketPair2: hex("#FF79C6"),
290:         bracketPair3: hex("#8BE9FD"),
291:         bracketPair4: hex("#F8F8F2"),
292:         bracketPair5: hex("#FF79C6"),
293:         bracketPair6: hex("#8BE9FD"),
294:         indentGuide: hex("#424450"),
295:         indentGuideActive: hex("#6272A4"),
296:         sidebarBackground: hex("#21222C"),
297:         sidebarForeground: hex("#F8F8F2"),
298:         sidebarSectionHeader: hex("#191A21"),
299:         sidebarSelection: hex("#44475A"),
300:         activityBarBackground: hex("#343746"),
301:         activityBarForeground: hex("#F8F8F2"),
302:         activityBarSelection: hex("#F8F8F2"),
303:         tabBarBackground: hex("#191A21"),
304:         tabActiveBackground: hex("#282A36"),
305:         tabInactiveBackground: hex("#21222C"),
306:         tabActiveForeground: hex("#F8F8F2"),
307:         tabInactiveForeground: hex("#6272A4"),
308:         statusBarBackground: hex("#BD93F9"),
309:         statusBarForeground: hex("#282A36"),
310:         keyword: hex("#FF79C6"),
311:         string: hex("#F1FA8C"),
312:         number: hex("#BD93F9"),
313:         comment: hex("#6272A4"),
314:         function: hex("#50FA7B"),
315:         type: hex("#8BE9FD"),
316:         variable: hex("#FFB86C")
317:     )
318:     
319:     static let oneDarkPro = Theme(
320:         id: "one_dark_pro",
321:         name: "One Dark Pro",
322:         isDark: true,
323:         editorBackground: hex("#282C34"),
324:         editorForeground: hex("#ABB2BF"),
325:         selection: hex("#3E4451"),
326:         cursor: hex("#528BFF"),
327:         lineNumber: hex("#4B5263"),
328:         lineNumberActive: hex("#ABB2BF"),
329:         currentLineHighlight: hex("#2C313C"),
330:         bracketPair1: hex("#C678DD"),
331:         bracketPair2: hex("#61AFEF"),
332:         bracketPair3: hex("#E5C07B"),
333:         bracketPair4: hex("#C678DD"),
334:         bracketPair5: hex("#61AFEF"),
335:         bracketPair6: hex("#E5C07B"),
336:         indentGuide: hex("#3B4048"),
337:         indentGuideActive: hex("#5C6370"),
338:         sidebarBackground: hex("#21252B"),
339:         sidebarForeground: hex("#ABB2BF"),
340:         sidebarSectionHeader: hex("#282C34"),
341:         sidebarSelection: hex("#2C313A"),
342:         activityBarBackground: hex("#282C34"),
343:         activityBarForeground: hex("#ABB2BF"),
344:         activityBarSelection: hex("#D7DAE0"),
345:         tabBarBackground: hex("#21252B"),
346:         tabActiveBackground: hex("#282C34"),
347:         tabInactiveBackground: hex("#21252B"),
348:         tabActiveForeground: hex("#D7DAE0"),
349:         tabInactiveForeground: hex("#5C6370"),
350:         statusBarBackground: hex("#21252B"),
351:         statusBarForeground: hex("#9DA5B4"),
352:         keyword: hex("#C678DD"),
353:         string: hex("#98C379"),
354:         number: hex("#D19A66"),
355:         comment: hex("#5C6370"),
356:         function: hex("#61AFEF"),
357:         type: hex("#E5C07B"),
358:         variable: hex("#E06C75")
359:     )
360:     
361:     static let nord = Theme(
362:         id: "nord",
363:         name: "Nord",
364:         isDark: true,
365:         editorBackground: hex("#2E3440"),
366:         editorForeground: hex("#D8DEE9"),
367:         selection: hex("#434C5E"),
368:         cursor: hex("#D8DEE9"),
369:         lineNumber: hex("#4C566A"),
370:         lineNumberActive: hex("#D8DEE9"),
371:         currentLineHighlight: hex("#3B4252"),
372:         bracketPair1: hex("#EBCB8B"),
373:         bracketPair2: hex("#A3BE8C"),
374:         bracketPair3: hex("#81A1C1"),
375:         bracketPair4: hex("#EBCB8B"),
376:         bracketPair5: hex("#A3BE8C"),
377:         bracketPair6: hex("#81A1C1"),
378:         indentGuide: hex("#434C5E"),
379:         indentGuideActive: hex("#4C566A"),
380:         sidebarBackground: hex("#2E3440"),
381:         sidebarForeground: hex("#D8DEE9"),
382:         sidebarSectionHeader: hex("#3B4252"),
383:         sidebarSelection: hex("#3B4252"),
384:         activityBarBackground: hex("#2E3440"),
385:         activityBarForeground: hex("#D8DEE9"),
386:         activityBarSelection: hex("#88C0D0"),
387:         tabBarBackground: hex("#2E3440"),
388:         tabActiveBackground: hex("#3B4252"),
389:         tabInactiveBackground: hex("#2E3440"),
390:         tabActiveForeground: hex("#D8DEE9"),
391:         tabInactiveForeground: hex("#4C566A"),
392:         statusBarBackground: hex("#3B4252"),
393:         statusBarForeground: hex("#D8DEE9"),
394:         keyword: hex("#81A1C1"),
395:         string: hex("#A3BE8C"),
396:         number: hex("#B48EAD"),
397:         comment: hex("#616E88"),
398:         function: hex("#88C0D0"),
399:         type: hex("#8FBCBB"),
400:         variable: hex("#D8DEE9")
401:     )
402:     
403:     static let githubDark = Theme(
404:         id: "github_dark",
405:         name: "GitHub Dark",
406:         isDark: true,
407:         editorBackground: hex("#0D1117"),
408:         editorForeground: hex("#C9D1D9"),
409:         selection: hex("#163356"),
410:         cursor: hex("#58A6FF"),
411:         lineNumber: hex("#484F58"),
412:         lineNumberActive: hex("#C9D1D9"),
413:         currentLineHighlight: hex("#161B22"),
414:         bracketPair1: hex("#79C0FF"),
415:         bracketPair2: hex("#D2A8FF"),
416:         bracketPair3: hex("#FFA657"),
417:         bracketPair4: hex("#79C0FF"),
418:         bracketPair5: hex("#D2A8FF"),
419:         bracketPair6: hex("#FFA657"),
420:         indentGuide: hex("#21262D"),
421:         indentGuideActive: hex("#30363D"),
422:         sidebarBackground: hex("#010409"),
423:         sidebarForeground: hex("#C9D1D9"),
424:         sidebarSectionHeader: hex("#161B22"),
425:         sidebarSelection: hex("#1F2428"),
426:         activityBarBackground: hex("#0D1117"),
427:         activityBarForeground: hex("#C9D1D9"),
428:         activityBarSelection: hex("#C9D1D9"),
429:         tabBarBackground: hex("#010409"),
430:         tabActiveBackground: hex("#0D1117"),
431:         tabInactiveBackground: hex("#010409"),
432:         tabActiveForeground: hex("#C9D1D9"),
433:         tabInactiveForeground: hex("#8B949E"),
434:         statusBarBackground: hex("#0D1117"),
435:         statusBarForeground: hex("#58A6FF"),
436:         keyword: hex("#FF7B72"),
437:         string: hex("#A5D6FF"),
438:         number: hex("#79C0FF"),
439:         comment: hex("#8B949E"),
440:         function: hex("#D2A8FF"),
441:         type: hex("#79C0FF"),
442:         variable: hex("#FFA657")
443:     )
444:     
445:     static let githubLight = Theme(
446:         id: "github_light",
447:         name: "GitHub Light",
448:         isDark: false,
449:         editorBackground: hex("#FFFFFF"),
450:         editorForeground: hex("#24292F"),
451:         selection: hex("#B6E3FF"),
452:         cursor: hex("#0969DA"),
453:         lineNumber: hex("#8C959F"),
454:         lineNumberActive: hex("#24292F"),
455:         currentLineHighlight: hex("#F6F8FA"),
456:         bracketPair1: hex("#0550AE"),
457:         bracketPair2: hex("#8250DF"),
458:         bracketPair3: hex("#953800"),
459:         bracketPair4: hex("#0550AE"),
460:         bracketPair5: hex("#8250DF"),
461:         bracketPair6: hex("#953800"),
462:         indentGuide: hex("#D0D7DE"),
463:         indentGuideActive: hex("#8C959F"),
464:         sidebarBackground: hex("#F6F8FA"),
465:         sidebarForeground: hex("#24292F"),
466:         sidebarSectionHeader: hex("#EAEEF2"),
467:         sidebarSelection: hex("#DDFBE6"),
468:         activityBarBackground: hex("#F6F8FA"),
469:         activityBarForeground: hex("#24292F"),
470:         activityBarSelection: hex("#24292F"),
471:         tabBarBackground: hex("#F6F8FA"),
472:         tabActiveBackground: hex("#FFFFFF"),
473:         tabInactiveBackground: hex("#F6F8FA"),
474:         tabActiveForeground: hex("#24292F"),
475:         tabInactiveForeground: hex("#57606A"),
476:         statusBarBackground: hex("#F6F8FA"),
477:         statusBarForeground: hex("#0969DA"),
478:         keyword: hex("#CF222E"),
479:         string: hex("#0A3069"),
480:         number: hex("#0550AE"),
481:         comment: hex("#6E7781"),
482:         function: hex("#8250DF"),
483:         type: hex("#0550AE"),
484:         variable: hex("#953800")
485:     )
486:     
487:     static let cobalt2 = Theme(
488:         id: "cobalt2",
489:         name: "Cobalt2",
490:         isDark: true,
491:         editorBackground: hex("#193549"),
492:         editorForeground: hex("#FFFFFF"),
493:         selection: hex("#0D3A58"),
494:         cursor: hex("#FEFB00"),
495:         lineNumber: hex("#3D5F7D"),
496:         lineNumberActive: hex("#FFFFFF"),
497:         currentLineHighlight: hex("#1F4662"),
498:         bracketPair1: hex("#FFC600"),
499:         bracketPair2: hex("#FF628C"),
500:         bracketPair3: hex("#80FFBB"),
501:         bracketPair4: hex("#FFC600"),
502:         bracketPair5: hex("#FF628C"),
503:         bracketPair6: hex("#80FFBB"),
504:         indentGuide: hex("#294B5C"),
505:         indentGuideActive: hex("#3D5F7D"),
506:         sidebarBackground: hex("#15232D"),
507:         sidebarForeground: hex("#FFFFFF"),
508:         sidebarSectionHeader: hex("#0D1A23"),
509:         sidebarSelection: hex("#0D3A58"),
510:         activityBarBackground: hex("#193549"),
511:         activityBarForeground: hex("#FFFFFF"),
512:         activityBarSelection: hex("#FFC600"),
513:         tabBarBackground: hex("#15232D"),
514:         tabActiveBackground: hex("#193549"),
515:         tabInactiveBackground: hex("#15232D"),
516:         tabActiveForeground: hex("#FFFFFF"),
517:         tabInactiveForeground: hex("#3D5F7D"),
518:         statusBarBackground: hex("#15232D"),
519:         statusBarForeground: hex("#FFFFFF"),
520:         keyword: hex("#FF9D00"),
521:         string: hex("#A5FF90"),
522:         number: hex("#FF628C"),
523:         comment: hex("#0088FF"),
524:         function: hex("#FFC600"),
525:         type: hex("#80FFBB"),
526:         variable: hex("#9EFFFF")
527:     )
528:     
529:     static let ayuDark = Theme(
530:         id: "ayu_dark",
531:         name: "Ayu Dark",
532:         isDark: true,
533:         editorBackground: hex("#0A0E14"),
534:         editorForeground: hex("#B3B1AD"),
535:         selection: hex("#273747"),
536:         cursor: hex("#E6B450"),
537:         lineNumber: hex("#3D424D"),
538:         lineNumberActive: hex("#E6B450"),
539:         currentLineHighlight: hex("#0D1016"),
540:         bracketPair1: hex("#FFB454"),
541:         bracketPair2: hex("#59C2FF"),
542:         bracketPair3: hex("#AAD94C"),
543:         bracketPair4: hex("#FFB454"),
544:         bracketPair5: hex("#59C2FF"),
545:         bracketPair6: hex("#AAD94C"),
546:         indentGuide: hex("#1C212B"),
547:         indentGuideActive: hex("#3D424D"),
548:         sidebarBackground: hex("#0D1016"),
549:         sidebarForeground: hex("#B3B1AD"),
550:         sidebarSectionHeader: hex("#0A0E14"),
551:         sidebarSelection: hex("#273747"),
552:         activityBarBackground: hex("#0A0E14"),
553:         activityBarForeground: hex("#B3B1AD"),
554:         activityBarSelection: hex("#E6B450"),
555:         tabBarBackground: hex("#0D1016"),
556:         tabActiveBackground: hex("#0A0E14"),
557:         tabInactiveBackground: hex("#0D1016"),
558:         tabActiveForeground: hex("#B3B1AD"),
559:         tabInactiveForeground: hex("#3D424D"),
560:         statusBarBackground: hex("#0D1016"),
561:         statusBarForeground: hex("#B3B1AD"),
562:         keyword: hex("#FF8F40"),
563:         string: hex("#AAD94C"),
564:         number: hex("#DFBFFF"),
565:         comment: hex("#626A73"),
566:         function: hex("#FFB454"),
567:         type: hex("#59C2FF"),
568:         variable: hex("#B3B1AD")
569:     )
570:     
571:     static let ayuLight = Theme(
572:         id: "ayu_light",
573:         name: "Ayu Light",
574:         isDark: false,
575:         editorBackground: hex("#FAFAFA"),
576:         editorForeground: hex("#5C6166"),
577:         selection: hex("#D1E4F4"),
578:         cursor: hex("#FF9940"),
579:         lineNumber: hex("#9DA2A6"),
580:         lineNumberActive: hex("#FF9940"),
581:         currentLineHighlight: hex("#EFF0F1"),
582:         bracketPair1: hex("#F2AE49"),
583:         bracketPair2: hex("#399EE6"),
584:         bracketPair3: hex("#86B300"),
585:         bracketPair4: hex("#F2AE49"),
586:         bracketPair5: hex("#399EE6"),
587:         bracketPair6: hex("#86B300"),
588:         indentGuide: hex("#E7E8E9"),
589:         indentGuideActive: hex("#9DA2A6"),
590:         sidebarBackground: hex("#F0F0F0"),
591:         sidebarForeground: hex("#5C6166"),
592:         sidebarSectionHeader: hex("#E7E7E7"),
593:         sidebarSelection: hex("#D1E4F4"),
594:         activityBarBackground: hex("#F0F0F0"),
595:         activityBarForeground: hex("#5C6166"),
596:         activityBarSelection: hex("#FF9940"),
597:         tabBarBackground: hex("#F0F0F0"),
598:         tabActiveBackground: hex("#FAFAFA"),
599:         tabInactiveBackground: hex("#F0F0F0"),
600:         tabActiveForeground: hex("#5C6166"),
601:         tabInactiveForeground: hex("#9DA2A6"),
602:         statusBarBackground: hex("#F0F0F0"),
603:         statusBarForeground: hex("#5C6166"),
604:         keyword: hex("#FA8D3E"),
605:         string: hex("#86B300"),
606:         number: hex("#A37ACC"),
607:         comment: hex("#ABB0B6"),
608:         function: hex("#F2AE49"),
609:         type: hex("#399EE6"),
610:         variable: hex("#5C6166")
611:     )
612:     
613:     static let ayuMirage = Theme(
614:         id: "ayu_mirage",
615:         name: "Ayu Mirage",
616:         isDark: true,
617:         editorBackground: hex("#1F2430"),
618:         editorForeground: hex("#CBCCC6"),
619:         selection: hex("#33415E"),
620:         cursor: hex("#FFCC66"),
621:         lineNumber: hex("#707A8C"),
622:         lineNumberActive: hex("#FFCC66"),
623:         currentLineHighlight: hex("#232834"),
624:         bracketPair1: hex("#FFD580"),
625:         bracketPair2: hex("#73D0FF"),
626:         bracketPair3: hex("#BAE67E"),
627:         bracketPair4: hex("#FFD580"),
628:         bracketPair5: hex("#73D0FF"),
629:         bracketPair6: hex("#BAE67E"),
630:         indentGuide: hex("#2D3640"),
631:         indentGuideActive: hex("#707A8C"),
632:         sidebarBackground: hex("#232834"),
633:         sidebarForeground: hex("#CBCCC6"),
634:         sidebarSectionHeader: hex("#1F2430"),
635:         sidebarSelection: hex("#33415E"),
636:         activityBarBackground: hex("#1F2430"),
637:         activityBarForeground: hex("#CBCCC6"),
638:         activityBarSelection: hex("#FFCC66"),
639:         tabBarBackground: hex("#232834"),
640:         tabActiveBackground: hex("#1F2430"),
641:         tabInactiveBackground: hex("#232834"),
642:         tabActiveForeground: hex("#CBCCC6"),
643:         tabInactiveForeground: hex("#707A8C"),
644:         statusBarBackground: hex("#232834"),
645:         statusBarForeground: hex("#CBCCC6"),
646:         keyword: hex("#FFA759"),
647:         string: hex("#BAE67E"),
648:         number: hex("#D4BFFF"),
649:         comment: hex("#5C6773"),
650:         function: hex("#FFD580"),
651:         type: hex("#73D0FF"),
652:         variable: hex("#CBCCC6")
653:     )
654:     
655:     static let quietLight = Theme(
656:         id: "quiet_light",
657:         name: "Quiet Light",
658:         isDark: false,
659:         editorBackground: hex("#F5F5F5"),
660:         editorForeground: hex("#333333"),
661:         selection: hex("#C9D0D9"),
662:         cursor: hex("#54494B"),
663:         lineNumber: hex("#AAAAAA"),
664:         lineNumberActive: hex("#333333"),
665:         currentLineHighlight: hex("#E4F6D4"),
666:         bracketPair1: hex("#7A3E9D"),
667:         bracketPair2: hex("#448C27"),
668:         bracketPair3: hex("#4B83CD"),
669:         bracketPair4: hex("#7A3E9D"),
670:         bracketPair5: hex("#448C27"),
671:         bracketPair6: hex("#4B83CD"),
672:         indentGuide: hex("#E0E0E0"),
673:         indentGuideActive: hex("#AAAAAA"),
674:         sidebarBackground: hex("#E7E7E7"),
675:         sidebarForeground: hex("#333333"),
676:         sidebarSectionHeader: hex("#DDDDDD"),
677:         sidebarSelection: hex("#C9D0D9"),
678:         activityBarBackground: hex("#E7E7E7"),
679:         activityBarForeground: hex("#333333"),
680:         activityBarSelection: hex("#333333"),
681:         tabBarBackground: hex("#E7E7E7"),
682:         tabActiveBackground: hex("#F5F5F5"),
683:         tabInactiveBackground: hex("#E7E7E7"),
684:         tabActiveForeground: hex("#333333"),
685:         tabInactiveForeground: hex("#AAAAAA"),
686:         statusBarBackground: hex("#E7E7E7"),
687:         statusBarForeground: hex("#333333"),
688:         keyword: hex("#4B83CD"),
689:         string: hex("#448C27"),
690:         number: hex("#AB6526"),
691:         comment: hex("#AAAAAA"),
692:         function: hex("#7A3E9D"),
693:         type: hex("#7A3E9D"),
694:         variable: hex("#333333")
695:     )
696:     
697:     static let red = Theme(
698:         id: "red",
699:         name: "Red",
700:         isDark: true,
701:         editorBackground: hex("#390000"),
702:         editorForeground: hex("#F8F8F8"),
703:         selection: hex("#750000"),
704:         cursor: hex("#FF0000"),
705:         lineNumber: hex("#FF6666"),
706:         lineNumberActive: hex("#FFFFFF"),
707:         currentLineHighlight: hex("#500000"),
708:         bracketPair1: hex("#FFFF66"),
709:         bracketPair2: hex("#AAFFAA"),
710:         bracketPair3: hex("#AADDFF"),
711:         bracketPair4: hex("#FFFF66"),
712:         bracketPair5: hex("#AAFFAA"),
713:         bracketPair6: hex("#AADDFF"),
714:         indentGuide: hex("#550000"),
715:         indentGuideActive: hex("#CC6666"),
716:         sidebarBackground: hex("#300000"),
717:         sidebarForeground: hex("#F8F8F8"),
718:         sidebarSectionHeader: hex("#500000"),
719:         sidebarSelection: hex("#750000"),
720:         activityBarBackground: hex("#390000"),
721:         activityBarForeground: hex("#F8F8F8"),
722:         activityBarSelection: hex("#FF0000"),
723:         tabBarBackground: hex("#300000"),
724:         tabActiveBackground: hex("#390000"),
725:         tabInactiveBackground: hex("#300000"),
726:         tabActiveForeground: hex("#FFFFFF"),
727:         tabInactiveForeground: hex("#CC6666"),
728:         statusBarBackground: hex("#FF0000"),
729:         statusBarForeground: hex("#FFFFFF"),
730:         keyword: hex("#FF6666"),
731:         string: hex("#FFA0A0"),
732:         number: hex("#FFD0D0"),
733:         comment: hex("#CC6666"),
734:         function: hex("#FFFF66"),
735:         type: hex("#AAFFAA"),
736:         variable: hex("#AADDFF")
737:     )
738:     
739:     static let tomorrowNight = Theme(
740:         id: "tomorrow_night",
741:         name: "Tomorrow Night",
742:         isDark: true,
743:         editorBackground: hex("#1D1F21"),
744:         editorForeground: hex("#C5C8C6"),
745:         selection: hex("#373B41"),
746:         cursor: hex("#AEAFAD"),
747:         lineNumber: hex("#969896"),
748:         lineNumberActive: hex("#C5C8C6"),
749:         currentLineHighlight: hex("#282A2E"),
750:         bracketPair1: hex("#F0C674"),
751:         bracketPair2: hex("#B5BD68"),
752:         bracketPair3: hex("#81A2BE"),
753:         bracketPair4: hex("#F0C674"),
754:         bracketPair5: hex("#B5BD68"),
755:         bracketPair6: hex("#81A2BE"),
756:         indentGuide: hex("#373B41"),
757:         indentGuideActive: hex("#969896"),
758:         sidebarBackground: hex("#1D1F21"),
759:         sidebarForeground: hex("#C5C8C6"),
760:         sidebarSectionHeader: hex("#282A2E"),
761:         sidebarSelection: hex("#373B41"),
762:         activityBarBackground: hex("#1D1F21"),
763:         activityBarForeground: hex("#C5C8C6"),
764:         activityBarSelection: hex("#81A2BE"),
765:         tabBarBackground: hex("#1D1F21"),
766:         tabActiveBackground: hex("#282A2E"),
767:         tabInactiveBackground: hex("#1D1F21"),
768:         tabActiveForeground: hex("#C5C8C6"),
769:         tabInactiveForeground: hex("#969896"),
770:         statusBarBackground: hex("#282A2E"),
771:         statusBarForeground: hex("#C5C8C6"),
772:         keyword: hex("#B294BB"),
773:         string: hex("#B5BD68"),
774:         number: hex("#DE935F"),
775:         comment: hex("#969896"),
776:         function: hex("#81A2BE"),
777:         type: hex("#F0C674"),
778:         variable: hex("#CC6666")
779:     )
780:     
781:     static let tomorrowNightBlue = Theme(
782:         id: "tomorrow_night_blue",
783:         name: "Tomorrow Night Blue",
784:         isDark: true,
785:         editorBackground: hex("#002451"),
786:         editorForeground: hex("#FFFFFF"),
787:         selection: hex("#003F8E"),
788:         cursor: hex("#FFFFFF"),
789:         lineNumber: hex("#7285B7"),
790:         lineNumberActive: hex("#FFFFFF"),
791:         currentLineHighlight: hex("#00346E"),
792:         bracketPair1: hex("#FFEEAD"),
793:         bracketPair2: hex("#D1F1A9"),
794:         bracketPair3: hex("#BBDAFF"),
795:         bracketPair4: hex("#FFEEAD"),
796:         bracketPair5: hex("#D1F1A9"),
797:         bracketPair6: hex("#BBDAFF"),
798:         indentGuide: hex("#003875"),
799:         indentGuideActive: hex("#7285B7"),
800:         sidebarBackground: hex("#001E40"),
801:         sidebarForeground: hex("#FFFFFF"),
802:         sidebarSectionHeader: hex("#003875"),
803:         sidebarSelection: hex("#003F8E"),
804:         activityBarBackground: hex("#002451"),
805:         activityBarForeground: hex("#FFFFFF"),
806:         activityBarSelection: hex("#BBDAFF"),
807:         tabBarBackground: hex("#001E40"),
808:         tabActiveBackground: hex("#002451"),
809:         tabInactiveBackground: hex("#001E40"),
810:         tabActiveForeground: hex("#FFFFFF"),
811:         tabInactiveForeground: hex("#7285B7"),
812:         statusBarBackground: hex("#003875"),
813:         statusBarForeground: hex("#FFFFFF"),
814:         keyword: hex("#EBBBFF"),
815:         string: hex("#D1F1A9"),
816:         number: hex("#FFC58F"),
817:         comment: hex("#7285B7"),
818:         function: hex("#BBDAFF"),
819:         type: hex("#FFEEAD"),
820:         variable: hex("#FF9DA4")
821:     )
822:     
823:     static let highContrast = Theme(
824:         id: "high_contrast",
825:         name: "High Contrast",
826:         isDark: true,
827:         editorBackground: hex("#000000"),
828:         editorForeground: hex("#FFFFFF"),
829:         selection: hex("#FFFFFF").opacity(0.3),
830:         cursor: hex("#FFFFFF"),
831:         lineNumber: hex("#FFFFFF"),
832:         lineNumberActive: hex("#FFFFFF"),
833:         currentLineHighlight: hex("#FFFFFF").opacity(0.1),
834:         bracketPair1: hex("#FFD700"),
835:         bracketPair2: hex("#00FF00"),
836:         bracketPair3: hex("#00BFFF"),
837:         bracketPair4: hex("#FFD700"),
838:         bracketPair5: hex("#00FF00"),
839:         bracketPair6: hex("#00BFFF"),
840:         indentGuide: hex("#FFFFFF").opacity(0.2),
841:         indentGuideActive: hex("#FFFFFF").opacity(0.5),
842:         sidebarBackground: hex("#000000"),
843:         sidebarForeground: hex("#FFFFFF"),
844:         sidebarSectionHeader: hex("#000000"),
845:         sidebarSelection: hex("#FFFFFF").opacity(0.15),
846:         activityBarBackground: hex("#000000"),
847:         activityBarForeground: hex("#FFFFFF"),
848:         activityBarSelection: hex("#FFFFFF"),
849:         tabBarBackground: hex("#000000"),
850:         tabActiveBackground: hex("#000000"),
851:         tabInactiveBackground: hex("#000000"),
852:         tabActiveForeground: hex("#FFFFFF"),
853:         tabInactiveForeground: hex("#FFFFFF").opacity(0.6),
854:         statusBarBackground: hex("#0000AA"),
855:         statusBarForeground: hex("#FFFFFF"),
856:         keyword: hex("#569CD6"),
857:         string: hex("#CE9178"),
858:         number: hex("#B5CEA8"),
859:         comment: hex("#7CA668"),
860:         function: hex("#DCDCAA"),
861:         type: hex("#4EC9B0"),
862:         variable: hex("#9CDCFE")
863:     )
864:     
865:     // MARK: - All Themes
866:     static let allThemes: [Theme] = [
867:         .darkPlus,
868:         .lightPlus,
869:         .monokai,
870:         .solarizedDark,
871:         .solarizedLight,
872:         .dracula,
873:         .oneDarkPro,
874:         .nord,
875:         .githubDark,
876:         .githubLight,
877:         .cobalt2,
878:         .ayuDark,
879:         .ayuLight,
880:         .ayuMirage,
881:         .quietLight,
882:         .red,
883:         .tomorrowNight,
884:         .tomorrowNightBlue,
885:         .highContrast
886:     ]
887: }


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift", "start_line": 861, "end_line": 950}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift (lines 862-950 of 1995)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
862:             guard let range = self.layoutManager.characterRange(forGlyphRange: glyphRange, actualGlyphRange: nil) as NSRange?,
863:                   let text = self.text as NSString? else { return }
864: 
865:             let lineText = text.substring(with: range)
866: 
867:             // Calculate indentation level
868:             var spaces = 0
869:             for char in lineText {
870:                 if char == " " { spaces += 1 }
871:                 else if char == "\t" { spaces += tabSize } // Handle tabs if present
872:                 else { break }
873:             }
874: 
875:             let indentLevel = spaces / tabSize
876:             guard indentLevel > 0 else { return }
877: 
878:             let isCaretLine = (caretY != nil) && abs(rect.minY - (caretY ?? 0)) < 0.5
879: 
880:             for i in 1...indentLevel {
881:                 let x = CGFloat(i) * indentWidth + self.textContainerInset.left
882:                 let startPoint = CGPoint(x: x, y: rect.minY)
883:                 let endPoint = CGPoint(x: x, y: rect.maxY)
884: 
885:                 let stroke = (isCaretLine && i == activeIndentLevel) ? self.activeIndentGuideColor : self.indentGuideColor
886:                 context.setStrokeColor(stroke.cgColor)
887: 
888:                 context.move(to: startPoint)
889:                 context.addLine(to: endPoint)
890:                 context.strokePath()
891:             }
892:         }
893:     }
894:     
895:     override var keyCommands: [UIKeyCommand]? {
896:         var commands = super.keyCommands ?? []
897:         
898:         // Peek Definition: Alt+F12 (using special key input)
899:         // Note: F12 is not directly available on iPadOS keyboards
900:         // Using Option+D as alternative
901:         commands.append(UIKeyCommand(
902:             input: "d",
903:             modifierFlags: .alternate,
904:             action: #selector(handlePeekDefinition)
905:         ))
906: 
907:         // Go to Line: Cmd+G
908:         commands.append(UIKeyCommand(
909:             input: "g",
910:             modifierFlags: .command,
911:             action: #selector(handleGoToLine)
912:         ))
913: 
914:         // Tab: accept autocomplete if visible, else insert tab
915:         commands.append(UIKeyCommand(
916:             input: "\t",
917:             modifierFlags: [],
918:             action: #selector(handleTab)
919:         ))
920:         
921:         // Escape: dismiss autocomplete if visible, else normal escape behavior
922:         commands.append(UIKeyCommand(
923:             input: UIKeyCommand.inputEscape,
924:             modifierFlags: [],
925:             action: #selector(handleEscape)
926:         ))
927:         
928:         // Fold: Cmd+Opt+[
929:         commands.append(UIKeyCommand(
930:             input: "[",
931:             modifierFlags: [.command, .alternate],
932:             action: #selector(handleFold)
933:         ))
934:         
935:         // Unfold: Cmd+Opt+]
936:         commands.append(UIKeyCommand(
937:             input: "]",
938:             modifierFlags: [.command, .alternate],
939:             action: #selector(handleUnfold)
940:         ))
941:         
942:         // MARK: - App-Level Shortcuts (UITextView captures keyboard, so we MUST register here)
943:         // These post to NotificationCenter so ContentView can handle them
944:         
945:         // Command Palette: Cmd+Shift+P
946:         commands.append(UIKeyCommand(
947:             input: "p",
948:             modifierFlags: [.command, .shift],
949:             action: #selector(handleShowCommandPalette),
950:             discoverabilityTitle: "Command Palette"


>>>TOOL move_file
{"from": "VSCodeiPadOS/VSCodeiPadOS/Services/ThemeManager.swift", "to": "VSCodeiPadOS/VSCodeiPadOS/Services/ThemeManager.swift.bak"}
>>>END

---

## üîß TOOL RESULTS

[move_file]
‚úÖ Moved: VSCodeiPadOS/VSCodeiPadOS/Services/ThemeManager.swift ‚Üí VSCodeiPadOS/VSCodeiPadOS/Services/ThemeManager.swift.bak


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/SidebarView.swift", "start_line": 200, "end_line": 210}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/SidebarView.swift (lines 201-210 of 288)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
201:                 Image(systemName: icon)
202:                     .font(.system(size: 20, weight: .light))
203:                     .foregroundColor(isSelected && editorCore.showSidebar ? .primary : .secondary)
204:                     .frame(width: 50, height: 50)
205:                     .contentShape(Rectangle())
206:             }
207:         }
208:         .buttonStyle(PlainButtonStyle())
209:         .help(title)
210:         .accessibilityIdentifier(accessibilityID)


>>>TOOL search
{"query": "SidebarView(", "glob": "VSCodeiPadOS/VSCodeiPadOS/ContentView.swift"}
>>>END

---

## üîß TOOL RESULTS

[search]
No matches found for "SidebarView("


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/ContentView.swift"}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/ContentView.swift (lines 1-1064 of 1064)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1: import SwiftUI
2: import UIKit
3: import UniformTypeIdentifiers
4: 
5: // MARK: - Helper Functions
6: // Moved to Extensions/FileHelpers.swift
7: 
8: // MARK: - Main Content View
9: 
10: struct ContentView: View {
11:     @EnvironmentObject var editorCore: EditorCore
12:     @StateObject private var fileNavigator = FileSystemNavigator()
13:     @StateObject private var themeManager = ThemeManager.shared
14:     
15:     @State private var showingDocumentPicker = false
16:     @State private var showingFolderPicker = false
17:     @State private var showSettings = false
18:     @State private var showTerminal = false
19:     @State private var terminalHeight: CGFloat = 200
20:     @State private var selectedSidebarTab = 0
21:     @State private var pendingTrustURL: URL?
22:     @State private var windowTitle: String = "VS Code"
23:     
24:     @StateObject private var trustManager = WorkspaceTrustManager.shared
25:     
26:     private var theme: Theme { themeManager.currentTheme }
27:     
28:     var body: some View {
29:         ZStack {
30:             VStack(spacing: 0) {
31:                 HStack(spacing: 0) {
32:                     IDEActivityBar(editorCore: editorCore, selectedTab: $selectedSidebarTab, showSettings: $showSettings, showTerminal: $showTerminal)
33:                     
34:                     if editorCore.showSidebar {
35:                         sidebarContent.frame(width: editorCore.sidebarWidth)
36:                     }
37:                     
38:                     VStack(spacing: 0) {
39:                         IDETabBar(editorCore: editorCore, theme: theme)
40:                         
41:                         if let tab = editorCore.activeTab {
42:                             IDEEditorView(editorCore: editorCore, tab: tab, theme: theme)
43:                                 .id(tab.id)  // Force view recreation when tab changes
44:                         } else {
45:                             IDEWelcomeView(editorCore: editorCore, showFolderPicker: $showingFolderPicker, theme: theme)
46:                         }
47:                         
48:                         StatusBarView(editorCore: editorCore)
49:                     }
50:                 }
51:                 
52:                 if showTerminal {
53:                     PanelView(isVisible: $showTerminal, height: $terminalHeight)
54:                 }
55:             }
56:             .background(theme.editorBackground)
57:             
58:             // Overlays - Command Palette (Cmd+Shift+P)
59:             if editorCore.showCommandPalette {
60:                 Color.black.opacity(0.4).ignoresSafeArea().onTapGesture { editorCore.showCommandPalette = false }
61:                 CommandPaletteView(editorCore: editorCore, showSettings: $showSettings, showTerminal: $showTerminal)
62:             }
63:             
64:             // Quick Open (Cmd+P)
65:             if editorCore.showQuickOpen {
66:                 Color.black.opacity(0.4).ignoresSafeArea().onTapGesture { editorCore.showQuickOpen = false }
67:                 QuickOpenView(editorCore: editorCore, fileNavigator: fileNavigator)
68:             }
69:             
70:             // Go To Symbol (Cmd+Shift+O)
71:             if editorCore.showGoToSymbol {
72:                 Color.black.opacity(0.4).ignoresSafeArea().onTapGesture { editorCore.showGoToSymbol = false }
73:                 GoToSymbolView(editorCore: editorCore, onGoToLine: { _ in })
74:             }
75:             
76:             // AI Assistant
77:             if editorCore.showAIAssistant {
78:                 HStack { Spacer(); IDEAIAssistant(editorCore: editorCore, theme: theme).frame(width: 400, height: 500).padding() }
79:             }
80:             
81:             // Go To Line (Ctrl+G)
82:             if editorCore.showGoToLine {
83:                 Color.black.opacity(0.4).ignoresSafeArea().onTapGesture { editorCore.showGoToLine = false }
84:                 GoToLineView(isPresented: $editorCore.showGoToLine, onGoToLine: { _ in })
85:             }
86:             
87:             // Workspace Trust Dialog
88:             if let trustURL = pendingTrustURL {
89:                 Color.black.opacity(0.4).ignoresSafeArea()
90:                 WorkspaceTrustDialog(workspaceURL: trustURL, onTrust: {
91:                     trustManager.trust(url: trustURL)
92:                     finishOpeningWorkspace(trustURL)
93:                     pendingTrustURL = nil
94:                 }, onCancel: {
95:                     pendingTrustURL = nil
96:                 })
97:             }
98:         }
99:         .sheet(isPresented: $showingDocumentPicker) { IDEDocumentPicker(editorCore: editorCore) }
100:         .sheet(isPresented: $showingFolderPicker) {
101:             IDEFolderPicker(fileNavigator: fileNavigator) { url in
102:                 if trustManager.isTrusted(url: url) {
103:                     finishOpeningWorkspace(url)
104:                 } else {
105:                     pendingTrustURL = url
106:                 }
107:             }
108:         }
109:         .sheet(isPresented: $showSettings) { SettingsView(themeManager: themeManager) }
110:         .onChange(of: editorCore.showFilePicker) { show in showingDocumentPicker = show }
111:         .onChange(of: editorCore.activeTab?.fileName) { newFileName in
112:             updateWindowTitle()
113:         }
114:         .onChange(of: editorCore.tabs.count) { _ in
115:             updateWindowTitle()
116:         }
117:         .onAppear {
118:             updateWindowTitle()
119:         }
120:         // MARK: - Notification Handlers for Menu Keyboard Shortcuts
121:         .onReceive(NotificationCenter.default.publisher(for: NSNotification.Name("ShowCommandPalette"))) { _ in
122:             editorCore.showCommandPalette = true
123:         }
124:         .onReceive(NotificationCenter.default.publisher(for: NSNotification.Name("ToggleTerminal"))) { _ in
125:             showTerminal.toggle()
126:         }
127:         .onReceive(NotificationCenter.default.publisher(for: NSNotification.Name("ToggleSidebar"))) { _ in
128:             editorCore.toggleSidebar()
129:         }
130:         .onReceive(NotificationCenter.default.publisher(for: NSNotification.Name("ShowQuickOpen"))) { _ in
131:             editorCore.showQuickOpen = true
132:         }
133:         .onReceive(NotificationCenter.default.publisher(for: NSNotification.Name("ShowGoToSymbol"))) { _ in
134:             editorCore.showGoToSymbol = true
135:         }
136:         .onReceive(NotificationCenter.default.publisher(for: NSNotification.Name("ShowGoToLine"))) { _ in
137:             editorCore.showGoToLine = true
138:         }
139:         .onReceive(NotificationCenter.default.publisher(for: NSNotification.Name("ShowAIAssistant"))) { _ in
140:             editorCore.showAIAssistant = true
141:         }
142:         .onReceive(NotificationCenter.default.publisher(for: NSNotification.Name("NewFile"))) { _ in
143:             editorCore.addTab()
144:         }
145:         .onReceive(NotificationCenter.default.publisher(for: NSNotification.Name("SaveFile"))) { _ in
146:             editorCore.saveActiveTab()
147:         }
148:         .onReceive(NotificationCenter.default.publisher(for: NSNotification.Name("CloseTab"))) { _ in
149:             if let id = editorCore.activeTabId { editorCore.closeTab(id: id) }
150:         }
151:         .onReceive(NotificationCenter.default.publisher(for: NSNotification.Name("ShowFind"))) { _ in
152:             editorCore.showSearch = true
153:         }
154:         .onReceive(NotificationCenter.default.publisher(for: NSNotification.Name("ZoomIn"))) { _ in
155:             editorCore.zoomIn()
156:         }
157:         .onReceive(NotificationCenter.default.publisher(for: NSNotification.Name("ZoomOut"))) { _ in
158:             editorCore.zoomOut()
159:         }
160:         .environmentObject(themeManager)
161:         .environmentObject(editorCore)
162:     }
163:     
164:     private func finishOpeningWorkspace(_ url: URL) {
165:         fileNavigator.loadFileTree(at: url)
166:         Task { @MainActor in
167:             LaunchManager.shared.setWorkspaceRoot(url)
168:             GitManager.shared.setWorkingDirectory(url)
169:         }
170:     }
171:     
172:     private func updateWindowTitle() {
173:         if let activeTab = editorCore.activeTab {
174:             let fileName = activeTab.fileName
175:             let unsavedIndicator = activeTab.isUnsaved ? "‚óè " : ""
176:             windowTitle = "\(unsavedIndicator)\(fileName) - VS Code"
177:         } else if !editorCore.tabs.isEmpty {
178:             windowTitle = "VS Code"
179:         } else {
180:             windowTitle = "Welcome - VS Code"
181:         }
182:         
183:         // Notify the app of the title change
184:         NotificationCenter.default.post(
185:             name: NSNotification.Name("WindowTitleDidChange"),
186:             object: nil,
187:             userInfo: ["title": windowTitle]
188:         )
189:     }
190:     
191:     @ViewBuilder
192:     private var sidebarContent: some View {
193:         switch selectedSidebarTab {
194:         case 0:
195:             IDESidebarFiles(editorCore: editorCore, fileNavigator: fileNavigator, showFolderPicker: $showingFolderPicker, theme: theme)
196:         case 1:
197:             SidebarSearchView(theme: theme)
198:         case 2:
199:             GitView()
200:         case 3:
201:             DebugView()
202:         default:
203:             IDESidebarFiles(editorCore: editorCore, fileNavigator: fileNavigator, showFolderPicker: $showingFolderPicker, theme: theme)
204:         }
205:     }
206: }
207: 
208: // MARK: - Activity Bar
209: 
210: 
211: 
212: struct BarButton: View {
213:     let icon: String
214:     let isSelected: Bool
215:     let theme: Theme
216:     let action: () -> Void
217:     
218:     var body: some View {
219:         Button(action: action) {
220:             Image(systemName: icon)
221:                 .font(.system(size: 22))
222:                 .foregroundColor(isSelected ? theme.activityBarSelection : theme.activityBarForeground.opacity(0.6))
223:                 .frame(width: 48, height: 48)
224:         }
225:     }
226: }
227: 
228: // MARK: - Sidebar with Real File System
229: 
230: struct IDESidebarFiles: View {
231:     @ObservedObject var editorCore: EditorCore
232:     @ObservedObject var fileNavigator: FileSystemNavigator
233:     @Binding var showFolderPicker: Bool
234:     let theme: Theme
235:     
236:     var body: some View {
237:         VStack(alignment: .leading, spacing: 0) {
238:             HStack {
239:                 Text("EXPLORER").font(.caption).fontWeight(.semibold).foregroundColor(theme.sidebarForeground.opacity(0.7))
240:                 Spacer()
241:                 Button(action: { showFolderPicker = true }) {
242:                     Image(systemName: "folder.badge.plus").font(.caption)
243:                 }.foregroundColor(theme.sidebarForeground.opacity(0.7))
244:                 Button(action: { editorCore.showFilePicker = true }) {
245:                     Image(systemName: "doc.badge.plus").font(.caption)
246:                 }.foregroundColor(theme.sidebarForeground.opacity(0.7))
247:                 if fileNavigator.fileTree != nil {
248:                     Button(action: { fileNavigator.refreshFileTree() }) {
249:                         Image(systemName: "arrow.clockwise").font(.caption)
250:                     }.foregroundColor(theme.sidebarForeground.opacity(0.7))
251:                 }
252:             }.padding(.horizontal, 12).padding(.vertical, 8)
253:             
254:             ScrollView {
255:                 VStack(alignment: .leading, spacing: 2) {
256:                     if let tree = fileNavigator.fileTree {
257:                         FileTreeView(root: tree, fileNavigator: fileNavigator, editorCore: editorCore)
258:                     } else {
259:                         DemoFileTree(editorCore: editorCore, theme: theme)
260:                     }
261:                 }.padding(.horizontal, 8)
262:             }
263:         }.background(theme.sidebarBackground)
264:     }
265: }
266: 
267: struct RealFileTreeView: View {
268:     let node: FileTreeNode
269:     let level: Int
270:     @ObservedObject var fileNavigator: FileSystemNavigator
271:     @ObservedObject var editorCore: EditorCore
272:     let theme: Theme
273:     
274:     var isExpanded: Bool { fileNavigator.expandedPaths.contains(node.url.path) }
275:     
276:     var body: some View {
277:         VStack(alignment: .leading, spacing: 2) {
278:             HStack(spacing: 4) {
279:                 if node.isDirectory {
280:                     Image(systemName: isExpanded ? "chevron.down" : "chevron.right")
281:                         .font(.caption2).frame(width: 12)
282:                         .foregroundColor(theme.sidebarForeground.opacity(0.6))
283:                         .onTapGesture { fileNavigator.toggleExpanded(path: node.url.path) }
284:                 } else {
285:                     Spacer().frame(width: 12)
286:                 }
287:                 Image(systemName: node.isDirectory ? "folder.fill" : fileIcon(for: node.name))
288:                     .font(.caption)
289:                     .foregroundColor(node.isDirectory ? .yellow : fileColor(for: node.name))
290:                 Text(node.name).font(.system(.caption)).lineLimit(1)
291:                     .foregroundColor(theme.sidebarForeground)
292:                 Spacer()
293:             }
294:             .padding(.leading, CGFloat(level * 16)).padding(.vertical, 4)
295:             .contentShape(Rectangle())
296:             .onTapGesture {
297:                 if node.isDirectory {
298:                     fileNavigator.toggleExpanded(path: node.url.path)
299:                 } else {
300:                     editorCore.openFile(from: node.url)
301:                 }
302:             }
303:             
304:             if isExpanded && node.isDirectory {
305:                 ForEach(node.children) { child in
306:                     RealFileTreeView(node: child, level: level + 1, fileNavigator: fileNavigator, editorCore: editorCore, theme: theme)
307:                 }
308:             }
309:         }
310:     }
311: }
312: 
313: struct DemoFileTree: View {
314:     @ObservedObject var editorCore: EditorCore
315:     let theme: Theme
316:     
317:     var body: some View {
318:         VStack(alignment: .leading, spacing: 4) {
319:             Text("Open a folder to browse files")
320:                 .font(.caption)
321:                 .foregroundColor(theme.sidebarForeground.opacity(0.6))
322:                 .padding(.vertical, 8)
323:             
324:             DemoFileRow(name: "main.swift", editorCore: editorCore, theme: theme)
325:             DemoFileRow(name: "ContentView.swift", editorCore: editorCore, theme: theme)
326:             DemoFileRow(name: "README.md", editorCore: editorCore, theme: theme)
327:         }
328:     }
329: }
330: 
331: struct DemoFileRow: View {
332:     let name: String
333:     @ObservedObject var editorCore: EditorCore
334:     let theme: Theme
335:     
336:     var body: some View {
337:         HStack(spacing: 4) {
338:             Spacer().frame(width: 12)
339:             Image(systemName: fileIcon(for: name)).font(.caption).foregroundColor(fileColor(for: name))
340:             Text(name).font(.system(.caption)).lineLimit(1).foregroundColor(theme.sidebarForeground)
341:             Spacer()
342:         }
343:         .padding(.vertical, 4)
344:         .contentShape(Rectangle())
345:         .onTapGesture {
346:             editorCore.addTab(fileName: name, content: "// \(name)\n\n")
347:         }
348:     }
349: }
350: 
351: // MARK: - Tab Bar
352: 
353: struct IDETabBar: View {
354:     @ObservedObject var editorCore: EditorCore
355:     let theme: Theme
356:     
357:     var body: some View {
358:         ScrollView(.horizontal, showsIndicators: false) {
359:             HStack(spacing: 0) {
360:                 ForEach(editorCore.tabs) { tab in
361:                     IDETabItem(tab: tab, isSelected: editorCore.activeTabId == tab.id, editorCore: editorCore, theme: theme)
362:                 }
363:                 Button(action: { editorCore.addTab() }) {
364:                     Image(systemName: "plus").font(.caption).foregroundColor(theme.tabInactiveForeground).padding(8)
365:                 }
366:             }.padding(.horizontal, 4)
367:         }.frame(height: 36).background(theme.tabBarBackground)
368:     }
369: }
370: 
371: struct IDETabItem: View {
372:     let tab: Tab
373:     let isSelected: Bool
374:     @ObservedObject var editorCore: EditorCore
375:     let theme: Theme
376:     
377:     var body: some View {
378:         HStack(spacing: 6) {
379:             Image(systemName: fileIcon(for: tab.fileName)).font(.caption).foregroundColor(fileColor(for: tab.fileName))
380:             Text(tab.fileName).font(.system(size: 12)).lineLimit(1)
381:                 .foregroundColor(isSelected ? theme.tabActiveForeground : theme.tabInactiveForeground)
382:             if tab.isUnsaved { Circle().fill(Color.orange).frame(width: 6, height: 6) }
383:             Button(action: { editorCore.closeTab(id: tab.id) }) {
384:                 Image(systemName: "xmark").font(.system(size: 9, weight: .medium))
385:                     .foregroundColor(isSelected ? theme.tabActiveForeground.opacity(0.6) : theme.tabInactiveForeground)
386:             }
387:         }
388:         .padding(.horizontal, 12).padding(.vertical, 6)
389:         .background(RoundedRectangle(cornerRadius: 4).fill(isSelected ? theme.tabActiveBackground : theme.tabInactiveBackground))
390:         .onTapGesture { editorCore.selectTab(id: tab.id) }
391:     }
392: }
393: 
394: // MARK: - Editor with Syntax Highlighting + Autocomplete + Folding
395: 
396: struct IDEEditorView: View {
397:     @ObservedObject var editorCore: EditorCore
398:     let tab: Tab
399:     let theme: Theme
400: 
401:     @AppStorage("lineNumbersStyle") private var lineNumbersStyle: String = "on"
402:     @State private var text: String = ""
403:     @State private var scrollPosition: Int = 0
404:     @State private var totalLines: Int = 1
405:     @State private var visibleLines: Int = 20
406:     @State private var currentLineNumber: Int = 1
407:     @State private var currentColumn: Int = 1
408:     @State private var cursorIndex: Int = 0
409:     @State private var lineHeight: CGFloat = 17
410:     @State private var requestedCursorIndex: Int? = nil
411:     @State private var requestedLineSelection: Int? = nil
412: 
413:     @StateObject private var autocomplete = AutocompleteManager()
414:     @State private var showAutocomplete = false
415:     @StateObject private var foldingManager = CodeFoldingManager()
416:     @StateObject private var findViewModel = FindViewModel()
417:     
418:     var body: some View {
419:         VStack(spacing: 0) {
420:             // Find/Replace bar
421:             if editorCore.showSearch {
422:                 FindReplaceView(viewModel: findViewModel)
423:                     .background(theme.tabBarBackground)
424:             }
425:             
426:             BreadcrumbsView(editorCore: editorCore, tab: tab)
427:             
428:             GeometryReader { geometry in
429:                 ZStack(alignment: .topLeading) {
430:                 HStack(spacing: 0) {
431:                     if lineNumbersStyle != "off" {
432:                         LineNumbersWithFolding(
433:                             fileId: tab.url?.path ?? tab.fileName,
434:                             totalLines: totalLines,
435:                             currentLine: currentLineNumber,
436:                             scrollOffset: CGFloat(scrollPosition) * lineHeight,
437:                             lineHeight: lineHeight,
438:                             requestedLineSelection: $requestedLineSelection,
439:                             foldingManager: foldingManager,
440:                             theme: theme
441:                         )
442:                         .frame(width: 60)
443:                         .background(theme.sidebarBackground.opacity(0.5))
444:                     }
445:                     
446:                     if tab.fileName.hasSuffix(".json") {
447:                         // JSON Tree View for .json files
448:                         JSONTreeView(data: text.data(using: .utf8) ?? Data())
449:                             .frame(maxWidth: .infinity, maxHeight: .infinity)
450:                             .background(theme.editorBackground)
451:                     } else {
452:                         SyntaxHighlightingTextView(
453:                             text: $text,
454:                             filename: tab.fileName,
455:                             scrollPosition: $scrollPosition,
456:                             totalLines: $totalLines,
457:                             visibleLines: $visibleLines,
458:                             currentLineNumber: $currentLineNumber,
459:                             currentColumn: $currentColumn,
460:                             cursorIndex: $cursorIndex,
461:                             lineHeight: $lineHeight,
462:                             isActive: true,
463:                             fontSize: editorCore.editorFontSize,
464:                             requestedLineSelection: $requestedLineSelection,
465:                             requestedCursorIndex: $requestedCursorIndex,
466:                             onAcceptAutocomplete: {
467:                                 guard showAutocomplete else { return false }
468:                                 var tempText = text
469:                                 var tempCursor = cursorIndex
470:                                 autocomplete.commitCurrentSuggestion(into: &tempText, cursorPosition: &tempCursor)
471:                                 if tempText != text {
472:                                     text = tempText
473:                                     cursorIndex = tempCursor
474:                                     requestedCursorIndex = tempCursor
475:                                     showAutocomplete = false
476:                                     return true
477:                                 }
478:                                 return false
479:                             },
480:                             onDismissAutocomplete: {
481:                                 guard showAutocomplete else { return false }
482:                                 autocomplete.hideSuggestions()
483:                                 showAutocomplete = false
484:                                 return true
485:                             }
486:                         )
487:                         .onChange(of: text) { newValue in
488:                             editorCore.updateActiveTabContent(newValue)
489:                             editorCore.cursorPosition = CursorPosition(line: currentLineNumber, column: currentColumn)
490:                             autocomplete.updateSuggestions(for: newValue, cursorPosition: cursorIndex)
491:                             showAutocomplete = autocomplete.showSuggestions
492:                             foldingManager.detectFoldableRegions(in: newValue)
493:                         }
494:                         .onChange(of: cursorIndex) { newCursor in
495:                             autocomplete.updateSuggestions(for: text, cursorPosition: newCursor)
496:                             showAutocomplete = autocomplete.showSuggestions
497:                         }
498:                     }
499:                     
500:                     if !tab.fileName.hasSuffix(".json") {
501:                         MinimapView(
502:                             content: text,
503:                             scrollOffset: CGFloat(scrollPosition) * lineHeight,
504:                             scrollViewHeight: geometry.size.height,
505:                             totalContentHeight: CGFloat(totalLines) * lineHeight,
506:                             onScrollRequested: { newOffset in
507:                                 // Minimap requested scroll - update editor position
508:                                 // Convert back from pixels to line number
509:                                 let newLine = Int(newOffset / lineHeight)
510:                                 scrollPosition = max(0, min(newLine, totalLines - 1))
511:                             }
512:                         )
513:                         .frame(width: 80)
514:                     }
515:                 }
516:                 .background(theme.editorBackground)
517: 
518:                 // Sticky Header Overlay (FEAT-040)
519:                 StickyHeaderView(
520:                     text: text,
521:                     currentLine: scrollPosition,
522:                     theme: theme,
523:                     lineHeight: lineHeight,
524:                     onSelect: { line in
525:                         requestedLineSelection = line
526:                     }
527:                 )
528:                 .padding(.leading, lineNumbersStyle != "off" ? 60 : 0)
529:                 .padding(.trailing, tab.fileName.hasSuffix(".json") ? 0 : 80)
530: 
531:                 if showAutocomplete && !autocomplete.suggestionItems.isEmpty {
532:                     AutocompletePopup(
533:                         suggestions: autocomplete.suggestionItems,
534:                         selectedIndex: autocomplete.selectedIndex,
535:                         theme: theme
536:                     ) { index in
537:                         autocomplete.selectedIndex = index
538:                         var tempText = text
539:                         var tempCursor = cursorIndex
540:                         autocomplete.commitCurrentSuggestion(into: &tempText, cursorPosition: &tempCursor)
541:                         if tempText != text {
542:                             text = tempText
543:                             cursorIndex = tempCursor
544:                             requestedCursorIndex = tempCursor
545:                         }
546:                         showAutocomplete = false
547:                     }
548:                     .offset(x: 70, y: CGFloat(currentLineNumber) * lineHeight)
549:                 }
550:             }
551:         }
552:         }
553:         .onAppear {
554:             text = tab.content
555:             foldingManager.detectFoldableRegions(in: text)
556:         }
557:         .onChange(of: tab.id) { _ in
558:             text = tab.content
559:             foldingManager.detectFoldableRegions(in: text)
560:         }
561:         .onChange(of: currentLineNumber) { line in
562:             editorCore.cursorPosition = CursorPosition(line: line, column: currentColumn)
563:         }
564:         .onChange(of: currentColumn) { col in
565:             editorCore.cursorPosition = CursorPosition(line: currentLineNumber, column: col)
566:         }
567:         .onAppear {
568:             findViewModel.editorCore = editorCore
569:         }
570:     }
571:     
572:     // Autocomplete insertion is handled by AutocompleteManager.acceptSuggestion(...)
573: }
574: 
575: // MARK: - Line Numbers with Folding
576: 
577: struct LineNumbersWithFolding: View {
578:     let fileId: String
579:     let totalLines: Int
580:     let currentLine: Int
581:     let scrollOffset: CGFloat
582:     let lineHeight: CGFloat
583:     @Binding var requestedLineSelection: Int?
584:     @ObservedObject var foldingManager: CodeFoldingManager
585:     @ObservedObject private var debugManager = DebugManager.shared
586:     let theme: Theme
587: 
588:     @AppStorage("lineNumbersStyle") private var lineNumbersStyle: String = "on"
589: 
590:     var body: some View {
591:         ScrollView(showsIndicators: false) {
592:             VStack(alignment: .trailing, spacing: 0) {
593:                 ForEach(0..<totalLines, id: \.self) { lineIndex in
594:                     if !foldingManager.isLineFolded(line: lineIndex) {
595:                         HStack(spacing: 2) {
596:                             Button(action: { debugManager.toggleBreakpoint(file: fileId, line: lineIndex) }) {
597:                                 Circle()
598:                                     .fill(debugManager.hasBreakpoint(file: fileId, line: lineIndex) ? Color.red : Color.clear)
599:                                     .overlay(
600:                                         Circle()
601:                                             .stroke(Color.red.opacity(0.6), lineWidth: 1)
602:                                             .opacity(debugManager.hasBreakpoint(file: fileId, line: lineIndex) ? 0 : 0.25)
603:                                     )
604:                                     .frame(width: 10, height: 10)
605:                                     .padding(.leading, 2)
606:                             }
607:                             .buttonStyle(.plain)
608:                             .frame(width: 14, height: lineHeight)
609: 
610:                             if foldingManager.isFoldable(line: lineIndex) {
611:                                 Button(action: { foldingManager.toggleFold(at: lineIndex) }) {
612:                                     Image(systemName: foldingManager.foldRegions.first(where: { $0.startLine == lineIndex })?.isFolded == true ? "chevron.right" : "chevron.down")
613:                                         .font(.system(size: 8))
614:                                         .foregroundColor(theme.lineNumber)
615:                                 }
616:                                 .buttonStyle(.plain)
617:                                 .frame(width: 14, height: lineHeight)
618:                             } else {
619:                                 Spacer().frame(width: 14)
620:                             }
621: 
622:                             Text(displayText(for: lineIndex))
623:                                 .font(.system(size: 12, design: .monospaced))
624:                                 .foregroundColor(lineIndex + 1 == currentLine ? theme.lineNumberActive : theme.lineNumber)
625:                                 .frame(height: lineHeight)
626:                                 .contentShape(Rectangle())
627:                                 .onTapGesture {
628:                                     // FEAT-041: click line number selects entire line
629:                                     requestedLineSelection = lineIndex
630:                                 }
631:                         }
632:                         .frame(maxWidth: .infinity, alignment: .trailing)
633:                         .padding(.trailing, 4)
634:                     }
635:                 }
636:             }
637:             .offset(y: -scrollOffset)
638:         }
639:     }
640: 
641:     private func displayText(for lineIndex: Int) -> String {
642:         switch lineNumbersStyle {
643:         case "relative":
644:             // VS Code-style: current line shows absolute, others show relative distance
645:             let lineNumber = lineIndex + 1
646:             if lineNumber == currentLine { return "\(lineNumber)" }
647:             return "\(abs(lineNumber - currentLine))"
648: 
649:         case "interval":
650:             let lineNumber = lineIndex + 1
651:             return (lineNumber == 1 || lineNumber % 5 == 0) ? "\(lineNumber)" : ""
652: 
653:         default:
654:             return "\(lineIndex + 1)"
655:         }
656:     }
657: }
658: 
659: // MARK: - Autocomplete Popup
660: 
661: struct AutocompletePopup: View {
662:     let suggestions: [AutocompleteSuggestion]
663:     let selectedIndex: Int
664:     let theme: Theme
665:     let onSelectIndex: (Int) -> Void
666:     
667:     var body: some View {
668:         VStack(alignment: .leading, spacing: 0) {
669:             ForEach(suggestions.indices, id: \.self) { index in
670:                 let s = suggestions[index]
671:                 HStack(spacing: 6) {
672:                     Image(systemName: icon(for: s.kind))
673:                         .font(.caption)
674:                         .foregroundColor(color(for: s.kind))
675:                     VStack(alignment: .leading, spacing: 1) {
676:                         Text(s.displayText)
677:                             .font(.system(size: 12, design: .monospaced))
678:                             .foregroundColor(theme.editorForeground)
679:                         if s.insertText != s.displayText && !s.insertText.isEmpty {
680:                             Text(s.insertText)
681:                                 .font(.system(size: 10, design: .monospaced))
682:                                 .foregroundColor(theme.editorForeground.opacity(0.55))
683:                                 .lineLimit(1)
684:                         }
685:                     }
686:                     Spacer()
687:                 }
688:                 .padding(.horizontal, 8).padding(.vertical, 6)
689:                 .background(index == selectedIndex ? theme.selection : Color.clear)
690:                 .contentShape(Rectangle())
691:                 .onTapGesture { onSelectIndex(index) }
692:             }
693:         }
694:         .frame(width: 260)
695:         .background(theme.editorBackground)
696:         .cornerRadius(6)
697:         .shadow(radius: 8)
698:     }
699:     
700:     private func icon(for kind: AutocompleteSuggestionKind) -> String {
701:         switch kind {
702:         case .keyword: return "key.fill"
703:         case .symbol: return "cube.fill"
704:         case .stdlib: return "curlybraces"
705:         case .member: return "arrow.right.circle.fill"
706:         }
707:     }
708:     
709:     private func color(for kind: AutocompleteSuggestionKind) -> Color {
710:         switch kind {
711:         case .keyword: return .purple
712:         case .symbol: return .blue
713:         case .stdlib: return .orange
714:         case .member: return .green
715:         }
716:     }
717: }
718: 
719: // MARK: - Welcome View
720: 
721: struct IDEWelcomeView: View {
722:     @ObservedObject var editorCore: EditorCore
723:     @Binding var showFolderPicker: Bool
724:     let theme: Theme
725:     
726:     var body: some View {
727:         VStack(spacing: 24) {
728:             Image(systemName: "chevron.left.forwardslash.chevron.right").font(.system(size: 80)).foregroundColor(theme.editorForeground.opacity(0.3))
729:             Text("VS Code for iPadOS").font(.largeTitle).fontWeight(.bold).foregroundColor(theme.editorForeground)
730:             VStack(alignment: .leading, spacing: 12) {
731:                 WelcomeBtn(icon: "doc.badge.plus", title: "New File", shortcut: "‚åòN", theme: theme) { editorCore.addTab() }
732:                 WelcomeBtn(icon: "folder", title: "Open Folder", shortcut: "‚åò‚áßO", theme: theme) { showFolderPicker = true }
733:                 WelcomeBtn(icon: "doc", title: "Open File", shortcut: "‚åòO", theme: theme) { editorCore.showFilePicker = true }
734:                 WelcomeBtn(icon: "terminal", title: "Command Palette", shortcut: "‚åò‚áßP", theme: theme) { editorCore.showCommandPalette = true }
735:             }
736:         }.frame(maxWidth: .infinity, maxHeight: .infinity).background(theme.editorBackground)
737:     }
738: }
739: 
740: struct WelcomeBtn: View {
741:     let icon: String
742:     let title: String
743:     let shortcut: String
744:     let theme: Theme
745:     let action: () -> Void
746:     
747:     var body: some View {
748:         Button(action: action) {
749:             HStack {
750:                 Image(systemName: icon).frame(width: 24).foregroundColor(theme.editorForeground)
751:                 Text(title).foregroundColor(theme.editorForeground)
752:                 Spacer()
753:                 Text(shortcut).font(.caption).foregroundColor(theme.editorForeground.opacity(0.5))
754:             }
755:             .padding().frame(width: 280)
756:             .background(theme.sidebarBackground)
757:             .cornerRadius(8)
758:         }.buttonStyle(.plain)
759:     }
760: }
761: 
762: // MARK: - Command Palette
763: 
764: struct IDECommandPalette: View {
765:     @ObservedObject var editorCore: EditorCore
766:     @Binding var showSettings: Bool
767:     @Binding var showTerminal: Bool
768:     @State private var searchText = ""
769:     
770:     var body: some View {
771:         VStack(spacing: 0) {
772:             HStack {
773:                 Image(systemName: "magnifyingglass").foregroundColor(.secondary)
774:                 TextField("Type a command...", text: $searchText).textFieldStyle(.plain)
775:             }.padding().background(Color(UIColor.secondarySystemBackground))
776:             Divider()
777:             ScrollView {
778:                 VStack(spacing: 0) {
779:                     CommandRow(icon: "doc.badge.plus", name: "New File", shortcut: "‚åòN") { editorCore.addTab(); editorCore.showCommandPalette = false }
780:                     CommandRow(icon: "folder", name: "Open File", shortcut: "‚åòO") { editorCore.showFilePicker = true; editorCore.showCommandPalette = false }
781:                     CommandRow(icon: "square.and.arrow.down", name: "Save File", shortcut: "‚åòS") { editorCore.saveActiveTab(); editorCore.showCommandPalette = false }
782:                     CommandRow(icon: "sidebar.left", name: "Toggle Sidebar", shortcut: "‚åòB") { editorCore.toggleSidebar(); editorCore.showCommandPalette = false }
783:                     CommandRow(icon: "brain", name: "AI Assistant", shortcut: "‚åò‚áßA") { editorCore.showAIAssistant = true; editorCore.showCommandPalette = false }
784:                     CommandRow(icon: "terminal", name: "Toggle Terminal", shortcut: "‚åò`") { showTerminal.toggle(); editorCore.showCommandPalette = false }
785:                     CommandRow(icon: "gear", name: "Settings", shortcut: "‚åò,") { showSettings = true; editorCore.showCommandPalette = false }
786:                     CommandRow(icon: "number", name: "Go to Line", shortcut: "‚åòG") { editorCore.showGoToLine = true; editorCore.showCommandPalette = false }
787:                 }.padding(.vertical, 8)
788:             }
789:         }.frame(width: 500, height: 400).background(Color(UIColor.systemBackground)).cornerRadius(12).shadow(radius: 20)
790:     }
791: }
792: 
793: struct CommandRow: View {
794:     let icon: String; let name: String; let shortcut: String; let action: () -> Void
795:     var body: some View {
796:         Button(action: action) {
797:             HStack {
798:                 Image(systemName: icon).foregroundColor(.accentColor).frame(width: 24)
799:                 Text(name).foregroundColor(.primary)
800:                 Spacer()
801:                 Text(shortcut).font(.caption).foregroundColor(.secondary).padding(.horizontal, 8).padding(.vertical, 4).background(Color(UIColor.tertiarySystemFill)).cornerRadius(4)
802:             }.padding(.horizontal).padding(.vertical, 12).contentShape(Rectangle())
803:         }.buttonStyle(.plain)
804:     }
805: }
806: 
807: // MARK: - Quick Open
808: 
809: struct IDEQuickOpen: View {
810:     @ObservedObject var editorCore: EditorCore
811:     @State private var searchText = ""
812:     
813:     var body: some View {
814:         VStack(spacing: 0) {
815:             HStack {
816:                 Image(systemName: "magnifyingglass").foregroundColor(.gray)
817:                 TextField("Search files...", text: $searchText).textFieldStyle(.plain)
818:             }.padding().background(Color(UIColor.secondarySystemBackground))
819:             Divider()
820:             ScrollView {
821:                 VStack(alignment: .leading, spacing: 0) {
822:                     ForEach(editorCore.tabs) { tab in
823:                         QuickOpenRow(name: tab.fileName, path: "") {
824:                             editorCore.selectTab(id: tab.id)
825:                             editorCore.showQuickOpen = false
826:                         }
827:                     }
828:                 }
829:             }.frame(maxHeight: 350)
830:         }.frame(width: 500).background(Color(UIColor.systemBackground)).cornerRadius(12).shadow(radius: 20)
831:     }
832: }
833: 
834: struct QuickOpenRow: View {
835:     let name: String; let path: String; let action: () -> Void
836:     var body: some View {
837:         Button(action: action) {
838:             HStack {
839:                 Image(systemName: fileIcon(for: name)).foregroundColor(fileColor(for: name)).frame(width: 20)
840:                 VStack(alignment: .leading, spacing: 2) { Text(name).font(.system(size: 14)); Text(path + name).font(.system(size: 11)).foregroundColor(.secondary) }
841:                 Spacer()
842:             }.padding(.horizontal).padding(.vertical, 8).contentShape(Rectangle())
843:         }.buttonStyle(.plain)
844:     }
845: }
846: 
847: // MARK: - AI Assistant
848: 
849: struct IDEAIAssistant: View {
850:     @ObservedObject var editorCore: EditorCore
851:     let theme: Theme
852:     @State private var userInput = ""
853:     @State private var messages: [(id: UUID, role: String, content: String)] = [(UUID(), "assistant", "Hello! I'm your AI coding assistant. How can I help?")]
854:     
855:     var body: some View {
856:         VStack(spacing: 0) {
857:             HStack {
858:                 Image(systemName: "brain").foregroundColor(.blue)
859:                 Text("AI Assistant").font(.headline).foregroundColor(theme.editorForeground)
860:                 Spacer()
861:                 Button(action: { editorCore.showAIAssistant = false }) { Image(systemName: "xmark.circle.fill").foregroundColor(theme.editorForeground.opacity(0.5)) }
862:             }.padding().background(theme.sidebarBackground)
863:             
864:             ScrollView {
865:                 LazyVStack(alignment: .leading, spacing: 12) {
866:                     ForEach(messages, id: \.id) { msg in
867:                         HStack {
868:                             if msg.role == "user" { Spacer(minLength: 60) }
869:                             Text(msg.content).padding(12).background(RoundedRectangle(cornerRadius: 12).fill(msg.role == "user" ? Color.blue : theme.sidebarBackground)).foregroundColor(msg.role == "user" ? .white : theme.editorForeground)
870:                             if msg.role == "assistant" { Spacer(minLength: 60) }
871:                         }
872:                     }
873:                 }.padding()
874:             }.background(theme.editorBackground)
875:             
876:             HStack(spacing: 12) {
877:                 TextField("Ask about your code...", text: $userInput).textFieldStyle(.roundedBorder)
878:                 Button(action: { sendMessage() }) { Image(systemName: "paperplane.fill").foregroundColor(userInput.isEmpty ? .gray : .blue) }.disabled(userInput.isEmpty)
879:             }.padding().background(theme.sidebarBackground)
880:         }.background(theme.editorBackground).cornerRadius(12).shadow(radius: 20)
881:     }
882:     
883:     func sendMessage() {
884:         guard !userInput.trimmingCharacters(in: .whitespacesAndNewlines).isEmpty else { return }
885:         messages.append((UUID(), "user", userInput))
886:         let input = userInput
887:         userInput = ""
888:         DispatchQueue.main.asyncAfter(deadline: .now() + 0.8) {
889:             messages.append((UUID(), "assistant", "I can help with '\(input)'! What specifically would you like to know?"))
890:         }
891:     }
892: }
893: 
894: // MARK: - Status Bar
895: 
896: 
897: 
898: // MARK: - Folder Picker
899: 
900: struct IDEFolderPicker: UIViewControllerRepresentable {
901:     @ObservedObject var fileNavigator: FileSystemNavigator
902:     var onPick: ((URL) -> Void)?
903:     
904:     init(fileNavigator: FileSystemNavigator, onPick: ((URL) -> Void)? = nil) {
905:         self.fileNavigator = fileNavigator
906:         self.onPick = onPick
907:     }
908:     
909:     func makeUIViewController(context: Context) -> UIDocumentPickerViewController {
910:         let picker = UIDocumentPickerViewController(forOpeningContentTypes: [.folder])
911:         picker.delegate = context.coordinator
912:         return picker
913:     }
914:     
915:     func updateUIViewController(_ uiViewController: UIDocumentPickerViewController, context: Context) {}
916:     
917:     func makeCoordinator() -> Coordinator { Coordinator(self) }
918:     
919:     class Coordinator: NSObject, UIDocumentPickerDelegate {
920:         let parent: IDEFolderPicker
921:         init(_ parent: IDEFolderPicker) { self.parent = parent }
922:         
923:         func documentPicker(_ controller: UIDocumentPickerViewController, didPickDocumentsAt urls: [URL]) {
924:             if let url = urls.first {
925:                 _ = url.startAccessingSecurityScopedResource()
926:                 if let onPick = parent.onPick {
927:                     onPick(url)
928:                 } else {
929:                     // Default behavior if no custom handler
930:                     parent.fileNavigator.loadFileTree(at: url)
931:                     Task { @MainActor in
932:                         LaunchManager.shared.setWorkspaceRoot(url)
933:                         GitManager.shared.setWorkingDirectory(url)
934:                     }
935:                 }
936:             }
937:         }
938:     }
939: }
940: 
941: // MARK: - Document Picker
942: 
943: struct IDEDocumentPicker: UIViewControllerRepresentable {
944:     @ObservedObject var editorCore: EditorCore
945:     
946:     func makeUIViewController(context: Context) -> UIDocumentPickerViewController {
947:         let picker = UIDocumentPickerViewController(forOpeningContentTypes: [.text, .sourceCode, .json, .plainText, .data])
948:         picker.allowsMultipleSelection = true
949:         picker.delegate = context.coordinator
950:         return picker
951:     }
952:     
953:     func updateUIViewController(_ uiViewController: UIDocumentPickerViewController, context: Context) {}
954:     
955:     func makeCoordinator() -> Coordinator { Coordinator(editorCore: editorCore) }
956:     
957:     class Coordinator: NSObject, UIDocumentPickerDelegate {
958:         let editorCore: EditorCore
959:         init(editorCore: EditorCore) { self.editorCore = editorCore }
960:         
961:         func documentPicker(_ controller: UIDocumentPickerViewController, didPickDocumentsAt urls: [URL]) {
962:             for url in urls { editorCore.openFile(from: url) }
963:             editorCore.showFilePicker = false
964:         }
965:         
966:         func documentPickerWasCancelled(_ controller: UIDocumentPickerViewController) {
967:             editorCore.showFilePicker = false
968:         }
969:     }
970: }
971: 
972: // MARK: - Sidebar Search View
973: 
974: struct SidebarSearchView: View {
975:     let theme: Theme
976:     @State private var searchText = ""
977:     @State private var replaceText = ""
978:     @State private var showReplace = false
979:     @State private var searchResults: [(fileName: String, line: Int, preview: String)] = []
980:     
981:     var body: some View {
982:         VStack(alignment: .leading, spacing: 0) {
983:             HStack {
984:                 Text("SEARCH").font(.caption).fontWeight(.semibold).foregroundColor(theme.sidebarForeground.opacity(0.7))
985:                 Spacer()
986:             }.padding(.horizontal, 12).padding(.vertical, 8)
987:             
988:             HStack(spacing: 4) {
989:                 Image(systemName: "magnifyingglass").foregroundColor(theme.sidebarForeground.opacity(0.6)).font(.caption)
990:                 TextField("Search", text: $searchText).textFieldStyle(.plain).font(.system(size: 13))
991:                     .foregroundColor(theme.sidebarForeground)
992:                 if !searchText.isEmpty {
993:                     Button(action: { searchText = "" }) {
994:                         Image(systemName: "xmark.circle.fill").foregroundColor(theme.sidebarForeground.opacity(0.6)).font(.caption)
995:                     }
996:                 }
997:             }
998:             .padding(8)
999:             .background(theme.editorBackground)
1000:             .cornerRadius(6)
1001:             .padding(.horizontal, 12)
1002:             
1003:             HStack {
1004:                 Button(action: { showReplace.toggle() }) {
1005:                     Image(systemName: showReplace ? "chevron.down" : "chevron.right").font(.caption2)
1006:                     Text("Replace").font(.caption)
1007:                 }.foregroundColor(theme.sidebarForeground.opacity(0.7))
1008:                 Spacer()
1009:             }.padding(.horizontal, 12).padding(.vertical, 6)
1010:             
1011:             if showReplace {
1012:                 HStack(spacing: 4) {
1013:                     Image(systemName: "arrow.right").foregroundColor(theme.sidebarForeground.opacity(0.6)).font(.caption)
1014:                     TextField("Replace", text: $replaceText).textFieldStyle(.plain).font(.system(size: 13))
1015:                         .foregroundColor(theme.sidebarForeground)
1016:                 }
1017:                 .padding(8)
1018:                 .background(theme.editorBackground)
1019:                 .cornerRadius(6)
1020:                 .padding(.horizontal, 12)
1021:             }
1022:             
1023:             Divider().padding(.top, 8)
1024:             
1025:             if searchText.isEmpty {
1026:                 VStack(spacing: 8) {
1027:                     Spacer()
1028:                     Image(systemName: "magnifyingglass").font(.largeTitle).foregroundColor(theme.sidebarForeground.opacity(0.3))
1029:                     Text("Search in files").font(.caption).foregroundColor(theme.sidebarForeground.opacity(0.6))
1030:                     Spacer()
1031:                 }.frame(maxWidth: .infinity)
1032:             } else {
1033:                 ScrollView {
1034:                     LazyVStack(alignment: .leading, spacing: 0) {
1035:                         ForEach(0..<searchResults.count, id: \.self) { i in
1036:                             let result = searchResults[i]
1037:                             VStack(alignment: .leading, spacing: 2) {
1038:                                 HStack {
1039:                                     Image(systemName: "doc.text").font(.caption2).foregroundColor(theme.sidebarForeground.opacity(0.6))
1040:                                     Text(result.fileName).font(.system(size: 11, weight: .medium)).foregroundColor(theme.sidebarForeground)
1041:                                     Spacer()
1042:                                     Text(":\(result.line)").font(.system(size: 10, design: .monospaced)).foregroundColor(theme.sidebarForeground.opacity(0.6))
1043:                                 }
1044:                                 Text(result.preview).font(.system(size: 11, design: .monospaced)).foregroundColor(theme.sidebarForeground.opacity(0.7)).lineLimit(1)
1045:                             }.padding(.horizontal, 12).padding(.vertical, 6)
1046:                         }
1047:                     }
1048:                 }
1049:             }
1050:         }
1051:         .background(theme.sidebarBackground)
1052:         .onChange(of: searchText) { query in
1053:             if query.isEmpty { searchResults = [] }
1054:             else { searchResults = [("ContentView.swift", 15, "Text(\"\(query)\")"), ("main.swift", 8, "// \(query)")] }
1055:         }
1056:     }
1057: }
1058: 
1059: // MARK: - Preview
1060: 
1061: #Preview {
1062:     ContentView()
1063: }
1064: 


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/SidebarView.swift", "start_line": 130, "end_line": 160}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/SidebarView.swift (lines 131-160 of 288)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
131: }
132: 
133: // MARK: - Activity Bar Implementation
134: 
135: struct IDEActivityBar: View {
136:     @ObservedObject var editorCore: EditorCore
137:     @Binding var selectedTab: Int
138:     @Binding var showSettings: Bool
139:     @Binding var showTerminal: Bool
140:     
141:     var body: some View {
142:         VStack(spacing: 0) {
143:             // Top Group
144:             Group {
145:                 ActivityBarIcon(icon: "doc.on.doc", title: "Explorer", index: 0, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.explorer")
146:                 ActivityBarIcon(icon: "magnifyingglass", title: "Search", index: 1, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.search")
147:                 ActivityBarIcon(icon: "arrow.triangle.branch", title: "Source Control", index: 2, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.sourceControl")
148:                 ActivityBarIcon(icon: "play.fill", title: "Run and Debug", index: 3, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.runAndDebug")
149:                 ActivityBarIcon(icon: "square.grid.2x2", title: "Extensions", index: 4, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.extensions")
150:                 ActivityBarIcon(icon: "testtube.2", title: "Testing", index: 5, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.testing")
151:             }
152:             
153:             Spacer()
154:             
155:             // Bottom Group
156:             Group {
157:                 ActivityBarButton(icon: "person.circle", title: "Accounts") {}
158:                 ActivityBarButton(icon: "gear", title: "Manage") {
159:                     showSettings = true
160:                 }


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift", "start_line": 820, "end_line": 860}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift (lines 821-860 of 1995)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
821:         super.draw(rect)
822:         
823:         // 3. Draw Indent Guides (FEAT-039)
824:         // We iterate visible lines and draw vertical lines for indentation
825:         // Optimization: Only draw for visible range
826: 
827:         context.setLineWidth(1.0)
828: 
829:         // Respect editor tab size setting (default 4)
830:         let storedTabSize = UserDefaults.standard.integer(forKey: "tabSize")
831:         let tabSize = storedTabSize > 0 ? storedTabSize : 4
832: 
833:         let spaceWidth = " ".size(withAttributes: [.font: font]).width
834:         let indentWidth = spaceWidth * CGFloat(tabSize)
835: 
836:         // Determine active indent level for caret line (for indentGuideActive)
837:         var activeIndentLevel: Int = 0
838:         if let selected = selectedTextRange {
839:             let caretPos = offset(from: beginningOfDocument, to: selected.start)
840:             let nsText = (self.text ?? "") as NSString
841:             let safeLoc = min(max(0, caretPos), nsText.length)
842:             let caretLineRange = nsText.lineRange(for: NSRange(location: safeLoc, length: 0))
843:             let caretLineText = nsText.substring(with: caretLineRange)
844: 
845:             var spaces = 0
846:             for ch in caretLineText {
847:                 if ch == " " { spaces += 1 }
848:                 else if ch == "\t" { spaces += tabSize }
849:                 else { break }
850:             }
851:             activeIndentLevel = spaces / tabSize
852:         }
853: 
854:         // Iterate visible glyphs/lines
855:         let visibleRect = CGRect(origin: contentOffset, size: bounds.size)
856:         let glyphRange = layoutManager.glyphRange(forBoundingRect: visibleRect, in: textContainer)
857: 
858:         let caretY = selectedTextRange.map { caretRect(for: $0.start).minY }
859: 
860:         layoutManager.enumerateLineFragments(forGlyphRange: glyphRange) { (rect, usedRect, textContainer, glyphRange, stop) in


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Models/ThemeManager.swift"}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Models/ThemeManager.swift (lines 1-77 of 77)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1: import SwiftUI
2: import Combine
3: 
4: class ThemeManager: ObservableObject {
5:     @AppStorage("selectedThemeId") var selectedThemeId: String = "dark_plus"
6:     @Published var currentTheme: Theme
7:     
8:     static let shared = ThemeManager()
9:     
10:     // Quick access to current theme
11:     static var current: Theme { shared.currentTheme }
12:     
13:     init() {
14:         let themeId = UserDefaults.standard.string(forKey: "selectedThemeId") ?? "dark_plus"
15:         self.currentTheme = Theme.allThemes.first(where: { $0.id == themeId }) ?? .darkPlus
16:     }
17:     
18:     func switchTheme(to themeId: String) {
19:         if let theme = Theme.allThemes.first(where: { $0.id == themeId }) {
20:             withAnimation(.easeInOut(duration: 0.2)) {
21:                 self.currentTheme = theme
22:             }
23:             self.selectedThemeId = themeId
24:         }
25:     }
26:     
27:     func switchTheme(to theme: Theme) {
28:         switchTheme(to: theme.id)
29:     }
30:     
31:     // Cycle to next theme
32:     func nextTheme() {
33:         let themes = Theme.allThemes
34:         guard let currentIndex = themes.firstIndex(where: { $0.id == currentTheme.id }) else {
35:             switchTheme(to: themes.first!)
36:             return
37:         }
38:         let nextIndex = (currentIndex + 1) % themes.count
39:         switchTheme(to: themes[nextIndex])
40:     }
41:     
42:     // Cycle to previous theme
43:     func previousTheme() {
44:         let themes = Theme.allThemes
45:         guard let currentIndex = themes.firstIndex(where: { $0.id == currentTheme.id }) else {
46:             switchTheme(to: themes.first!)
47:             return
48:         }
49:         let prevIndex = currentIndex == 0 ? themes.count - 1 : currentIndex - 1
50:         switchTheme(to: themes[prevIndex])
51:     }
52:     
53:     // Get themes by category
54:     var darkThemes: [Theme] {
55:         Theme.allThemes.filter { $0.isDark }
56:     }
57:     
58:     var lightThemes: [Theme] {
59:         Theme.allThemes.filter { !$0.isDark }
60:     }
61:     
62:     // Helper for file colors that adapts to theme
63:     func color(for filename: String) -> Color {
64:         let ext = (filename as NSString).pathExtension.lowercased()
65:         switch ext {
66:         case "swift": return .orange
67:         case "js", "jsx": return .yellow
68:         case "ts", "tsx": return .blue
69:         case "py": return .green
70:         case "html", "htm": return .red
71:         case "css", "scss": return .purple
72:         case "json": return .green
73:         case "md": return .blue
74:         default: return currentTheme.isDark ? .white : .black
75:         }
76:     }
77: }


>>>TOOL search
{"query": "func fileColor", "glob": "**/*.swift"}
>>>END

---

## üîß TOOL RESULTS

[search]
No matches found for "func fileColor"


>>>TOOL search
{"query": "fileColor(for:", "glob": "**/*.swift"}
>>>END

---

## üîß TOOL RESULTS

[search]
Found 4 matches:
VSCodeiPadOS/VSCodeiPadOS/ContentView.swift:289: .foregroundColor(node.isDirectory ? .yellow : fileColor(for: node.name))
VSCodeiPadOS/VSCodeiPadOS/ContentView.swift:339: Image(systemName: fileIcon(for: name)).font(.caption).foregroundColor(fileColor(for: name))
VSCodeiPadOS/VSCodeiPadOS/ContentView.swift:379: Image(systemName: fileIcon(for: tab.fileName)).font(.caption).foregroundColor(fileColor(for: tab.fileName))
VSCodeiPadOS/VSCodeiPadOS/ContentView.swift:839: Image(systemName: fileIcon(for: name)).foregroundColor(fileColor(for: name)).frame(width: 20)


>>>TOOL list_dir
{"path": "VSCodeiPadOS/VSCodeiPadOS/Extensions"}
>>>END

---

## üîß TOOL RESULTS

[list_dir]
üìÅ VSCodeiPadOS/VSCodeiPadOS/Extensions/
   Array+Safe.swift
   Color+Hex.swift
   FileHelpers.swift
   FileIcons.swift
   FileManager+Extension.swift
   FileManager+Extensions.swift
   Notification+Search.swift
   NSAttributedStringSyntaxHighlighter.swift


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Extensions/FileIcons.swift"}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Extensions/FileIcons.swift (lines 1-116 of 116)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1: import SwiftUI
2: 
3: func fileIcon(for filename: String, isDirectory: Bool = false, isExpanded: Bool = false) -> String {
4:     if isDirectory {
5:         return isExpanded ? "folder.fill.badge.minus" : "folder.fill"
6:     }
7:     
8:     // Special files check (exact match)
9:     switch filename {
10:     case "package.json": return "shippingbox.fill"
11:     case "package-lock.json": return "lock.fill"
12:     case "tsconfig.json": return "gearshape.fill"
13:     case ".gitignore": return "eye.slash"
14:     case "README.md": return "book.fill"
15:     case "LICENSE": return "doc.badge.ellipsis"
16:     case "Dockerfile": return "shippingbox"
17:     case ".env": return "key.fill"
18:     case "Makefile": return "hammer.fill"
19:     case "Podfile": return "p.circle.fill"
20:     case "Gemfile": return "diamond.fill"
21:     case "Cargo.toml": return "gearshape.2.fill"
22:     default: break
23:     }
24:     
25:     let ext = (filename as NSString).pathExtension.lowercased()
26:     
27:     switch ext {
28:     case "swift": return "swift"
29:     case "js", "jsx": return "curlybraces"
30:     case "ts", "tsx": return "curlybraces"
31:     case "py": return "chevron.left.forwardslash.chevron.right"
32:     case "rb": return "diamond.fill"
33:     case "go": return "g.circle"
34:     case "rs": return "gearshape.2"
35:     case "java": return "cup.and.saucer.fill"
36:     case "c", "cpp", "h", "hpp", "cc": return "c.circle"
37:     case "cs": return "number"
38:     case "php": return "p.circle"
39:     case "html", "htm": return "globe"
40:     case "css", "scss", "sass": return "paintbrush.fill"
41:     case "json": return "curlybraces.square"
42:     case "yaml", "yml": return "doc.text"
43:     case "xml": return "chevron.left.forwardslash.chevron.right"
44:     case "md", "markdown": return "doc.richtext"
45:     case "sh", "bash", "zsh": return "terminal"
46:     case "sql": return "cylinder"
47:     case "graphql", "gql": return "circle.hexagongrid"
48:     case "dockerfile": return "shippingbox"
49:     case "png", "jpg", "jpeg", "gif", "svg", "bmp", "tiff", "ico": return "photo"
50:     case "mp4", "mov", "avi", "mkv", "webm": return "film"
51:     case "mp3", "wav", "aac", "flac", "m4a": return "speaker.wave.2"
52:     case "zip", "tar", "gz", "rar", "7z": return "archivebox"
53:     case "ttf", "otf", "woff", "woff2": return "textformat"
54:     case "pdf": return "doc.fill"
55:     case "conf", "config", "ini", "cfg": return "gearshape"
56:     default: return "doc.text"
57:     }
58: }
59: 
60: func fileColor(for filename: String, isDirectory: Bool = false) -> Color {
61:     if isDirectory {
62:         return .yellow
63:     }
64:     
65:     // Special files check
66:     switch filename {
67:     case "package.json": return .green
68:     case "package-lock.json": return .gray
69:     case "tsconfig.json": return .blue
70:     case ".gitignore": return .gray
71:     case "README.md": return .blue
72:     case "LICENSE": return .gray
73:     case "Dockerfile": return .blue
74:     case ".env": return .yellow
75:     case "Makefile": return .gray
76:     case "Podfile": return .orange
77:     case "Gemfile": return .red
78:     case "Cargo.toml": return .orange
79:     default: break
80:     }
81:     
82:     let ext = (filename as NSString).pathExtension.lowercased()
83:     
84:     switch ext {
85:     case "swift": return .orange
86:     case "js", "jsx": return .yellow
87:     case "ts", "tsx": return .blue
88:     case "py": return .blue
89:     case "rb": return .red
90:     case "go": return .cyan
91:     case "rs": return .orange
92:     case "java": return .red
93:     case "c", "cpp", "h", "hpp", "cc": return .blue
94:     case "cs": return .purple
95:     case "php": return .purple
96:     case "html", "htm": return .orange
97:     case "css", "scss", "sass": return .purple
98:     case "json": return .yellow
99:     case "yaml", "yml": return .red
100:     case "xml": return .orange
101:     case "md", "markdown": return .blue
102:     case "sh", "bash", "zsh": return .green
103:     case "sql": return .blue
104:     case "graphql", "gql": return .pink
105:     case "dockerfile": return .blue
106:     case "png", "jpg", "jpeg", "gif", "svg", "bmp", "tiff", "ico": return .purple
107:     case "mp4", "mov", "avi", "mkv", "webm": return .red
108:     case "mp3", "wav", "aac", "flac", "m4a": return .green
109:     case "zip", "tar", "gz", "rar", "7z": return .brown
110:     case "ttf", "otf", "woff", "woff2": return .gray
111:     case "pdf": return .red
112:     case "conf", "config", "ini", "cfg": return .gray
113:     default: return .gray
114:     }
115: }
116: 


>>>TOOL search
{"query": "struct Theme: Identifiable, Hashable", "glob": "**/*.swift"}
>>>END

---

## üîß TOOL RESULTS

[search]
No matches found for "struct Theme: Identifiable, Hashable"


>>>TOOL search
{"query": "struct Theme: Identifiable, Equatable, Hashable", "glob": "**/*.swift"}
>>>END

---

## üîß TOOL RESULTS

[search]
No matches found for "struct Theme: Identifiable, Equatable, Hashable"


>>>TOOL search
{"query": "struct Theme", "glob": "**/*.swift"}
>>>END

---

## üîß TOOL RESULTS

[search]
No matches found for "struct Theme"


>>>TOOL list_dir
{"path": "VSCodeiPadOS/VSCodeiPadOS/Models"}
>>>END

---

## üîß TOOL RESULTS

[list_dir]
üìÅ VSCodeiPadOS/VSCodeiPadOS/Models/
   EditorState.swift
   FileItem.swift
   FileItemUTType.swift
   FindViewModel.swift
   MultiCursor.swift
   Tab.swift
   Theme.swift
   ThemeManager.swift


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Models/Theme.swift"}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Models/Theme.swift (lines 1-887 of 887)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1: import SwiftUI
2: 
3: struct Theme: Identifiable, Equatable, Hashable {
4:     let id: String
5:     let name: String
6:     let isDark: Bool
7:     
8:     // Editor Colors
9:     let editorBackground: Color
10:     let editorForeground: Color
11:     let selection: Color
12:     let cursor: Color
13:     let lineNumber: Color
14:     let lineNumberActive: Color
15:     let currentLineHighlight: Color
16:     let bracketPair1: Color
17:     let bracketPair2: Color
18:     let bracketPair3: Color
19:     let bracketPair4: Color
20:     let bracketPair5: Color
21:     let bracketPair6: Color
22:     let indentGuide: Color
23:     let indentGuideActive: Color
24:     
25:     // UI Colors
26:     let sidebarBackground: Color
27:     let sidebarForeground: Color
28:     let sidebarSectionHeader: Color
29:     let sidebarSelection: Color
30:     let activityBarBackground: Color
31:     let activityBarForeground: Color
32:     let activityBarSelection: Color
33:     let tabBarBackground: Color
34:     let tabActiveBackground: Color
35:     let tabInactiveBackground: Color
36:     let tabActiveForeground: Color
37:     let tabInactiveForeground: Color
38:     let statusBarBackground: Color
39:     let statusBarForeground: Color
40:     
41:     // Syntax Colors
42:     let keyword: Color
43:     let string: Color
44:     let number: Color
45:     let comment: Color
46:     let function: Color
47:     let type: Color
48:     let variable: Color
49:     
50:     // Helper for Hex Colors
51:     static func hex(_ hex: String) -> Color {
52:         var hexSanitized = hex.trimmingCharacters(in: .whitespacesAndNewlines)
53:         hexSanitized = hexSanitized.replacingOccurrences(of: "#", with: "")
54:         
55:         var rgb: UInt64 = 0
56:         Scanner(string: hexSanitized).scanHexInt64(&rgb)
57:         
58:         let r = Double((rgb & 0xFF0000) >> 16) / 255.0
59:         let g = Double((rgb & 0x00FF00) >> 8) / 255.0
60:         let b = Double(rgb & 0x0000FF) / 255.0
61:         
62:         return Color(red: r, green: g, blue: b)
63:     }
64:     
65:     // MARK: - VS Code Default Themes
66:     
67:     static let darkPlus = Theme(
68:         id: "dark_plus",
69:         name: "Dark+ (Default Dark)",
70:         isDark: true,
71:         editorBackground: hex("#1E1E1E"),
72:         editorForeground: hex("#D4D4D4"),
73:         selection: hex("#264F78"),
74:         cursor: hex("#AEAFAD"),
75:         lineNumber: hex("#858585"),
76:         lineNumberActive: hex("#C6C6C6"),
77:         currentLineHighlight: hex("#FFFFFF").opacity(0.1),
78:         bracketPair1: hex("#FFD700"),
79:         bracketPair2: hex("#DA70D6"),
80:         bracketPair3: hex("#179FFF"),
81:         bracketPair4: hex("#FFD700"),
82:         bracketPair5: hex("#DA70D6"),
83:         bracketPair6: hex("#179FFF"),
84:         indentGuide: hex("#404040"),
85:         indentGuideActive: hex("#707070"),
86:         sidebarBackground: hex("#252526"),
87:         sidebarForeground: hex("#CCCCCC"),
88:         sidebarSectionHeader: hex("#383838"),
89:         sidebarSelection: hex("#37373D"),
90:         activityBarBackground: hex("#333333"),
91:         activityBarForeground: hex("#FFFFFF"),
92:         activityBarSelection: hex("#FFFFFF"),
93:         tabBarBackground: hex("#252526"),
94:         tabActiveBackground: hex("#1E1E1E"),
95:         tabInactiveBackground: hex("#2D2D2D"),
96:         tabActiveForeground: hex("#FFFFFF"),
97:         tabInactiveForeground: hex("#969696"),
98:         statusBarBackground: hex("#007ACC"),
99:         statusBarForeground: hex("#FFFFFF"),
100:         keyword: hex("#569CD6"),
101:         string: hex("#CE9178"),
102:         number: hex("#B5CEA8"),
103:         comment: hex("#6A9955"),
104:         function: hex("#DCDCAA"),
105:         type: hex("#4EC9B0"),
106:         variable: hex("#9CDCFE")
107:     )
108:     
109:     static let lightPlus = Theme(
110:         id: "light_plus",
111:         name: "Light+ (Default Light)",
112:         isDark: false,
113:         editorBackground: hex("#FFFFFF"),
114:         editorForeground: hex("#000000"),
115:         selection: hex("#ADD6FF"),
116:         cursor: hex("#000000"),
117:         lineNumber: hex("#237893"),
118:         lineNumberActive: hex("#0B216F"),
119:         currentLineHighlight: hex("#000000").opacity(0.07),
120:         bracketPair1: hex("#0431FA"),
121:         bracketPair2: hex("#319331"),
122:         bracketPair3: hex("#7B3814"),
123:         bracketPair4: hex("#0431FA"),
124:         bracketPair5: hex("#319331"),
125:         bracketPair6: hex("#7B3814"),
126:         indentGuide: hex("#D3D3D3"),
127:         indentGuideActive: hex("#939393"),
128:         sidebarBackground: hex("#F3F3F3"),
129:         sidebarForeground: hex("#616161"),
130:         sidebarSectionHeader: hex("#E7E7E7"),
131:         sidebarSelection: hex("#E4E6F1"),
132:         activityBarBackground: hex("#2C2C2C"),
133:         activityBarForeground: hex("#FFFFFF"),
134:         activityBarSelection: hex("#FFFFFF"),
135:         tabBarBackground: hex("#F3F3F3"),
136:         tabActiveBackground: hex("#FFFFFF"),
137:         tabInactiveBackground: hex("#ECECEC"),
138:         tabActiveForeground: hex("#333333"),
139:         tabInactiveForeground: hex("#8E8E8E"),
140:         statusBarBackground: hex("#007ACC"),
141:         statusBarForeground: hex("#FFFFFF"),
142:         keyword: hex("#AF00DB"),
143:         string: hex("#A31515"),
144:         number: hex("#098658"),
145:         comment: hex("#008000"),
146:         function: hex("#795E26"),
147:         type: hex("#267F99"),
148:         variable: hex("#001080")
149:     )
150:     
151:     static let monokai = Theme(
152:         id: "monokai",
153:         name: "Monokai",
154:         isDark: true,
155:         editorBackground: hex("#272822"),
156:         editorForeground: hex("#F8F8F2"),
157:         selection: hex("#49483E"),
158:         cursor: hex("#F8F8F0"),
159:         lineNumber: hex("#90908A"),
160:         lineNumberActive: hex("#F8F8F2"),
161:         currentLineHighlight: hex("#3E3D32"),
162:         bracketPair1: hex("#F8F8F2"),
163:         bracketPair2: hex("#F92672"),
164:         bracketPair3: hex("#A6E22E"),
165:         bracketPair4: hex("#F8F8F2"),
166:         bracketPair5: hex("#F92672"),
167:         bracketPair6: hex("#A6E22E"),
168:         indentGuide: hex("#464741"),
169:         indentGuideActive: hex("#75715E"),
170:         sidebarBackground: hex("#272822"),
171:         sidebarForeground: hex("#F8F8F2"),
172:         sidebarSectionHeader: hex("#1E1F1C"),
173:         sidebarSelection: hex("#49483E"),
174:         activityBarBackground: hex("#1E1F1C"),
175:         activityBarForeground: hex("#F8F8F2"),
176:         activityBarSelection: hex("#F8F8F2"),
177:         tabBarBackground: hex("#1E1F1C"),
178:         tabActiveBackground: hex("#272822"),
179:         tabInactiveBackground: hex("#34352F"),
180:         tabActiveForeground: hex("#F8F8F2"),
181:         tabInactiveForeground: hex("#88846F"),
182:         statusBarBackground: hex("#75715E"),
183:         statusBarForeground: hex("#F8F8F2"),
184:         keyword: hex("#F92672"),
185:         string: hex("#E6DB74"),
186:         number: hex("#AE81FF"),
187:         comment: hex("#75715E"),
188:         function: hex("#A6E22E"),
189:         type: hex("#66D9EF"),
190:         variable: hex("#FD971F")
191:     )
192:     
193:     static let solarizedDark = Theme(
194:         id: "solarized_dark",
195:         name: "Solarized Dark",
196:         isDark: true,
197:         editorBackground: hex("#002B36"),
198:         editorForeground: hex("#839496"),
199:         selection: hex("#274642"),
200:         cursor: hex("#D30102"),
201:         lineNumber: hex("#586E75"),
202:         lineNumberActive: hex("#93A1A1"),
203:         currentLineHighlight: hex("#0A2933"),
204:         bracketPair1: hex("#859900"),
205:         bracketPair2: hex("#2AA198"),
206:         bracketPair3: hex("#268BD2"),
207:         bracketPair4: hex("#859900"),
208:         bracketPair5: hex("#2AA198"),
209:         bracketPair6: hex("#268BD2"),
210:         indentGuide: hex("#073642"),
211:         indentGuideActive: hex("#586E75"),
212:         sidebarBackground: hex("#00252E"),
213:         sidebarForeground: hex("#93A1A1"),
214:         sidebarSectionHeader: hex("#001F27"),
215:         sidebarSelection: hex("#073642"),
216:         activityBarBackground: hex("#002B36"),
217:         activityBarForeground: hex("#93A1A1"),
218:         activityBarSelection: hex("#FDF6E3"),
219:         tabBarBackground: hex("#002B36"),
220:         tabActiveBackground: hex("#002B36"),
221:         tabInactiveBackground: hex("#00212B"),
222:         tabActiveForeground: hex("#93A1A1"),
223:         tabInactiveForeground: hex("#586E75"),
224:         statusBarBackground: hex("#00212B"),
225:         statusBarForeground: hex("#93A1A1"),
226:         keyword: hex("#859900"),
227:         string: hex("#2AA198"),
228:         number: hex("#D33682"),
229:         comment: hex("#586E75"),
230:         function: hex("#268BD2"),
231:         type: hex("#CB4B16"),
232:         variable: hex("#B58900")
233:     )
234:     
235:     static let solarizedLight = Theme(
236:         id: "solarized_light",
237:         name: "Solarized Light",
238:         isDark: false,
239:         editorBackground: hex("#FDF6E3"),
240:         editorForeground: hex("#657B83"),
241:         selection: hex("#EEE8D5"),
242:         cursor: hex("#D30102"),
243:         lineNumber: hex("#93A1A1"),
244:         lineNumberActive: hex("#586E75"),
245:         currentLineHighlight: hex("#EEE8D5"),
246:         bracketPair1: hex("#859900"),
247:         bracketPair2: hex("#2AA198"),
248:         bracketPair3: hex("#268BD2"),
249:         bracketPair4: hex("#859900"),
250:         bracketPair5: hex("#2AA198"),
251:         bracketPair6: hex("#268BD2"),
252:         indentGuide: hex("#EEE8D5"),
253:         indentGuideActive: hex("#93A1A1"),
254:         sidebarBackground: hex("#EEE8D5"),
255:         sidebarForeground: hex("#586E75"),
256:         sidebarSectionHeader: hex("#DDD6C1"),
257:         sidebarSelection: hex("#D3CBB8"),
258:         activityBarBackground: hex("#DDD6C1"),
259:         activityBarForeground: hex("#586E75"),
260:         activityBarSelection: hex("#073642"),
261:         tabBarBackground: hex("#EEE8D5"),
262:         tabActiveBackground: hex("#FDF6E3"),
263:         tabInactiveBackground: hex("#EEE8D5"),
264:         tabActiveForeground: hex("#073642"),
265:         tabInactiveForeground: hex("#93A1A1"),
266:         statusBarBackground: hex("#EEE8D5"),
267:         statusBarForeground: hex("#586E75"),
268:         keyword: hex("#859900"),
269:         string: hex("#2AA198"),
270:         number: hex("#D33682"),
271:         comment: hex("#93A1A1"),
272:         function: hex("#268BD2"),
273:         type: hex("#CB4B16"),
274:         variable: hex("#B58900")
275:     )
276:     
277:     static let dracula = Theme(
278:         id: "dracula",
279:         name: "Dracula",
280:         isDark: true,
281:         editorBackground: hex("#282A36"),
282:         editorForeground: hex("#F8F8F2"),
283:         selection: hex("#44475A"),
284:         cursor: hex("#F8F8F2"),
285:         lineNumber: hex("#6272A4"),
286:         lineNumberActive: hex("#F8F8F2"),
287:         currentLineHighlight: hex("#44475A"),
288:         bracketPair1: hex("#F8F8F2"),
289:         bracketPair2: hex("#FF79C6"),
290:         bracketPair3: hex("#8BE9FD"),
291:         bracketPair4: hex("#F8F8F2"),
292:         bracketPair5: hex("#FF79C6"),
293:         bracketPair6: hex("#8BE9FD"),
294:         indentGuide: hex("#424450"),
295:         indentGuideActive: hex("#6272A4"),
296:         sidebarBackground: hex("#21222C"),
297:         sidebarForeground: hex("#F8F8F2"),
298:         sidebarSectionHeader: hex("#191A21"),
299:         sidebarSelection: hex("#44475A"),
300:         activityBarBackground: hex("#343746"),
301:         activityBarForeground: hex("#F8F8F2"),
302:         activityBarSelection: hex("#F8F8F2"),
303:         tabBarBackground: hex("#191A21"),
304:         tabActiveBackground: hex("#282A36"),
305:         tabInactiveBackground: hex("#21222C"),
306:         tabActiveForeground: hex("#F8F8F2"),
307:         tabInactiveForeground: hex("#6272A4"),
308:         statusBarBackground: hex("#BD93F9"),
309:         statusBarForeground: hex("#282A36"),
310:         keyword: hex("#FF79C6"),
311:         string: hex("#F1FA8C"),
312:         number: hex("#BD93F9"),
313:         comment: hex("#6272A4"),
314:         function: hex("#50FA7B"),
315:         type: hex("#8BE9FD"),
316:         variable: hex("#FFB86C")
317:     )
318:     
319:     static let oneDarkPro = Theme(
320:         id: "one_dark_pro",
321:         name: "One Dark Pro",
322:         isDark: true,
323:         editorBackground: hex("#282C34"),
324:         editorForeground: hex("#ABB2BF"),
325:         selection: hex("#3E4451"),
326:         cursor: hex("#528BFF"),
327:         lineNumber: hex("#4B5263"),
328:         lineNumberActive: hex("#ABB2BF"),
329:         currentLineHighlight: hex("#2C313C"),
330:         bracketPair1: hex("#C678DD"),
331:         bracketPair2: hex("#61AFEF"),
332:         bracketPair3: hex("#E5C07B"),
333:         bracketPair4: hex("#C678DD"),
334:         bracketPair5: hex("#61AFEF"),
335:         bracketPair6: hex("#E5C07B"),
336:         indentGuide: hex("#3B4048"),
337:         indentGuideActive: hex("#5C6370"),
338:         sidebarBackground: hex("#21252B"),
339:         sidebarForeground: hex("#ABB2BF"),
340:         sidebarSectionHeader: hex("#282C34"),
341:         sidebarSelection: hex("#2C313A"),
342:         activityBarBackground: hex("#282C34"),
343:         activityBarForeground: hex("#ABB2BF"),
344:         activityBarSelection: hex("#D7DAE0"),
345:         tabBarBackground: hex("#21252B"),
346:         tabActiveBackground: hex("#282C34"),
347:         tabInactiveBackground: hex("#21252B"),
348:         tabActiveForeground: hex("#D7DAE0"),
349:         tabInactiveForeground: hex("#5C6370"),
350:         statusBarBackground: hex("#21252B"),
351:         statusBarForeground: hex("#9DA5B4"),
352:         keyword: hex("#C678DD"),
353:         string: hex("#98C379"),
354:         number: hex("#D19A66"),
355:         comment: hex("#5C6370"),
356:         function: hex("#61AFEF"),
357:         type: hex("#E5C07B"),
358:         variable: hex("#E06C75")
359:     )
360:     
361:     static let nord = Theme(
362:         id: "nord",
363:         name: "Nord",
364:         isDark: true,
365:         editorBackground: hex("#2E3440"),
366:         editorForeground: hex("#D8DEE9"),
367:         selection: hex("#434C5E"),
368:         cursor: hex("#D8DEE9"),
369:         lineNumber: hex("#4C566A"),
370:         lineNumberActive: hex("#D8DEE9"),
371:         currentLineHighlight: hex("#3B4252"),
372:         bracketPair1: hex("#EBCB8B"),
373:         bracketPair2: hex("#A3BE8C"),
374:         bracketPair3: hex("#81A1C1"),
375:         bracketPair4: hex("#EBCB8B"),
376:         bracketPair5: hex("#A3BE8C"),
377:         bracketPair6: hex("#81A1C1"),
378:         indentGuide: hex("#434C5E"),
379:         indentGuideActive: hex("#4C566A"),
380:         sidebarBackground: hex("#2E3440"),
381:         sidebarForeground: hex("#D8DEE9"),
382:         sidebarSectionHeader: hex("#3B4252"),
383:         sidebarSelection: hex("#3B4252"),
384:         activityBarBackground: hex("#2E3440"),
385:         activityBarForeground: hex("#D8DEE9"),
386:         activityBarSelection: hex("#88C0D0"),
387:         tabBarBackground: hex("#2E3440"),
388:         tabActiveBackground: hex("#3B4252"),
389:         tabInactiveBackground: hex("#2E3440"),
390:         tabActiveForeground: hex("#D8DEE9"),
391:         tabInactiveForeground: hex("#4C566A"),
392:         statusBarBackground: hex("#3B4252"),
393:         statusBarForeground: hex("#D8DEE9"),
394:         keyword: hex("#81A1C1"),
395:         string: hex("#A3BE8C"),
396:         number: hex("#B48EAD"),
397:         comment: hex("#616E88"),
398:         function: hex("#88C0D0"),
399:         type: hex("#8FBCBB"),
400:         variable: hex("#D8DEE9")
401:     )
402:     
403:     static let githubDark = Theme(
404:         id: "github_dark",
405:         name: "GitHub Dark",
406:         isDark: true,
407:         editorBackground: hex("#0D1117"),
408:         editorForeground: hex("#C9D1D9"),
409:         selection: hex("#163356"),
410:         cursor: hex("#58A6FF"),
411:         lineNumber: hex("#484F58"),
412:         lineNumberActive: hex("#C9D1D9"),
413:         currentLineHighlight: hex("#161B22"),
414:         bracketPair1: hex("#79C0FF"),
415:         bracketPair2: hex("#D2A8FF"),
416:         bracketPair3: hex("#FFA657"),
417:         bracketPair4: hex("#79C0FF"),
418:         bracketPair5: hex("#D2A8FF"),
419:         bracketPair6: hex("#FFA657"),
420:         indentGuide: hex("#21262D"),
421:         indentGuideActive: hex("#30363D"),
422:         sidebarBackground: hex("#010409"),
423:         sidebarForeground: hex("#C9D1D9"),
424:         sidebarSectionHeader: hex("#161B22"),
425:         sidebarSelection: hex("#1F2428"),
426:         activityBarBackground: hex("#0D1117"),
427:         activityBarForeground: hex("#C9D1D9"),
428:         activityBarSelection: hex("#C9D1D9"),
429:         tabBarBackground: hex("#010409"),
430:         tabActiveBackground: hex("#0D1117"),
431:         tabInactiveBackground: hex("#010409"),
432:         tabActiveForeground: hex("#C9D1D9"),
433:         tabInactiveForeground: hex("#8B949E"),
434:         statusBarBackground: hex("#0D1117"),
435:         statusBarForeground: hex("#58A6FF"),
436:         keyword: hex("#FF7B72"),
437:         string: hex("#A5D6FF"),
438:         number: hex("#79C0FF"),
439:         comment: hex("#8B949E"),
440:         function: hex("#D2A8FF"),
441:         type: hex("#79C0FF"),
442:         variable: hex("#FFA657")
443:     )
444:     
445:     static let githubLight = Theme(
446:         id: "github_light",
447:         name: "GitHub Light",
448:         isDark: false,
449:         editorBackground: hex("#FFFFFF"),
450:         editorForeground: hex("#24292F"),
451:         selection: hex("#B6E3FF"),
452:         cursor: hex("#0969DA"),
453:         lineNumber: hex("#8C959F"),
454:         lineNumberActive: hex("#24292F"),
455:         currentLineHighlight: hex("#F6F8FA"),
456:         bracketPair1: hex("#0550AE"),
457:         bracketPair2: hex("#8250DF"),
458:         bracketPair3: hex("#953800"),
459:         bracketPair4: hex("#0550AE"),
460:         bracketPair5: hex("#8250DF"),
461:         bracketPair6: hex("#953800"),
462:         indentGuide: hex("#D0D7DE"),
463:         indentGuideActive: hex("#8C959F"),
464:         sidebarBackground: hex("#F6F8FA"),
465:         sidebarForeground: hex("#24292F"),
466:         sidebarSectionHeader: hex("#EAEEF2"),
467:         sidebarSelection: hex("#DDFBE6"),
468:         activityBarBackground: hex("#F6F8FA"),
469:         activityBarForeground: hex("#24292F"),
470:         activityBarSelection: hex("#24292F"),
471:         tabBarBackground: hex("#F6F8FA"),
472:         tabActiveBackground: hex("#FFFFFF"),
473:         tabInactiveBackground: hex("#F6F8FA"),
474:         tabActiveForeground: hex("#24292F"),
475:         tabInactiveForeground: hex("#57606A"),
476:         statusBarBackground: hex("#F6F8FA"),
477:         statusBarForeground: hex("#0969DA"),
478:         keyword: hex("#CF222E"),
479:         string: hex("#0A3069"),
480:         number: hex("#0550AE"),
481:         comment: hex("#6E7781"),
482:         function: hex("#8250DF"),
483:         type: hex("#0550AE"),
484:         variable: hex("#953800")
485:     )
486:     
487:     static let cobalt2 = Theme(
488:         id: "cobalt2",
489:         name: "Cobalt2",
490:         isDark: true,
491:         editorBackground: hex("#193549"),
492:         editorForeground: hex("#FFFFFF"),
493:         selection: hex("#0D3A58"),
494:         cursor: hex("#FEFB00"),
495:         lineNumber: hex("#3D5F7D"),
496:         lineNumberActive: hex("#FFFFFF"),
497:         currentLineHighlight: hex("#1F4662"),
498:         bracketPair1: hex("#FFC600"),
499:         bracketPair2: hex("#FF628C"),
500:         bracketPair3: hex("#80FFBB"),
501:         bracketPair4: hex("#FFC600"),
502:         bracketPair5: hex("#FF628C"),
503:         bracketPair6: hex("#80FFBB"),
504:         indentGuide: hex("#294B5C"),
505:         indentGuideActive: hex("#3D5F7D"),
506:         sidebarBackground: hex("#15232D"),
507:         sidebarForeground: hex("#FFFFFF"),
508:         sidebarSectionHeader: hex("#0D1A23"),
509:         sidebarSelection: hex("#0D3A58"),
510:         activityBarBackground: hex("#193549"),
511:         activityBarForeground: hex("#FFFFFF"),
512:         activityBarSelection: hex("#FFC600"),
513:         tabBarBackground: hex("#15232D"),
514:         tabActiveBackground: hex("#193549"),
515:         tabInactiveBackground: hex("#15232D"),
516:         tabActiveForeground: hex("#FFFFFF"),
517:         tabInactiveForeground: hex("#3D5F7D"),
518:         statusBarBackground: hex("#15232D"),
519:         statusBarForeground: hex("#FFFFFF"),
520:         keyword: hex("#FF9D00"),
521:         string: hex("#A5FF90"),
522:         number: hex("#FF628C"),
523:         comment: hex("#0088FF"),
524:         function: hex("#FFC600"),
525:         type: hex("#80FFBB"),
526:         variable: hex("#9EFFFF")
527:     )
528:     
529:     static let ayuDark = Theme(
530:         id: "ayu_dark",
531:         name: "Ayu Dark",
532:         isDark: true,
533:         editorBackground: hex("#0A0E14"),
534:         editorForeground: hex("#B3B1AD"),
535:         selection: hex("#273747"),
536:         cursor: hex("#E6B450"),
537:         lineNumber: hex("#3D424D"),
538:         lineNumberActive: hex("#E6B450"),
539:         currentLineHighlight: hex("#0D1016"),
540:         bracketPair1: hex("#FFB454"),
541:         bracketPair2: hex("#59C2FF"),
542:         bracketPair3: hex("#AAD94C"),
543:         bracketPair4: hex("#FFB454"),
544:         bracketPair5: hex("#59C2FF"),
545:         bracketPair6: hex("#AAD94C"),
546:         indentGuide: hex("#1C212B"),
547:         indentGuideActive: hex("#3D424D"),
548:         sidebarBackground: hex("#0D1016"),
549:         sidebarForeground: hex("#B3B1AD"),
550:         sidebarSectionHeader: hex("#0A0E14"),
551:         sidebarSelection: hex("#273747"),
552:         activityBarBackground: hex("#0A0E14"),
553:         activityBarForeground: hex("#B3B1AD"),
554:         activityBarSelection: hex("#E6B450"),
555:         tabBarBackground: hex("#0D1016"),
556:         tabActiveBackground: hex("#0A0E14"),
557:         tabInactiveBackground: hex("#0D1016"),
558:         tabActiveForeground: hex("#B3B1AD"),
559:         tabInactiveForeground: hex("#3D424D"),
560:         statusBarBackground: hex("#0D1016"),
561:         statusBarForeground: hex("#B3B1AD"),
562:         keyword: hex("#FF8F40"),
563:         string: hex("#AAD94C"),
564:         number: hex("#DFBFFF"),
565:         comment: hex("#626A73"),
566:         function: hex("#FFB454"),
567:         type: hex("#59C2FF"),
568:         variable: hex("#B3B1AD")
569:     )
570:     
571:     static let ayuLight = Theme(
572:         id: "ayu_light",
573:         name: "Ayu Light",
574:         isDark: false,
575:         editorBackground: hex("#FAFAFA"),
576:         editorForeground: hex("#5C6166"),
577:         selection: hex("#D1E4F4"),
578:         cursor: hex("#FF9940"),
579:         lineNumber: hex("#9DA2A6"),
580:         lineNumberActive: hex("#FF9940"),
581:         currentLineHighlight: hex("#EFF0F1"),
582:         bracketPair1: hex("#F2AE49"),
583:         bracketPair2: hex("#399EE6"),
584:         bracketPair3: hex("#86B300"),
585:         bracketPair4: hex("#F2AE49"),
586:         bracketPair5: hex("#399EE6"),
587:         bracketPair6: hex("#86B300"),
588:         indentGuide: hex("#E7E8E9"),
589:         indentGuideActive: hex("#9DA2A6"),
590:         sidebarBackground: hex("#F0F0F0"),
591:         sidebarForeground: hex("#5C6166"),
592:         sidebarSectionHeader: hex("#E7E7E7"),
593:         sidebarSelection: hex("#D1E4F4"),
594:         activityBarBackground: hex("#F0F0F0"),
595:         activityBarForeground: hex("#5C6166"),
596:         activityBarSelection: hex("#FF9940"),
597:         tabBarBackground: hex("#F0F0F0"),
598:         tabActiveBackground: hex("#FAFAFA"),
599:         tabInactiveBackground: hex("#F0F0F0"),
600:         tabActiveForeground: hex("#5C6166"),
601:         tabInactiveForeground: hex("#9DA2A6"),
602:         statusBarBackground: hex("#F0F0F0"),
603:         statusBarForeground: hex("#5C6166"),
604:         keyword: hex("#FA8D3E"),
605:         string: hex("#86B300"),
606:         number: hex("#A37ACC"),
607:         comment: hex("#ABB0B6"),
608:         function: hex("#F2AE49"),
609:         type: hex("#399EE6"),
610:         variable: hex("#5C6166")
611:     )
612:     
613:     static let ayuMirage = Theme(
614:         id: "ayu_mirage",
615:         name: "Ayu Mirage",
616:         isDark: true,
617:         editorBackground: hex("#1F2430"),
618:         editorForeground: hex("#CBCCC6"),
619:         selection: hex("#33415E"),
620:         cursor: hex("#FFCC66"),
621:         lineNumber: hex("#707A8C"),
622:         lineNumberActive: hex("#FFCC66"),
623:         currentLineHighlight: hex("#232834"),
624:         bracketPair1: hex("#FFD580"),
625:         bracketPair2: hex("#73D0FF"),
626:         bracketPair3: hex("#BAE67E"),
627:         bracketPair4: hex("#FFD580"),
628:         bracketPair5: hex("#73D0FF"),
629:         bracketPair6: hex("#BAE67E"),
630:         indentGuide: hex("#2D3640"),
631:         indentGuideActive: hex("#707A8C"),
632:         sidebarBackground: hex("#232834"),
633:         sidebarForeground: hex("#CBCCC6"),
634:         sidebarSectionHeader: hex("#1F2430"),
635:         sidebarSelection: hex("#33415E"),
636:         activityBarBackground: hex("#1F2430"),
637:         activityBarForeground: hex("#CBCCC6"),
638:         activityBarSelection: hex("#FFCC66"),
639:         tabBarBackground: hex("#232834"),
640:         tabActiveBackground: hex("#1F2430"),
641:         tabInactiveBackground: hex("#232834"),
642:         tabActiveForeground: hex("#CBCCC6"),
643:         tabInactiveForeground: hex("#707A8C"),
644:         statusBarBackground: hex("#232834"),
645:         statusBarForeground: hex("#CBCCC6"),
646:         keyword: hex("#FFA759"),
647:         string: hex("#BAE67E"),
648:         number: hex("#D4BFFF"),
649:         comment: hex("#5C6773"),
650:         function: hex("#FFD580"),
651:         type: hex("#73D0FF"),
652:         variable: hex("#CBCCC6")
653:     )
654:     
655:     static let quietLight = Theme(
656:         id: "quiet_light",
657:         name: "Quiet Light",
658:         isDark: false,
659:         editorBackground: hex("#F5F5F5"),
660:         editorForeground: hex("#333333"),
661:         selection: hex("#C9D0D9"),
662:         cursor: hex("#54494B"),
663:         lineNumber: hex("#AAAAAA"),
664:         lineNumberActive: hex("#333333"),
665:         currentLineHighlight: hex("#E4F6D4"),
666:         bracketPair1: hex("#7A3E9D"),
667:         bracketPair2: hex("#448C27"),
668:         bracketPair3: hex("#4B83CD"),
669:         bracketPair4: hex("#7A3E9D"),
670:         bracketPair5: hex("#448C27"),
671:         bracketPair6: hex("#4B83CD"),
672:         indentGuide: hex("#E0E0E0"),
673:         indentGuideActive: hex("#AAAAAA"),
674:         sidebarBackground: hex("#E7E7E7"),
675:         sidebarForeground: hex("#333333"),
676:         sidebarSectionHeader: hex("#DDDDDD"),
677:         sidebarSelection: hex("#C9D0D9"),
678:         activityBarBackground: hex("#E7E7E7"),
679:         activityBarForeground: hex("#333333"),
680:         activityBarSelection: hex("#333333"),
681:         tabBarBackground: hex("#E7E7E7"),
682:         tabActiveBackground: hex("#F5F5F5"),
683:         tabInactiveBackground: hex("#E7E7E7"),
684:         tabActiveForeground: hex("#333333"),
685:         tabInactiveForeground: hex("#AAAAAA"),
686:         statusBarBackground: hex("#E7E7E7"),
687:         statusBarForeground: hex("#333333"),
688:         keyword: hex("#4B83CD"),
689:         string: hex("#448C27"),
690:         number: hex("#AB6526"),
691:         comment: hex("#AAAAAA"),
692:         function: hex("#7A3E9D"),
693:         type: hex("#7A3E9D"),
694:         variable: hex("#333333")
695:     )
696:     
697:     static let red = Theme(
698:         id: "red",
699:         name: "Red",
700:         isDark: true,
701:         editorBackground: hex("#390000"),
702:         editorForeground: hex("#F8F8F8"),
703:         selection: hex("#750000"),
704:         cursor: hex("#FF0000"),
705:         lineNumber: hex("#FF6666"),
706:         lineNumberActive: hex("#FFFFFF"),
707:         currentLineHighlight: hex("#500000"),
708:         bracketPair1: hex("#FFFF66"),
709:         bracketPair2: hex("#AAFFAA"),
710:         bracketPair3: hex("#AADDFF"),
711:         bracketPair4: hex("#FFFF66"),
712:         bracketPair5: hex("#AAFFAA"),
713:         bracketPair6: hex("#AADDFF"),
714:         indentGuide: hex("#550000"),
715:         indentGuideActive: hex("#CC6666"),
716:         sidebarBackground: hex("#300000"),
717:         sidebarForeground: hex("#F8F8F8"),
718:         sidebarSectionHeader: hex("#500000"),
719:         sidebarSelection: hex("#750000"),
720:         activityBarBackground: hex("#390000"),
721:         activityBarForeground: hex("#F8F8F8"),
722:         activityBarSelection: hex("#FF0000"),
723:         tabBarBackground: hex("#300000"),
724:         tabActiveBackground: hex("#390000"),
725:         tabInactiveBackground: hex("#300000"),
726:         tabActiveForeground: hex("#FFFFFF"),
727:         tabInactiveForeground: hex("#CC6666"),
728:         statusBarBackground: hex("#FF0000"),
729:         statusBarForeground: hex("#FFFFFF"),
730:         keyword: hex("#FF6666"),
731:         string: hex("#FFA0A0"),
732:         number: hex("#FFD0D0"),
733:         comment: hex("#CC6666"),
734:         function: hex("#FFFF66"),
735:         type: hex("#AAFFAA"),
736:         variable: hex("#AADDFF")
737:     )
738:     
739:     static let tomorrowNight = Theme(
740:         id: "tomorrow_night",
741:         name: "Tomorrow Night",
742:         isDark: true,
743:         editorBackground: hex("#1D1F21"),
744:         editorForeground: hex("#C5C8C6"),
745:         selection: hex("#373B41"),
746:         cursor: hex("#AEAFAD"),
747:         lineNumber: hex("#969896"),
748:         lineNumberActive: hex("#C5C8C6"),
749:         currentLineHighlight: hex("#282A2E"),
750:         bracketPair1: hex("#F0C674"),
751:         bracketPair2: hex("#B5BD68"),
752:         bracketPair3: hex("#81A2BE"),
753:         bracketPair4: hex("#F0C674"),
754:         bracketPair5: hex("#B5BD68"),
755:         bracketPair6: hex("#81A2BE"),
756:         indentGuide: hex("#373B41"),
757:         indentGuideActive: hex("#969896"),
758:         sidebarBackground: hex("#1D1F21"),
759:         sidebarForeground: hex("#C5C8C6"),
760:         sidebarSectionHeader: hex("#282A2E"),
761:         sidebarSelection: hex("#373B41"),
762:         activityBarBackground: hex("#1D1F21"),
763:         activityBarForeground: hex("#C5C8C6"),
764:         activityBarSelection: hex("#81A2BE"),
765:         tabBarBackground: hex("#1D1F21"),
766:         tabActiveBackground: hex("#282A2E"),
767:         tabInactiveBackground: hex("#1D1F21"),
768:         tabActiveForeground: hex("#C5C8C6"),
769:         tabInactiveForeground: hex("#969896"),
770:         statusBarBackground: hex("#282A2E"),
771:         statusBarForeground: hex("#C5C8C6"),
772:         keyword: hex("#B294BB"),
773:         string: hex("#B5BD68"),
774:         number: hex("#DE935F"),
775:         comment: hex("#969896"),
776:         function: hex("#81A2BE"),
777:         type: hex("#F0C674"),
778:         variable: hex("#CC6666")
779:     )
780:     
781:     static let tomorrowNightBlue = Theme(
782:         id: "tomorrow_night_blue",
783:         name: "Tomorrow Night Blue",
784:         isDark: true,
785:         editorBackground: hex("#002451"),
786:         editorForeground: hex("#FFFFFF"),
787:         selection: hex("#003F8E"),
788:         cursor: hex("#FFFFFF"),
789:         lineNumber: hex("#7285B7"),
790:         lineNumberActive: hex("#FFFFFF"),
791:         currentLineHighlight: hex("#00346E"),
792:         bracketPair1: hex("#FFEEAD"),
793:         bracketPair2: hex("#D1F1A9"),
794:         bracketPair3: hex("#BBDAFF"),
795:         bracketPair4: hex("#FFEEAD"),
796:         bracketPair5: hex("#D1F1A9"),
797:         bracketPair6: hex("#BBDAFF"),
798:         indentGuide: hex("#003875"),
799:         indentGuideActive: hex("#7285B7"),
800:         sidebarBackground: hex("#001E40"),
801:         sidebarForeground: hex("#FFFFFF"),
802:         sidebarSectionHeader: hex("#003875"),
803:         sidebarSelection: hex("#003F8E"),
804:         activityBarBackground: hex("#002451"),
805:         activityBarForeground: hex("#FFFFFF"),
806:         activityBarSelection: hex("#BBDAFF"),
807:         tabBarBackground: hex("#001E40"),
808:         tabActiveBackground: hex("#002451"),
809:         tabInactiveBackground: hex("#001E40"),
810:         tabActiveForeground: hex("#FFFFFF"),
811:         tabInactiveForeground: hex("#7285B7"),
812:         statusBarBackground: hex("#003875"),
813:         statusBarForeground: hex("#FFFFFF"),
814:         keyword: hex("#EBBBFF"),
815:         string: hex("#D1F1A9"),
816:         number: hex("#FFC58F"),
817:         comment: hex("#7285B7"),
818:         function: hex("#BBDAFF"),
819:         type: hex("#FFEEAD"),
820:         variable: hex("#FF9DA4")
821:     )
822:     
823:     static let highContrast = Theme(
824:         id: "high_contrast",
825:         name: "High Contrast",
826:         isDark: true,
827:         editorBackground: hex("#000000"),
828:         editorForeground: hex("#FFFFFF"),
829:         selection: hex("#FFFFFF").opacity(0.3),
830:         cursor: hex("#FFFFFF"),
831:         lineNumber: hex("#FFFFFF"),
832:         lineNumberActive: hex("#FFFFFF"),
833:         currentLineHighlight: hex("#FFFFFF").opacity(0.1),
834:         bracketPair1: hex("#FFD700"),
835:         bracketPair2: hex("#00FF00"),
836:         bracketPair3: hex("#00BFFF"),
837:         bracketPair4: hex("#FFD700"),
838:         bracketPair5: hex("#00FF00"),
839:         bracketPair6: hex("#00BFFF"),
840:         indentGuide: hex("#FFFFFF").opacity(0.2),
841:         indentGuideActive: hex("#FFFFFF").opacity(0.5),
842:         sidebarBackground: hex("#000000"),
843:         sidebarForeground: hex("#FFFFFF"),
844:         sidebarSectionHeader: hex("#000000"),
845:         sidebarSelection: hex("#FFFFFF").opacity(0.15),
846:         activityBarBackground: hex("#000000"),
847:         activityBarForeground: hex("#FFFFFF"),
848:         activityBarSelection: hex("#FFFFFF"),
849:         tabBarBackground: hex("#000000"),
850:         tabActiveBackground: hex("#000000"),
851:         tabInactiveBackground: hex("#000000"),
852:         tabActiveForeground: hex("#FFFFFF"),
853:         tabInactiveForeground: hex("#FFFFFF").opacity(0.6),
854:         statusBarBackground: hex("#0000AA"),
855:         statusBarForeground: hex("#FFFFFF"),
856:         keyword: hex("#569CD6"),
857:         string: hex("#CE9178"),
858:         number: hex("#B5CEA8"),
859:         comment: hex("#7CA668"),
860:         function: hex("#DCDCAA"),
861:         type: hex("#4EC9B0"),
862:         variable: hex("#9CDCFE")
863:     )
864:     
865:     // MARK: - All Themes
866:     static let allThemes: [Theme] = [
867:         .darkPlus,
868:         .lightPlus,
869:         .monokai,
870:         .solarizedDark,
871:         .solarizedLight,
872:         .dracula,
873:         .oneDarkPro,
874:         .nord,
875:         .githubDark,
876:         .githubLight,
877:         .cobalt2,
878:         .ayuDark,
879:         .ayuLight,
880:         .ayuMirage,
881:         .quietLight,
882:         .red,
883:         .tomorrowNight,
884:         .tomorrowNightBlue,
885:         .highContrast
886:     ]
887: }


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift", "start_line": 778, "end_line": 780}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift (lines 779-780 of 2011)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
779:     var onGoToLine: (() -> Void)?
780:     


>>>TOOL search
{"query": "private var indentGuideColor: UIColor = .separator", "glob": "VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift"}
>>>END

---

## üîß TOOL RESULTS

[search]
Found 1 matches:
VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift:794: private var indentGuideColor: UIColor = .separator


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift", "start_line": 790, "end_line": 810}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift (lines 791-810 of 2011)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
791:     var onDismissAutocomplete: (() -> Bool)?
792:     
793:     // FEAT-039 & FEAT-043
794:     private var indentGuideColor: UIColor = .separator
795:     private var activeIndentGuideColor: UIColor = .label
796:     private var currentLineHighlightColor: UIColor = .clear
797:     
798:     override init(frame: CGRect, textContainer: NSTextContainer?) {
799:         super.init(frame: frame, textContainer: textContainer)
800:         setup()
801:     }
802:     
803:     required init?(coder: NSCoder) {
804:         super.init(coder: coder)
805:         setup()
806:     }
807:     
808:     private func setup() {
809:         // Ensure we redraw when bounds/selection change
810:         contentMode = .redraw


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift", "start_line": 1339, "end_line": 1349}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift (lines 1340-1349 of 2011)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1340:         case "sql": return .sql
1341: 
1342:         case "sh", "bash", "zsh", "fish": return .shell
1343:         case "dockerfile": return .dockerfile
1344: 
1345:         case "graphql", "gql": return .graphql
1346: 
1347:         case "md", "markdown": return .markdown
1348:         case "php": return .php
1349:         case "env": return .env


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/SidebarView.swift"}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/SidebarView.swift (lines 1-288 of 288)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1: import SwiftUI
2: 
3: // MARK: - Sidebar View Structure
4: 
5: struct SidebarView: View {
6:     @ObservedObject var editorCore: EditorCore
7:     @ObservedObject var fileNavigator: FileSystemNavigator
8:     @Binding var selectedTab: Int
9:     @Binding var showSettings: Bool
10:     @Binding var showTerminal: Bool
11:     @Binding var showFolderPicker: Bool
12:     var theme: Theme = ThemeManager.shared.currentTheme
13:     
14:     var body: some View {
15:         HStack(spacing: 0) {
16:             // 1. Activity Bar (Far Left)
17:             IDEActivityBar(
18:                 editorCore: editorCore,
19:                 selectedTab: $selectedTab,
20:                 showSettings: $showSettings,
21:                 showTerminal: $showTerminal
22:             )
23:             
24:             // 2. Sidebar Panel (Resizable)
25:             if editorCore.showSidebar {
26:                 ZStack(alignment: .trailing) {
27:                     VStack(spacing: 0) {
28:                         // Header Area
29:                         HStack {
30:                             Text(sidebarTitle)
31:                                 .font(.system(size: 11, weight: .medium))
32:                                 .foregroundColor(.secondary)
33:                                 .textCase(.uppercase)
34:                                 .accessibilityIdentifier("sidebar.header.title")
35:                             Spacer()
36:                             sidebarHeaderActions
37:                         }
38:                         .padding(.horizontal, 20)
39:                         .padding(.vertical, 10)
40:                         
41:                         Divider()
42:                             .background(Color(UIColor.separator))
43:                         
44:                         // Content Area
45:                         sidebarContent
46:                             .frame(maxWidth: .infinity, maxHeight: .infinity)
47:                     }
48:                     .frame(width: editorCore.sidebarWidth)
49:                     .background(Color(UIColor.secondarySystemBackground)) // Theme aware
50:                     .accessibilityIdentifier("sidebar.panel")
51:                     
52:                     // 5. Resize Handle
53:                     ResizeHandle(width: $editorCore.sidebarWidth)
54:                 }
55:             }
56:         }
57:     }
58:     
59:     // Dynamic Title based on selection
60:     private var sidebarTitle: String {
61:         switch selectedTab {
62:         case 0: return "EXPLORER"
63:         case 1: return "SEARCH"
64:         case 2: return "SOURCE CONTROL"
65:         case 3: return "RUN AND DEBUG"
66:         case 4: return "EXTENSIONS"
67:         case 5: return "TESTING"
68:         default: return "EXPLORER"
69:         }
70:     }
71:     
72:     // Header Actions
73:     @ViewBuilder
74:     private var sidebarHeaderActions: some View {
75:         if selectedTab == 0 {
76:             HStack(spacing: 12) {
77:                 Button(action: { showFolderPicker = true }) {
78:                     Image(systemName: "folder.badge.plus")
79:                         .font(.system(size: 14))
80:                         .foregroundColor(.secondary)
81:                 }
82:                 .help("Open Folder")
83:                 
84:                 Button(action: { editorCore.addTab() }) {
85:                     Image(systemName: "doc.badge.plus")
86:                         .font(.system(size: 14))
87:                         .foregroundColor(.secondary)
88:                 }
89:                 .help("New File")
90:                 
91:                 Button(action: { fileNavigator.refreshFileTree() }) {
92:                     Image(systemName: "arrow.clockwise")
93:                         .font(.system(size: 14))
94:                         .foregroundColor(.secondary)
95:                 }
96:                 .help("Refresh")
97:                 
98:                 Button(action: { 
99:                      // Collapse All Action 
100:                      fileNavigator.expandedPaths.removeAll()
101:                 }) {
102:                     Image(systemName: "arrow.up.left.and.arrow.down.right") // Collapse icon
103:                         .font(.system(size: 14))
104:                         .foregroundColor(.secondary)
105:                 }
106:                 .help("Collapse All Folders")
107:             }
108:         }
109:     }
110:     
111:     // Content Switching
112:     @ViewBuilder
113:     private var sidebarContent: some View {
114:         switch selectedTab {
115:         case 0:
116:             IDESidebarFiles(editorCore: editorCore, fileNavigator: fileNavigator, showFolderPicker: $showFolderPicker, theme: theme)
117:         case 1:
118:             SidebarSearchView(theme: theme)
119:         case 2:
120:             GitView()
121:         case 3:
122:             DebugView()
123:         case 4:
124:             ExtensionsView()
125:         case 5:
126:             TestView()
127:         default:
128:             IDESidebarFiles(editorCore: editorCore, fileNavigator: fileNavigator, showFolderPicker: $showFolderPicker, theme: theme)
129:         }
130:     }
131: }
132: 
133: // MARK: - Activity Bar Implementation
134: 
135: struct IDEActivityBar: View {
136:     @ObservedObject var editorCore: EditorCore
137:     @Binding var selectedTab: Int
138:     @Binding var showSettings: Bool
139:     @Binding var showTerminal: Bool
140:     
141:     var body: some View {
142:         VStack(spacing: 0) {
143:             // Top Group
144:             Group {
145:                 ActivityBarIcon(icon: "doc.on.doc", title: "Explorer", index: 0, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.explorer")
146:                 ActivityBarIcon(icon: "magnifyingglass", title: "Search", index: 1, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.search")
147:                 ActivityBarIcon(icon: "arrow.triangle.branch", title: "Source Control", index: 2, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.sourceControl")
148:                 ActivityBarIcon(icon: "play.fill", title: "Run and Debug", index: 3, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.runAndDebug")
149:                 ActivityBarIcon(icon: "square.grid.2x2", title: "Extensions", index: 4, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.extensions")
150:                 ActivityBarIcon(icon: "testtube.2", title: "Testing", index: 5, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.testing")
151:             }
152:             
153:             Spacer()
154:             
155:             // Bottom Group
156:             Group {
157:                 ActivityBarButton(icon: "person.circle", title: "Accounts") {}
158:                 ActivityBarButton(icon: "gear", title: "Manage") {
159:                     showSettings = true
160:                 }
161:             }
162:             .padding(.bottom, 10)
163:         }
164:         .frame(width: 50)
165:         .background(Color(UIColor.secondarySystemBackground).opacity(0.8)) // Darker shade for activity bar
166:         .border(width: 1, edges: [.trailing], color: Color(UIColor.separator))
167:     }
168: }
169: 
170: struct ActivityBarIcon: View {
171:     let icon: String
172:     let title: String
173:     let index: Int
174:     @Binding var selectedTab: Int
175:     @ObservedObject var editorCore: EditorCore
176:     let accessibilityID: String
177:     
178:     var isSelected: Bool { selectedTab == index }
179:     
180:     var body: some View {
181:         Button(action: {
182:             if isSelected {
183:                 // Toggle sidebar visibility if clicking already selected tab
184:                 editorCore.toggleSidebar()
185:             } else {
186:                 selectedTab = index
187:                 if !editorCore.showSidebar { editorCore.toggleSidebar() }
188:             }
189:         }) {
190:             ZStack {
191:                 // Active indicator line on left
192:                 if isSelected && editorCore.showSidebar {
193:                     HStack {
194:                         Rectangle()
195:                             .fill(Color.accentColor)
196:                             .frame(width: 2)
197:                         Spacer()
198:                     }
199:                 }
200:                 
201:                 Image(systemName: icon)
202:                     .font(.system(size: 20, weight: .light))
203:                     .foregroundColor(isSelected && editorCore.showSidebar ? .primary : .secondary)
204:                     .frame(width: 50, height: 50)
205:                     .contentShape(Rectangle())
206:             }
207:         }
208:         .buttonStyle(PlainButtonStyle())
209:         .help(title)
210:         .accessibilityIdentifier(accessibilityID)
211:     }
212: }
213: 
214: struct ActivityBarButton: View {
215:     let icon: String
216:     let title: String
217:     let action: () -> Void
218:     
219:     var body: some View {
220:         Button(action: action) {
221:             Image(systemName: icon)
222:                 .font(.system(size: 20, weight: .light))
223:                 .foregroundColor(.secondary)
224:                 .frame(width: 50, height: 50)
225:                 .contentShape(Rectangle())
226:         }
227:         .buttonStyle(PlainButtonStyle())
228:         .help(title)
229:     }
230: }
231: 
232: // MARK: - Resize Handle (iPad Compatible)
233: 
234: struct ResizeHandle: View {
235:     @Binding var width: CGFloat
236:     @State private var isDragging = false
237:     
238:     var body: some View {
239:         HStack(spacing: 0) {
240:             Spacer()
241:             ZStack {
242:                 // Invisible larger hit area
243:                 Rectangle()
244:                     .fill(Color.clear)
245:                     .frame(width: 10)
246:                 
247:                 // Visible separator line
248:                 Rectangle()
249:                     .fill(isDragging ? Color.accentColor : Color(UIColor.separator))
250:                     .frame(width: 1)
251:             }
252:             .contentShape(Rectangle())
253:             .gesture(
254:                 DragGesture()
255:                     .onChanged { value in
256:                         isDragging = true
257:                         let newWidth = width + value.translation.width
258:                         // Clamp width (Min 170, Max 600)
259:                         if newWidth >= 170 && newWidth <= 600 {
260:                             width = newWidth
261:                         }
262:                     }
263:                     .onEnded { _ in
264:                         isDragging = false
265:                     }
266:             )
267:         }
268:     }
269: }
270: 
271: // MARK: - Placeholders for Missing Views
272: 
273: 
274: 
275: struct ExtensionsView: View {
276:     var body: some View {
277:         VStack {
278:             Text("Extensions")
279:                 .font(.caption)
280:                 .foregroundColor(.secondary)
281:                 .padding()
282:             Spacer()
283:         }
284:     }
285: }
286: 
287: 
288: 


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift", "start_line": 770, "end_line": 800}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift (lines 771-800 of 2011)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
771:         }
772:     }
773: }
774: 
775: // Custom text view to handle key commands, indent guides, and line highlighting
776: class EditorTextView: UITextView {
777:     var onPeekDefinition: (() -> Void)?
778:     var onEscape: (() -> Void)?
779:     var onGoToLine: (() -> Void)?
780:     
781:     // Custom action closures for context menu
782:     var onGoToDefinition: (() -> Void)?
783:     var onFindReferences: (() -> Void)?
784:     var onFormatDocument: (() -> Void)?
785:     var onToggleComment: (() -> Void)?
786:     var onFold: (() -> Void)?
787:     var onUnfold: (() -> Void)?
788: 
789:     // Autocomplete key handling hooks (return true if handled)
790:     var onAcceptAutocomplete: (() -> Bool)?
791:     var onDismissAutocomplete: (() -> Bool)?
792:     
793:     // FEAT-039 & FEAT-043
794:     private var indentGuideColor: UIColor = .separator
795:     private var activeIndentGuideColor: UIColor = .label
796:     private var currentLineHighlightColor: UIColor = .clear
797:     
798:     override init(frame: CGRect, textContainer: NSTextContainer?) {
799:         super.init(frame: frame, textContainer: textContainer)
800:         setup()


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/SidebarView.swift", "start_line": 1}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/SidebarView.swift (lines 2-288 of 288)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
2: 
3: // MARK: - Sidebar View Structure
4: 
5: struct SidebarView: View {
6:     @ObservedObject var editorCore: EditorCore
7:     @ObservedObject var fileNavigator: FileSystemNavigator
8:     @Binding var selectedTab: Int
9:     @Binding var showSettings: Bool
10:     @Binding var showTerminal: Bool
11:     @Binding var showFolderPicker: Bool
12:     var theme: Theme = ThemeManager.shared.currentTheme
13:     
14:     var body: some View {
15:         HStack(spacing: 0) {
16:             // 1. Activity Bar (Far Left)
17:             IDEActivityBar(
18:                 editorCore: editorCore,
19:                 selectedTab: $selectedTab,
20:                 showSettings: $showSettings,
21:                 showTerminal: $showTerminal
22:             )
23:             
24:             // 2. Sidebar Panel (Resizable)
25:             if editorCore.showSidebar {
26:                 ZStack(alignment: .trailing) {
27:                     VStack(spacing: 0) {
28:                         // Header Area
29:                         HStack {
30:                             Text(sidebarTitle)
31:                                 .font(.system(size: 11, weight: .medium))
32:                                 .foregroundColor(.secondary)
33:                                 .textCase(.uppercase)
34:                                 .accessibilityIdentifier("sidebar.header.title")
35:                             Spacer()
36:                             sidebarHeaderActions
37:                         }
38:                         .padding(.horizontal, 20)
39:                         .padding(.vertical, 10)
40:                         
41:                         Divider()
42:                             .background(Color(UIColor.separator))
43:                         
44:                         // Content Area
45:                         sidebarContent
46:                             .frame(maxWidth: .infinity, maxHeight: .infinity)
47:                     }
48:                     .frame(width: editorCore.sidebarWidth)
49:                     .background(Color(UIColor.secondarySystemBackground)) // Theme aware
50:                     .accessibilityIdentifier("sidebar.panel")
51:                     
52:                     // 5. Resize Handle
53:                     ResizeHandle(width: $editorCore.sidebarWidth)
54:                 }
55:             }
56:         }
57:     }
58:     
59:     // Dynamic Title based on selection
60:     private var sidebarTitle: String {
61:         switch selectedTab {
62:         case 0: return "EXPLORER"
63:         case 1: return "SEARCH"
64:         case 2: return "SOURCE CONTROL"
65:         case 3: return "RUN AND DEBUG"
66:         case 4: return "EXTENSIONS"
67:         case 5: return "TESTING"
68:         default: return "EXPLORER"
69:         }
70:     }
71:     
72:     // Header Actions
73:     @ViewBuilder
74:     private var sidebarHeaderActions: some View {
75:         if selectedTab == 0 {
76:             HStack(spacing: 12) {
77:                 Button(action: { showFolderPicker = true }) {
78:                     Image(systemName: "folder.badge.plus")
79:                         .font(.system(size: 14))
80:                         .foregroundColor(.secondary)
81:                 }
82:                 .help("Open Folder")
83:                 
84:                 Button(action: { editorCore.addTab() }) {
85:                     Image(systemName: "doc.badge.plus")
86:                         .font(.system(size: 14))
87:                         .foregroundColor(.secondary)
88:                 }
89:                 .help("New File")
90:                 
91:                 Button(action: { fileNavigator.refreshFileTree() }) {
92:                     Image(systemName: "arrow.clockwise")
93:                         .font(.system(size: 14))
94:                         .foregroundColor(.secondary)
95:                 }
96:                 .help("Refresh")
97:                 
98:                 Button(action: { 
99:                      // Collapse All Action 
100:                      fileNavigator.expandedPaths.removeAll()
101:                 }) {
102:                     Image(systemName: "arrow.up.left.and.arrow.down.right") // Collapse icon
103:                         .font(.system(size: 14))
104:                         .foregroundColor(.secondary)
105:                 }
106:                 .help("Collapse All Folders")
107:             }
108:         }
109:     }
110:     
111:     // Content Switching
112:     @ViewBuilder
113:     private var sidebarContent: some View {
114:         switch selectedTab {
115:         case 0:
116:             IDESidebarFiles(editorCore: editorCore, fileNavigator: fileNavigator, showFolderPicker: $showFolderPicker, theme: theme)
117:         case 1:
118:             SidebarSearchView(theme: theme)
119:         case 2:
120:             GitView()
121:         case 3:
122:             DebugView()
123:         case 4:
124:             ExtensionsView()
125:         case 5:
126:             TestView()
127:         default:
128:             IDESidebarFiles(editorCore: editorCore, fileNavigator: fileNavigator, showFolderPicker: $showFolderPicker, theme: theme)
129:         }
130:     }
131: }
132: 
133: // MARK: - Activity Bar Implementation
134: 
135: struct IDEActivityBar: View {
136:     @ObservedObject var editorCore: EditorCore
137:     @Binding var selectedTab: Int
138:     @Binding var showSettings: Bool
139:     @Binding var showTerminal: Bool
140:     
141:     var body: some View {
142:         VStack(spacing: 0) {
143:             // Top Group
144:             Group {
145:                 ActivityBarIcon(icon: "doc.on.doc", title: "Explorer", index: 0, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.explorer")
146:                 ActivityBarIcon(icon: "magnifyingglass", title: "Search", index: 1, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.search")
147:                 ActivityBarIcon(icon: "arrow.triangle.branch", title: "Source Control", index: 2, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.sourceControl")
148:                 ActivityBarIcon(icon: "play.fill", title: "Run and Debug", index: 3, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.runAndDebug")
149:                 ActivityBarIcon(icon: "square.grid.2x2", title: "Extensions", index: 4, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.extensions")
150:                 ActivityBarIcon(icon: "testtube.2", title: "Testing", index: 5, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.testing")
151:             }
152:             
153:             Spacer()
154:             
155:             // Bottom Group
156:             Group {
157:                 ActivityBarButton(icon: "person.circle", title: "Accounts") {}
158:                 ActivityBarButton(icon: "gear", title: "Manage") {
159:                     showSettings = true
160:                 }
161:             }
162:             .padding(.bottom, 10)
163:         }
164:         .frame(width: 50)
165:         .background(Color(UIColor.secondarySystemBackground).opacity(0.8)) // Darker shade for activity bar
166:         .border(width: 1, edges: [.trailing], color: Color(UIColor.separator))
167:     }
168: }
169: 
170: struct ActivityBarIcon: View {
171:     let icon: String
172:     let title: String
173:     let index: Int
174:     @Binding var selectedTab: Int
175:     @ObservedObject var editorCore: EditorCore
176:     let accessibilityID: String
177:     
178:     var isSelected: Bool { selectedTab == index }
179:     
180:     var body: some View {
181:         Button(action: {
182:             if isSelected {
183:                 // Toggle sidebar visibility if clicking already selected tab
184:                 editorCore.toggleSidebar()
185:             } else {
186:                 selectedTab = index
187:                 if !editorCore.showSidebar { editorCore.toggleSidebar() }
188:             }
189:         }) {
190:             ZStack {
191:                 // Active indicator line on left
192:                 if isSelected && editorCore.showSidebar {
193:                     HStack {
194:                         Rectangle()
195:                             .fill(Color.accentColor)
196:                             .frame(width: 2)
197:                         Spacer()
198:                     }
199:                 }
200:                 
201:                 Image(systemName: icon)
202:                     .font(.system(size: 20, weight: .light))
203:                     .foregroundColor(isSelected && editorCore.showSidebar ? .primary : .secondary)
204:                     .frame(width: 50, height: 50)
205:                     .contentShape(Rectangle())
206:             }
207:         }
208:         .buttonStyle(PlainButtonStyle())
209:         .help(title)
210:         .accessibilityIdentifier(accessibilityID)
211:     }
212: }
213: 
214: struct ActivityBarButton: View {
215:     let icon: String
216:     let title: String
217:     let action: () -> Void
218:     
219:     var body: some View {
220:         Button(action: action) {
221:             Image(systemName: icon)
222:                 .font(.system(size: 20, weight: .light))
223:                 .foregroundColor(.secondary)
224:                 .frame(width: 50, height: 50)
225:                 .contentShape(Rectangle())
226:         }
227:         .buttonStyle(PlainButtonStyle())
228:         .help(title)
229:     }
230: }
231: 
232: // MARK: - Resize Handle (iPad Compatible)
233: 
234: struct ResizeHandle: View {
235:     @Binding var width: CGFloat
236:     @State private var isDragging = false
237:     
238:     var body: some View {
239:         HStack(spacing: 0) {
240:             Spacer()
241:             ZStack {
242:                 // Invisible larger hit area
243:                 Rectangle()
244:                     .fill(Color.clear)
245:                     .frame(width: 10)
246:                 
247:                 // Visible separator line
248:                 Rectangle()
249:                     .fill(isDragging ? Color.accentColor : Color(UIColor.separator))
250:                     .frame(width: 1)
251:             }
252:             .contentShape(Rectangle())
253:             .gesture(
254:                 DragGesture()
255:                     .onChanged { value in
256:                         isDragging = true
257:                         let newWidth = width + value.translation.width
258:                         // Clamp width (Min 170, Max 600)
259:                         if newWidth >= 170 && newWidth <= 600 {
260:                             width = newWidth
261:                         }
262:                     }
263:                     .onEnded { _ in
264:                         isDragging = false
265:                     }
266:             )
267:         }
268:     }
269: }
270: 
271: // MARK: - Placeholders for Missing Views
272: 
273: 
274: 
275: struct ExtensionsView: View {
276:     var body: some View {
277:         VStack {
278:             Text("Extensions")
279:                 .font(.caption)
280:                 .foregroundColor(.secondary)
281:                 .padding()
282:             Spacer()
283:         }
284:     }
285: }
286: 
287: 
288: 


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift", "start_line": 200, "end_line": 230}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift (lines 201-230 of 2011)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
201:         // CRITICAL FIX: Apply initial highlighting FIRST on the very first updateUIView call
202:         // This fixes the bug where syntax highlighting only appears after typing.
203:         // makeUIView applies it, but the view may not be fully in hierarchy yet,
204:         // causing the attributed text to be lost. This ensures it's applied reliably.
205:         if !context.coordinator.hasAppliedInitialHighlighting && !textView.text.isEmpty {
206:             context.coordinator.applySyntaxHighlighting(to: textView)
207:             context.coordinator.hasAppliedInitialHighlighting = true
208:         }
209:         
210:         // Update colors when theme changes
211:         // NOTE: Only set backgroundColor and tintColor here. Do NOT set textColor
212:         // as it interferes with attributedText syntax highlighting colors.
213:         // The foreground color is handled entirely by the attributedText.
214:         textView.backgroundColor = UIColor(ThemeManager.shared.currentTheme.editorBackground)
215:         textView.tintColor = UIColor(ThemeManager.shared.currentTheme.cursor)
216:         
217:         if let editorView = textView as? EditorTextView {
218:             editorView.updateThemeColors(theme: ThemeManager.shared.currentTheme)
219:         }
220:         
221:         // Update font size if changed (using explicit fontSize parameter for proper SwiftUI updates)
222:         if let currentFont = textView.font, currentFont.pointSize != fontSize {
223:             let selectedRange = textView.selectedRange
224:             textView.font = UIFont.monospacedSystemFont(ofSize: fontSize, weight: .regular)
225:             context.coordinator.applySyntaxHighlighting(to: textView)
226:             textView.selectedRange = selectedRange
227:             
228:             // Update line height
229:             if let font = textView.font {
230:                 DispatchQueue.main.async {


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/SidebarView.swift"}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/SidebarView.swift (lines 1-288 of 288)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1: import SwiftUI
2: 
3: // MARK: - Sidebar View Structure
4: 
5: struct SidebarView: View {
6:     @ObservedObject var editorCore: EditorCore
7:     @ObservedObject var fileNavigator: FileSystemNavigator
8:     @Binding var selectedTab: Int
9:     @Binding var showSettings: Bool
10:     @Binding var showTerminal: Bool
11:     @Binding var showFolderPicker: Bool
12:     var theme: Theme = ThemeManager.shared.currentTheme
13:     
14:     var body: some View {
15:         HStack(spacing: 0) {
16:             // 1. Activity Bar (Far Left)
17:             IDEActivityBar(
18:                 editorCore: editorCore,
19:                 selectedTab: $selectedTab,
20:                 showSettings: $showSettings,
21:                 showTerminal: $showTerminal
22:             )
23:             
24:             // 2. Sidebar Panel (Resizable)
25:             if editorCore.showSidebar {
26:                 ZStack(alignment: .trailing) {
27:                     VStack(spacing: 0) {
28:                         // Header Area
29:                         HStack {
30:                             Text(sidebarTitle)
31:                                 .font(.system(size: 11, weight: .medium))
32:                                 .foregroundColor(.secondary)
33:                                 .textCase(.uppercase)
34:                                 .accessibilityIdentifier("sidebar.header.title")
35:                             Spacer()
36:                             sidebarHeaderActions
37:                         }
38:                         .padding(.horizontal, 20)
39:                         .padding(.vertical, 10)
40:                         
41:                         Divider()
42:                             .background(Color(UIColor.separator))
43:                         
44:                         // Content Area
45:                         sidebarContent
46:                             .frame(maxWidth: .infinity, maxHeight: .infinity)
47:                     }
48:                     .frame(width: editorCore.sidebarWidth)
49:                     .background(Color(UIColor.secondarySystemBackground)) // Theme aware
50:                     .accessibilityIdentifier("sidebar.panel")
51:                     
52:                     // 5. Resize Handle
53:                     ResizeHandle(width: $editorCore.sidebarWidth)
54:                 }
55:             }
56:         }
57:     }
58:     
59:     // Dynamic Title based on selection
60:     private var sidebarTitle: String {
61:         switch selectedTab {
62:         case 0: return "EXPLORER"
63:         case 1: return "SEARCH"
64:         case 2: return "SOURCE CONTROL"
65:         case 3: return "RUN AND DEBUG"
66:         case 4: return "EXTENSIONS"
67:         case 5: return "TESTING"
68:         default: return "EXPLORER"
69:         }
70:     }
71:     
72:     // Header Actions
73:     @ViewBuilder
74:     private var sidebarHeaderActions: some View {
75:         if selectedTab == 0 {
76:             HStack(spacing: 12) {
77:                 Button(action: { showFolderPicker = true }) {
78:                     Image(systemName: "folder.badge.plus")
79:                         .font(.system(size: 14))
80:                         .foregroundColor(.secondary)
81:                 }
82:                 .help("Open Folder")
83:                 
84:                 Button(action: { editorCore.addTab() }) {
85:                     Image(systemName: "doc.badge.plus")
86:                         .font(.system(size: 14))
87:                         .foregroundColor(.secondary)
88:                 }
89:                 .help("New File")
90:                 
91:                 Button(action: { fileNavigator.refreshFileTree() }) {
92:                     Image(systemName: "arrow.clockwise")
93:                         .font(.system(size: 14))
94:                         .foregroundColor(.secondary)
95:                 }
96:                 .help("Refresh")
97:                 
98:                 Button(action: { 
99:                      // Collapse All Action 
100:                      fileNavigator.expandedPaths.removeAll()
101:                 }) {
102:                     Image(systemName: "arrow.up.left.and.arrow.down.right") // Collapse icon
103:                         .font(.system(size: 14))
104:                         .foregroundColor(.secondary)
105:                 }
106:                 .help("Collapse All Folders")
107:             }
108:         }
109:     }
110:     
111:     // Content Switching
112:     @ViewBuilder
113:     private var sidebarContent: some View {
114:         switch selectedTab {
115:         case 0:
116:             IDESidebarFiles(editorCore: editorCore, fileNavigator: fileNavigator, showFolderPicker: $showFolderPicker, theme: theme)
117:         case 1:
118:             SidebarSearchView(theme: theme)
119:         case 2:
120:             GitView()
121:         case 3:
122:             DebugView()
123:         case 4:
124:             ExtensionsView()
125:         case 5:
126:             TestView()
127:         default:
128:             IDESidebarFiles(editorCore: editorCore, fileNavigator: fileNavigator, showFolderPicker: $showFolderPicker, theme: theme)
129:         }
130:     }
131: }
132: 
133: // MARK: - Activity Bar Implementation
134: 
135: struct IDEActivityBar: View {
136:     @ObservedObject var editorCore: EditorCore
137:     @Binding var selectedTab: Int
138:     @Binding var showSettings: Bool
139:     @Binding var showTerminal: Bool
140:     
141:     var body: some View {
142:         VStack(spacing: 0) {
143:             // Top Group
144:             Group {
145:                 ActivityBarIcon(icon: "doc.on.doc", title: "Explorer", index: 0, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.explorer")
146:                 ActivityBarIcon(icon: "magnifyingglass", title: "Search", index: 1, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.search")
147:                 ActivityBarIcon(icon: "arrow.triangle.branch", title: "Source Control", index: 2, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.sourceControl")
148:                 ActivityBarIcon(icon: "play.fill", title: "Run and Debug", index: 3, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.runAndDebug")
149:                 ActivityBarIcon(icon: "square.grid.2x2", title: "Extensions", index: 4, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.extensions")
150:                 ActivityBarIcon(icon: "testtube.2", title: "Testing", index: 5, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.testing")
151:             }
152:             
153:             Spacer()
154:             
155:             // Bottom Group
156:             Group {
157:                 ActivityBarButton(icon: "person.circle", title: "Accounts") {}
158:                 ActivityBarButton(icon: "gear", title: "Manage") {
159:                     showSettings = true
160:                 }
161:             }
162:             .padding(.bottom, 10)
163:         }
164:         .frame(width: 50)
165:         .background(Color(UIColor.secondarySystemBackground).opacity(0.8)) // Darker shade for activity bar
166:         .border(width: 1, edges: [.trailing], color: Color(UIColor.separator))
167:     }
168: }
169: 
170: struct ActivityBarIcon: View {
171:     let icon: String
172:     let title: String
173:     let index: Int
174:     @Binding var selectedTab: Int
175:     @ObservedObject var editorCore: EditorCore
176:     let accessibilityID: String
177:     
178:     var isSelected: Bool { selectedTab == index }
179:     
180:     var body: some View {
181:         Button(action: {
182:             if isSelected {
183:                 // Toggle sidebar visibility if clicking already selected tab
184:                 editorCore.toggleSidebar()
185:             } else {
186:                 selectedTab = index
187:                 if !editorCore.showSidebar { editorCore.toggleSidebar() }
188:             }
189:         }) {
190:             ZStack {
191:                 // Active indicator line on left
192:                 if isSelected && editorCore.showSidebar {
193:                     HStack {
194:                         Rectangle()
195:                             .fill(Color.accentColor)
196:                             .frame(width: 2)
197:                         Spacer()
198:                     }
199:                 }
200:                 
201:                 Image(systemName: icon)
202:                     .font(.system(size: 20, weight: .light))
203:                     .foregroundColor(isSelected && editorCore.showSidebar ? .primary : .secondary)
204:                     .frame(width: 50, height: 50)
205:                     .contentShape(Rectangle())
206:             }
207:         }
208:         .buttonStyle(PlainButtonStyle())
209:         .help(title)
210:         .accessibilityIdentifier(accessibilityID)
211:     }
212: }
213: 
214: struct ActivityBarButton: View {
215:     let icon: String
216:     let title: String
217:     let action: () -> Void
218:     
219:     var body: some View {
220:         Button(action: action) {
221:             Image(systemName: icon)
222:                 .font(.system(size: 20, weight: .light))
223:                 .foregroundColor(.secondary)
224:                 .frame(width: 50, height: 50)
225:                 .contentShape(Rectangle())
226:         }
227:         .buttonStyle(PlainButtonStyle())
228:         .help(title)
229:     }
230: }
231: 
232: // MARK: - Resize Handle (iPad Compatible)
233: 
234: struct ResizeHandle: View {
235:     @Binding var width: CGFloat
236:     @State private var isDragging = false
237:     
238:     var body: some View {
239:         HStack(spacing: 0) {
240:             Spacer()
241:             ZStack {
242:                 // Invisible larger hit area
243:                 Rectangle()
244:                     .fill(Color.clear)
245:                     .frame(width: 10)
246:                 
247:                 // Visible separator line
248:                 Rectangle()
249:                     .fill(isDragging ? Color.accentColor : Color(UIColor.separator))
250:                     .frame(width: 1)
251:             }
252:             .contentShape(Rectangle())
253:             .gesture(
254:                 DragGesture()
255:                     .onChanged { value in
256:                         isDragging = true
257:                         let newWidth = width + value.translation.width
258:                         // Clamp width (Min 170, Max 600)
259:                         if newWidth >= 170 && newWidth <= 600 {
260:                             width = newWidth
261:                         }
262:                     }
263:                     .onEnded { _ in
264:                         isDragging = false
265:                     }
266:             )
267:         }
268:     }
269: }
270: 
271: // MARK: - Placeholders for Missing Views
272: 
273: 
274: 
275: struct ExtensionsView: View {
276:     var body: some View {
277:         VStack {
278:             Text("Extensions")
279:                 .font(.caption)
280:                 .foregroundColor(.secondary)
281:                 .padding()
282:             Spacer()
283:         }
284:     }
285: }
286: 
287: 
288: 


>>>TOOL search
{"query": "SidebarView", "glob": "VSCodeiPadOS/VSCodeiPadOS/Views/SidebarView.swift"}
>>>END

---

## üîß TOOL RESULTS

[search]
Found 1 matches:
VSCodeiPadOS/VSCodeiPadOS/Views/SidebarView.swift:5: struct SidebarView: View {


>>>TOOL list_dir
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views"}
>>>END

---

## üîß TOOL RESULTS

[list_dir]
üìÅ VSCodeiPadOS/VSCodeiPadOS/Views/
üìÅ Editor/
üìÅ Panels/
   _tmp.txt
   BranchMenu.swift
   CommandPalette.swift
   CommandPaletteView.swift
   DiffComponents.swift
   FileIconView.swift
   FileTreeView.swift
   GoToSymbol.swift
   LaunchConfigView.swift
   QuickOpen.swift
   RunConfigView.swift
   SidebarView.swift
   SnippetPickerView.swift
   StatusBarView.swift
   TabBarView.swift
   TasksView.swift
   WorkspaceSettingsView.swift
   WorkspaceTrustDialog.swift


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/SidebarView.swift"}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/SidebarView.swift (lines 1-288 of 288)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1: import SwiftUI
2: 
3: // MARK: - Sidebar View Structure
4: 
5: struct SidebarView: View {
6:     @ObservedObject var editorCore: EditorCore
7:     @ObservedObject var fileNavigator: FileSystemNavigator
8:     @Binding var selectedTab: Int
9:     @Binding var showSettings: Bool
10:     @Binding var showTerminal: Bool
11:     @Binding var showFolderPicker: Bool
12:     var theme: Theme = ThemeManager.shared.currentTheme
13:     
14:     var body: some View {
15:         HStack(spacing: 0) {
16:             // 1. Activity Bar (Far Left)
17:             IDEActivityBar(
18:                 editorCore: editorCore,
19:                 selectedTab: $selectedTab,
20:                 showSettings: $showSettings,
21:                 showTerminal: $showTerminal
22:             )
23:             
24:             // 2. Sidebar Panel (Resizable)
25:             if editorCore.showSidebar {
26:                 ZStack(alignment: .trailing) {
27:                     VStack(spacing: 0) {
28:                         // Header Area
29:                         HStack {
30:                             Text(sidebarTitle)
31:                                 .font(.system(size: 11, weight: .medium))
32:                                 .foregroundColor(.secondary)
33:                                 .textCase(.uppercase)
34:                                 .accessibilityIdentifier("sidebar.header.title")
35:                             Spacer()
36:                             sidebarHeaderActions
37:                         }
38:                         .padding(.horizontal, 20)
39:                         .padding(.vertical, 10)
40:                         
41:                         Divider()
42:                             .background(Color(UIColor.separator))
43:                         
44:                         // Content Area
45:                         sidebarContent
46:                             .frame(maxWidth: .infinity, maxHeight: .infinity)
47:                     }
48:                     .frame(width: editorCore.sidebarWidth)
49:                     .background(Color(UIColor.secondarySystemBackground)) // Theme aware
50:                     .accessibilityIdentifier("sidebar.panel")
51:                     
52:                     // 5. Resize Handle
53:                     ResizeHandle(width: $editorCore.sidebarWidth)
54:                 }
55:             }
56:         }
57:     }
58:     
59:     // Dynamic Title based on selection
60:     private var sidebarTitle: String {
61:         switch selectedTab {
62:         case 0: return "EXPLORER"
63:         case 1: return "SEARCH"
64:         case 2: return "SOURCE CONTROL"
65:         case 3: return "RUN AND DEBUG"
66:         case 4: return "EXTENSIONS"
67:         case 5: return "TESTING"
68:         default: return "EXPLORER"
69:         }
70:     }
71:     
72:     // Header Actions
73:     @ViewBuilder
74:     private var sidebarHeaderActions: some View {
75:         if selectedTab == 0 {
76:             HStack(spacing: 12) {
77:                 Button(action: { showFolderPicker = true }) {
78:                     Image(systemName: "folder.badge.plus")
79:                         .font(.system(size: 14))
80:                         .foregroundColor(.secondary)
81:                 }
82:                 .help("Open Folder")
83:                 
84:                 Button(action: { editorCore.addTab() }) {
85:                     Image(systemName: "doc.badge.plus")
86:                         .font(.system(size: 14))
87:                         .foregroundColor(.secondary)
88:                 }
89:                 .help("New File")
90:                 
91:                 Button(action: { fileNavigator.refreshFileTree() }) {
92:                     Image(systemName: "arrow.clockwise")
93:                         .font(.system(size: 14))
94:                         .foregroundColor(.secondary)
95:                 }
96:                 .help("Refresh")
97:                 
98:                 Button(action: { 
99:                      // Collapse All Action 
100:                      fileNavigator.expandedPaths.removeAll()
101:                 }) {
102:                     Image(systemName: "arrow.up.left.and.arrow.down.right") // Collapse icon
103:                         .font(.system(size: 14))
104:                         .foregroundColor(.secondary)
105:                 }
106:                 .help("Collapse All Folders")
107:             }
108:         }
109:     }
110:     
111:     // Content Switching
112:     @ViewBuilder
113:     private var sidebarContent: some View {
114:         switch selectedTab {
115:         case 0:
116:             IDESidebarFiles(editorCore: editorCore, fileNavigator: fileNavigator, showFolderPicker: $showFolderPicker, theme: theme)
117:         case 1:
118:             SidebarSearchView(theme: theme)
119:         case 2:
120:             GitView()
121:         case 3:
122:             DebugView()
123:         case 4:
124:             ExtensionsView()
125:         case 5:
126:             TestView()
127:         default:
128:             IDESidebarFiles(editorCore: editorCore, fileNavigator: fileNavigator, showFolderPicker: $showFolderPicker, theme: theme)
129:         }
130:     }
131: }
132: 
133: // MARK: - Activity Bar Implementation
134: 
135: struct IDEActivityBar: View {
136:     @ObservedObject var editorCore: EditorCore
137:     @Binding var selectedTab: Int
138:     @Binding var showSettings: Bool
139:     @Binding var showTerminal: Bool
140:     
141:     var body: some View {
142:         VStack(spacing: 0) {
143:             // Top Group
144:             Group {
145:                 ActivityBarIcon(icon: "doc.on.doc", title: "Explorer", index: 0, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.explorer")
146:                 ActivityBarIcon(icon: "magnifyingglass", title: "Search", index: 1, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.search")
147:                 ActivityBarIcon(icon: "arrow.triangle.branch", title: "Source Control", index: 2, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.sourceControl")
148:                 ActivityBarIcon(icon: "play.fill", title: "Run and Debug", index: 3, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.runAndDebug")
149:                 ActivityBarIcon(icon: "square.grid.2x2", title: "Extensions", index: 4, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.extensions")
150:                 ActivityBarIcon(icon: "testtube.2", title: "Testing", index: 5, selectedTab: $selectedTab, editorCore: editorCore, accessibilityID: "activityBar.testing")
151:             }
152:             
153:             Spacer()
154:             
155:             // Bottom Group
156:             Group {
157:                 ActivityBarButton(icon: "person.circle", title: "Accounts") {}
158:                 ActivityBarButton(icon: "gear", title: "Manage") {
159:                     showSettings = true
160:                 }
161:             }
162:             .padding(.bottom, 10)
163:         }
164:         .frame(width: 50)
165:         .background(Color(UIColor.secondarySystemBackground).opacity(0.8)) // Darker shade for activity bar
166:         .border(width: 1, edges: [.trailing], color: Color(UIColor.separator))
167:     }
168: }
169: 
170: struct ActivityBarIcon: View {
171:     let icon: String
172:     let title: String
173:     let index: Int
174:     @Binding var selectedTab: Int
175:     @ObservedObject var editorCore: EditorCore
176:     let accessibilityID: String
177:     
178:     var isSelected: Bool { selectedTab == index }
179:     
180:     var body: some View {
181:         Button(action: {
182:             if isSelected {
183:                 // Toggle sidebar visibility if clicking already selected tab
184:                 editorCore.toggleSidebar()
185:             } else {
186:                 selectedTab = index
187:                 if !editorCore.showSidebar { editorCore.toggleSidebar() }
188:             }
189:         }) {
190:             ZStack {
191:                 // Active indicator line on left
192:                 if isSelected && editorCore.showSidebar {
193:                     HStack {
194:                         Rectangle()
195:                             .fill(Color.accentColor)
196:                             .frame(width: 2)
197:                         Spacer()
198:                     }
199:                 }
200:                 
201:                 Image(systemName: icon)
202:                     .font(.system(size: 20, weight: .light))
203:                     .foregroundColor(isSelected && editorCore.showSidebar ? .primary : .secondary)
204:                     .frame(width: 50, height: 50)
205:                     .contentShape(Rectangle())
206:             }
207:         }
208:         .buttonStyle(PlainButtonStyle())
209:         .help(title)
210:         .accessibilityIdentifier(accessibilityID)
211:     }
212: }
213: 
214: struct ActivityBarButton: View {
215:     let icon: String
216:     let title: String
217:     let action: () -> Void
218:     
219:     var body: some View {
220:         Button(action: action) {
221:             Image(systemName: icon)
222:                 .font(.system(size: 20, weight: .light))
223:                 .foregroundColor(.secondary)
224:                 .frame(width: 50, height: 50)
225:                 .contentShape(Rectangle())
226:         }
227:         .buttonStyle(PlainButtonStyle())
228:         .help(title)
229:     }
230: }
231: 
232: // MARK: - Resize Handle (iPad Compatible)
233: 
234: struct ResizeHandle: View {
235:     @Binding var width: CGFloat
236:     @State private var isDragging = false
237:     
238:     var body: some View {
239:         HStack(spacing: 0) {
240:             Spacer()
241:             ZStack {
242:                 // Invisible larger hit area
243:                 Rectangle()
244:                     .fill(Color.clear)
245:                     .frame(width: 10)
246:                 
247:                 // Visible separator line
248:                 Rectangle()
249:                     .fill(isDragging ? Color.accentColor : Color(UIColor.separator))
250:                     .frame(width: 1)
251:             }
252:             .contentShape(Rectangle())
253:             .gesture(
254:                 DragGesture()
255:                     .onChanged { value in
256:                         isDragging = true
257:                         let newWidth = width + value.translation.width
258:                         // Clamp width (Min 170, Max 600)
259:                         if newWidth >= 170 && newWidth <= 600 {
260:                             width = newWidth
261:                         }
262:                     }
263:                     .onEnded { _ in
264:                         isDragging = false
265:                     }
266:             )
267:         }
268:     }
269: }
270: 
271: // MARK: - Placeholders for Missing Views
272: 
273: 
274: 
275: struct ExtensionsView: View {
276:     var body: some View {
277:         VStack {
278:             Text("Extensions")
279:                 .font(.caption)
280:                 .foregroundColor(.secondary)
281:                 .padding()
282:             Spacer()
283:         }
284:     }
285: }
286: 
287: 
288: 


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Models/ThemeManager.swift"}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Models/ThemeManager.swift (lines 1-77 of 77)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1: import SwiftUI
2: import Combine
3: 
4: class ThemeManager: ObservableObject {
5:     @AppStorage("selectedThemeId") var selectedThemeId: String = "dark_plus"
6:     @Published var currentTheme: Theme
7:     
8:     static let shared = ThemeManager()
9:     
10:     // Quick access to current theme
11:     static var current: Theme { shared.currentTheme }
12:     
13:     init() {
14:         let themeId = UserDefaults.standard.string(forKey: "selectedThemeId") ?? "dark_plus"
15:         self.currentTheme = Theme.allThemes.first(where: { $0.id == themeId }) ?? .darkPlus
16:     }
17:     
18:     func switchTheme(to themeId: String) {
19:         if let theme = Theme.allThemes.first(where: { $0.id == themeId }) {
20:             withAnimation(.easeInOut(duration: 0.2)) {
21:                 self.currentTheme = theme
22:             }
23:             self.selectedThemeId = themeId
24:         }
25:     }
26:     
27:     func switchTheme(to theme: Theme) {
28:         switchTheme(to: theme.id)
29:     }
30:     
31:     // Cycle to next theme
32:     func nextTheme() {
33:         let themes = Theme.allThemes
34:         guard let currentIndex = themes.firstIndex(where: { $0.id == currentTheme.id }) else {
35:             switchTheme(to: themes.first!)
36:             return
37:         }
38:         let nextIndex = (currentIndex + 1) % themes.count
39:         switchTheme(to: themes[nextIndex])
40:     }
41:     
42:     // Cycle to previous theme
43:     func previousTheme() {
44:         let themes = Theme.allThemes
45:         guard let currentIndex = themes.firstIndex(where: { $0.id == currentTheme.id }) else {
46:             switchTheme(to: themes.first!)
47:             return
48:         }
49:         let prevIndex = currentIndex == 0 ? themes.count - 1 : currentIndex - 1
50:         switchTheme(to: themes[prevIndex])
51:     }
52:     
53:     // Get themes by category
54:     var darkThemes: [Theme] {
55:         Theme.allThemes.filter { $0.isDark }
56:     }
57:     
58:     var lightThemes: [Theme] {
59:         Theme.allThemes.filter { !$0.isDark }
60:     }
61:     
62:     // Helper for file colors that adapts to theme
63:     func color(for filename: String) -> Color {
64:         let ext = (filename as NSString).pathExtension.lowercased()
65:         switch ext {
66:         case "swift": return .orange
67:         case "js", "jsx": return .yellow
68:         case "ts", "tsx": return .blue
69:         case "py": return .green
70:         case "html", "htm": return .red
71:         case "css", "scss": return .purple
72:         case "json": return .green
73:         case "md": return .blue
74:         default: return currentTheme.isDark ? .white : .black
75:         }
76:     }
77: }


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift", "start_line": 1330, "end_line": 1380}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/Editor/SyntaxHighlightingTextView.swift (lines 1331-1380 of 2011)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1331:         case "m", "mm": return .objectiveC
1332: 
1333:         case "html", "htm": return .html
1334:         case "css": return .css
1335:         case "scss", "sass": return .scss
1336:         case "less": return .less
1337:         case "json", "jsonc": return .json
1338:         case "xml", "plist", "svg": return .xml
1339:         case "yml", "yaml": return .yaml
1340:         case "sql": return .sql
1341: 
1342:         case "sh", "bash", "zsh", "fish": return .shell
1343:         case "dockerfile": return .dockerfile
1344: 
1345:         case "graphql", "gql": return .graphql
1346: 
1347:         case "md", "markdown": return .markdown
1348:         case "php": return .php
1349:         case "env": return .env
1350: 
1351:         default: return .plainText
1352:         }
1353:     }
1354:     
1355:     private func highlight(_ text: String, language: Language) -> NSAttributedString {
1356:         let attributed = NSMutableAttributedString(string: text)
1357:         let fullRange = NSRange(location: 0, length: text.utf16.count)
1358:         
1359:         // Base attributes
1360:         let baseFont = UIFont.monospacedSystemFont(ofSize: baseFontSize, weight: .regular)
1361:         attributed.addAttribute(.font, value: baseFont, range: fullRange)
1362:         attributed.addAttribute(.foregroundColor, value: UIColor(theme.editorForeground), range: fullRange)
1363:         
1364:         // Apply language-specific highlighting
1365:         switch language {
1366:         case .swift: highlightSwift(attributed, text: text)
1367:         case .javascript, .jsx: highlightJavaScript(attributed, text: text, isTS: false)
1368:         case .typescript, .tsx: highlightJavaScript(attributed, text: text, isTS: true)
1369:         case .python: highlightPython(attributed, text: text)
1370:         case .html, .xml: highlightHTML(attributed, text: text)
1371:         case .css, .scss, .less: highlightCSS(attributed, text: text)
1372:         case .json: highlightJSON(attributed, text: text)
1373:         case .markdown: highlightMarkdown(attributed, text: text)
1374:         case .rust: highlightRust(attributed, text: text)
1375:         case .go: highlightGo(attributed, text: text)
1376:         case .java, .kotlin: highlightJava(attributed, text: text)
1377:         case .c, .cpp, .objectiveC: highlightCpp(attributed, text: text)
1378:         case .ruby: highlightRuby(attributed, text: text)
1379:         case .php: highlightPHP(attributed, text: text)
1380:         case .shell, .dockerfile: highlightShell(attributed, text: text)


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/SidebarView.swift", "start_line": 40, "end_line": 55}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/SidebarView.swift (lines 41-55 of 288)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
41:                         Divider()
42:                             .background(Color(UIColor.separator))
43:                         
44:                         // Content Area
45:                         sidebarContent
46:                             .frame(maxWidth: .infinity, maxHeight: .infinity)
47:                     }
48:                     .frame(width: editorCore.sidebarWidth)
49:                     .background(Color(UIColor.secondarySystemBackground)) // Theme aware
50:                     .accessibilityIdentifier("sidebar.panel")
51:                     
52:                     // 5. Resize Handle
53:                     ResizeHandle(width: $editorCore.sidebarWidth)
54:                 }
55:             }


>>>TOOL list_dir
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views"}
>>>END

---

## üîß TOOL RESULTS

[list_dir]
üìÅ VSCodeiPadOS/VSCodeiPadOS/Views/
üìÅ Editor/
üìÅ Panels/
   _tmp.txt
   BranchMenu.swift
   CommandPalette.swift
   CommandPaletteView.swift
   DiffComponents.swift
   FileIconView.swift
   FileTreeView.swift
   GoToSymbol.swift
   LaunchConfigView.swift
   QuickOpen.swift
   RunConfigView.swift
   SidebarView.swift
   SnippetPickerView.swift
   StatusBarView.swift
   TabBarView.swift
   TasksView.swift
   WorkspaceSettingsView.swift
   WorkspaceTrustDialog.swift


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/FileTreeView.swift"}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/FileTreeView.swift (lines 1-250 of 250)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1: import SwiftUI
2: import UniformTypeIdentifiers
3: 
4: // MARK: - File Tree View
5: 
6: struct FileTreeView: View {
7:     let root: FileTreeNode
8:     @ObservedObject var fileNavigator: FileSystemNavigator
9:     @ObservedObject var editorCore: EditorCore
10:     
11:     var body: some View {
12:         ScrollView {
13:             LazyVStack(alignment: .leading, spacing: 0) {
14:                 FileTreeRowView(
15:                     node: root,
16:                     level: 0,
17:                     fileNavigator: fileNavigator,
18:                     editorCore: editorCore
19:                 )
20:             }
21:         }
22:     }
23: }
24: 
25: // MARK: - File Tree Row View
26: 
27: struct FileTreeRowView: View {
28:     let node: FileTreeNode
29:     let level: Int
30:     @ObservedObject var fileNavigator: FileSystemNavigator
31:     @ObservedObject var editorCore: EditorCore
32:     
33:     @State private var isHovered = false
34:     @State private var showingRenameAlert = false
35:     @State private var showingNewFileAlert = false
36:     @State private var showingNewFolderAlert = false
37:     @State private var showingDeleteConfirmation = false
38:     @State private var newName = ""
39:     @State private var newFileName = "untitled.txt"
40:     @State private var newFolderName = "New Folder"
41:     
42:     private var isExpanded: Bool {
43:         fileNavigator.expandedPaths.contains(node.url.path)
44:     }
45:     
46:     var body: some View {
47:         VStack(alignment: .leading, spacing: 0) {
48:             // Row content
49:             HStack(spacing: 4) {
50:                 // Indentation
51:                 if level > 0 {
52:                     Spacer()
53:                         .frame(width: CGFloat(level) * 16)
54:                 }
55:                 
56:                 // Expand/collapse button for directories
57:                 if node.isDirectory {
58:                     Button {
59:                         withAnimation(.easeInOut(duration: 0.15)) {
60:                             fileNavigator.toggleExpanded(path: node.url.path)
61:                         }
62:                     } label: {
63:                         Image(systemName: isExpanded ? "chevron.down" : "chevron.right")
64:                             .font(.caption2)
65:                             .frame(width: 12)
66:                             .foregroundColor(.secondary)
67:                     }
68:                     .buttonStyle(.plain)
69:                 } else {
70:                     Spacer().frame(width: 12)
71:                 }
72:                 
73:                 // File/folder icon
74:                 FileIconView(filename: node.name, isDirectory: node.isDirectory, isOpen: isExpanded)
75:                     .frame(width: 16, height: 16)
76:                 
77:                 // Name
78:                 Text(node.name)
79:                     .font(.system(size: 13))
80:                     .lineLimit(1)
81:                     .foregroundColor(.primary)
82:                 
83:                 Spacer()
84:             }
85:             .padding(.vertical, 2)
86:             .padding(.horizontal, 4)
87:             .background(isHovered ? Color.gray.opacity(0.2) : Color.clear)
88:             .contentShape(Rectangle())
89:             .modifier(DraggableToFileModifier(fileURL: node.url, isDirectory: node.isDirectory))
90:             .onTapGesture {
91:                 if node.isDirectory {
92:                     withAnimation(.easeInOut(duration: 0.15)) {
93:                         fileNavigator.toggleExpanded(path: node.url.path)
94:                     }
95:                 } else {
96:                     editorCore.openFile(from: node.url)
97:                 }
98:             }
99:             .onHover { hovering in
100:                 isHovered = hovering
101:             }
102:             .contextMenu {
103:                 // New File
104:                 Button {
105:                     newFileName = "untitled.txt"
106:                     showingNewFileAlert = true
107:                 } label: {
108:                     Label("New File", systemImage: "doc.badge.plus")
109:                 }
110:                 
111:                 // New Folder
112:                 Button {
113:                     newFolderName = "New Folder"
114:                     showingNewFolderAlert = true
115:                 } label: {
116:                     Label("New Folder", systemImage: "folder.badge.plus")
117:                 }
118:                 
119:                 // Rename
120:                 Button {
121:                     newName = node.name
122:                     showingRenameAlert = true
123:                 } label: {
124:                     Label("Rename", systemImage: "pencil")
125:                 }
126:                 
127:                 Divider()
128:                 
129:                 // Delete
130:                 Button(role: .destructive) {
131:                     showingDeleteConfirmation = true
132:                 } label: {
133:                     Label("Delete", systemImage: "trash")
134:                 }
135:                 
136:                 Divider()
137:                 
138:                 // Copy Path
139:                 Button {
140:                     #if os(iOS)
141:                     UIPasteboard.general.string = node.url.path
142:                     #elseif os(macOS)
143:                     NSPasteboard.general.setString(node.url.path, forType: .string)
144:                     #endif
145:                 } label: {
146:                     Label("Copy Path", systemImage: "doc.on.doc")
147:                 }
148:                 
149:                 // Reveal in Finder
150:                 #if os(macOS)
151:                 Button {
152:                     NSWorkspace.shared.activateFileViewerSelecting([node.url])
153:                 } label: {
154:                     Label("Reveal in Finder", systemImage: "folder")
155:                 }
156:                 #endif
157:             }
158:             .alert("Rename", isPresented: $showingRenameAlert) {
159:                 TextField("Name", text: $newName)
160:                 Button("Cancel", role: .cancel) { }
161:                 Button("Rename") {
162:                     guard !newName.isEmpty, newName != node.name else { return }
163:                     do {
164:                         _ = try fileNavigator.renameItem(at: node.url, to: newName)
165:                     } catch {
166:                         print("Failed to rename: \(error)")
167:                     }
168:                 }
169:             }
170:             .alert("New File", isPresented: $showingNewFileAlert) {
171:                 TextField("File name", text: $newFileName)
172:                 Button("Cancel", role: .cancel) { }
173:                 Button("Create") {
174:                     guard !newFileName.isEmpty else { return }
175:                     let targetFolder = node.isDirectory ? node.url : node.url.deletingLastPathComponent()
176:                     fileNavigator.createFile(name: newFileName, in: targetFolder)
177:                 }
178:             }
179:             .alert("New Folder", isPresented: $showingNewFolderAlert) {
180:                 TextField("Folder name", text: $newFolderName)
181:                 Button("Cancel", role: .cancel) { }
182:                 Button("Create") {
183:                     guard !newFolderName.isEmpty else { return }
184:                     let targetFolder = node.isDirectory ? node.url : node.url.deletingLastPathComponent()
185:                     fileNavigator.createFolder(name: newFolderName, in: targetFolder)
186:                 }
187:             }
188:             .alert("Delete \"\(node.name)\"?", isPresented: $showingDeleteConfirmation) {
189:                 Button("Cancel", role: .cancel) { }
190:                 Button("Delete", role: .destructive) {
191:                     _ = fileNavigator.deleteItem(at: node.url)
192:                 }
193:             } message: {
194:                 Text("This action cannot be undone.")
195:             }
196:             
197:             // Children
198:             if node.isDirectory && isExpanded {
199:                 ForEach(node.children.sorted(by: { lhs, rhs in
200:                     // Directories first, then alphabetical
201:                     if lhs.isDirectory != rhs.isDirectory {
202:                         return lhs.isDirectory
203:                     }
204:                     return lhs.name.localizedCaseInsensitiveCompare(rhs.name) == .orderedAscending
205:                 })) { child in
206:                     FileTreeRowView(
207:                         node: child,
208:                         level: level + 1,
209:                         fileNavigator: fileNavigator,
210:                         editorCore: editorCore
211:                     )
212:                 }
213:             }
214:         }
215:     }
216: }
217: 
218: // MARK: - Draggable To File Modifier
219: 
220: struct DraggableToFileModifier: ViewModifier {
221:     let fileURL: URL
222:     let isDirectory: Bool
223:     
224:     func body(content: Content) -> some View {
225:         if !isDirectory {
226:             content.onDrag {
227:                 NSItemProvider(object: fileURL.path as NSString)
228:             }
229:         } else {
230:             content
231:         }
232:     }
233: }
234: 
235: // MARK: - Draggable To New Window Modifier
236: 
237: extension View {
238:     func draggableToNewWindow(fileURL: URL) -> some View {
239:         self.onDrag {
240:             NSItemProvider(object: fileURL.path as NSString)
241:         }
242:     }
243: }
244: 
245: // MARK: - UTType Extension
246: 
247: extension UTType {
248:     static let vscodeFilePathPayload = UTType(exportedAs: "com.vscode.ipados.filepath")
249: }
250: 


>>>TOOL list_dir
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Panels"}
>>>END

---

## üîß TOOL RESULTS

[list_dir]
üìÅ VSCodeiPadOS/VSCodeiPadOS/Views/Panels/
   AIAssistantView.swift
   AIAssistantView.swift.backup
   AIAssistantView.swift.bak
   DebugConsoleView.swift
   DebugView.swift
   GitQuickActionsView.swift
   GitView.swift
   GitView.swift.broken
   GoToLineView.swift
   MarkdownPreviewView.swift
   MarkdownPreviewWrapper.swift
   OutlineView.swift
   OutputView.swift
   PanelView.swift
   ProblemsView.swift
   RunnerWarningView.swift
   SearchView.swift
   SearchView.swift.broken
   SettingsView.swift
   TerminalView.swift
   TerminalView.swift.bak
   TestView.swift
   TimelineView.swift


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Panels/PanelView.swift"}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/Panels/PanelView.swift (lines 1-142 of 142)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1: import SwiftUI
2: import SwiftUI
3: 
4: enum PanelTab: String, CaseIterable, Identifiable {
5:     case problems = "Problems"
6:     case output = "Output"
7:     case terminal = "Terminal"
8:     case debugConsole = "Debug Console"
9:     
10:     var id: String { rawValue }
11:     
12:     var icon: String {
13:         switch self {
14:         case .problems: return "exclamationmark.triangle"
15:         case .output: return "list.bullet.rectangle"
16:         case .terminal: return "terminal"
17:         case .debugConsole: return "ant.circle"
18:         }
19:     }
20: }
21: 
22: struct PanelView: View {
23:     @Binding var isVisible: Bool
24:     @Binding var height: CGFloat
25:     @State private var selectedTab: PanelTab = .terminal
26:     @State private var isMaximized: Bool = false
27:     @State private var previousHeight: CGFloat = 200
28:     
29:     // Resize state
30:     @GestureState private var dragOffset: CGFloat = 0
31:     
32:     var body: some View {
33:         VStack(spacing: 0) {
34:             // Resize Handle
35:             Rectangle()
36:                 .fill(Color(UIColor.separator))
37:                 .frame(height: 1)
38:                 .overlay(
39:                     Rectangle()
40:                         .fill(Color.clear)
41:                         .frame(height: 8)
42:                         .contentShape(Rectangle())
43:                         .gesture(
44:                             DragGesture()
45:                                 .onChanged { value in
46:                                     let newHeight = height - value.translation.height
47:                                     height = max(100, min(newHeight, UIScreen.main.bounds.height - 100))
48:                                 }
49:                         )
50:                 )
51:             
52:             // Tab Bar
53:             HStack(spacing: 0) {
54:                 ForEach(PanelTab.allCases) { tab in
55:                     PanelTabButton(tab: tab, isSelected: selectedTab == tab) {
56:                         selectedTab = tab
57:                     }
58:                 }
59:                 
60:                 Spacer()
61:                 
62:                 // Panel Controls
63:                 HStack(spacing: 12) {
64:                     Button(action: {
65:                         if isMaximized {
66:                             height = previousHeight
67:                         } else {
68:                             previousHeight = height
69:                             height = UIScreen.main.bounds.height - 100
70:                         }
71:                         isMaximized.toggle()
72:                     }) {
73:                         Image(systemName: isMaximized ? "arrow.down.right.and.arrow.up.left" : "arrow.up.left.and.arrow.down.right")
74:                             .font(.system(size: 12))
75:                     }
76:                     
77:                     Button(action: { isVisible = false }) {
78:                         Image(systemName: "xmark")
79:                             .font(.system(size: 12))
80:                     }
81:                 }
82:                 .foregroundColor(.secondary)
83:                 .padding(.horizontal, 12)
84:             }
85:             .frame(height: 35)
86:             .background(Color(UIColor.secondarySystemBackground))
87:             
88:             Divider()
89:             
90:             // Content
91:             Group {
92:                 switch selectedTab {
93:                 case .problems:
94:                     ProblemsView()
95:                 case .output:
96:                     OutputView()
97:                 case .terminal:
98:                     TerminalView()
99:                 case .debugConsole:
100:                     Text("Debug Console Placeholder") // Create view later if needed
101:                         .frame(maxWidth: .infinity, maxHeight: .infinity)
102:                         .background(Color(UIColor.systemBackground))
103:                 }
104:             }
105:             .frame(height: isMaximized ? UIScreen.main.bounds.height - 140 : height - 36)
106:         }
107:         .background(Color(UIColor.systemBackground))
108:     }
109: }
110: 
111: struct PanelTabButton: View {
112:     let tab: PanelTab
113:     let isSelected: Bool
114:     let action: () -> Void
115:     
116:     var body: some View {
117:         Button(action: action) {
118:             HStack(spacing: 6) {
119:                 Text(tab.rawValue.uppercased())
120:                     .font(.system(size: 11, weight: isSelected ? .semibold : .regular))
121:                 
122:                 if tab == .problems {
123:                     Circle()
124:                         .fill(Color.secondary)
125:                         .frame(width: 6, height: 6)
126:                 }
127:             }
128:             .foregroundColor(isSelected ? .primary : .secondary)
129:             .padding(.horizontal, 12)
130:             .frame(maxHeight: .infinity)
131:             .background(isSelected ? Color(UIColor.systemBackground) : Color.clear)
132:             .overlay(
133:                 Rectangle()
134:                     .frame(height: 1)
135:                     .foregroundColor(isSelected ? .clear : Color(UIColor.separator))
136:                 , alignment: .bottom
137:             )
138:         }
139:         .buttonStyle(.plain)
140:     }
141: }
142: 


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Panels/TerminalView.swift"}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/Panels/TerminalView.swift (lines 1-981 of 981)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1: import SwiftUI
2: import SwiftUI
3: import UIKit
4: import Network
5: import Foundation
6: 
7: // MARK: - Terminal View (Main Container)
8: 
9: struct TerminalView: View {
10:     @StateObject private var workspace = TerminalWorkspace.shared
11:     @ObservedObject private var themeManager = ThemeManager.shared
12:     @State private var showConnectionSheet = false
13: 
14:     var body: some View {
15:         VStack(spacing: 0) {
16:             // MARK: Top Toolbar
17:             HStack(spacing: 10) {
18:                 Text("TERMINAL")
19:                     .font(.caption)
20:                     .fontWeight(.bold)
21:                     .foregroundColor(themeManager.currentTheme.tabActiveForeground)
22:                     .padding(.horizontal, 8)
23: 
24:                 Spacer()
25: 
26:                 HStack(spacing: 12) {
27:                     Button(action: { workspace.addTab() }) {
28:                         Image(systemName: "plus")
29:                     }
30:                     .help("New Terminal")
31: 
32:                     Button(action: { workspace.toggleSplitActiveTab() }) {
33:                         Image(systemName: "square.split.2x1")
34:                     }
35:                     .disabled(workspace.tabs.isEmpty)
36:                     .help("Split Terminal")
37: 
38:                     Button(action: copyActiveTerminalToClipboard) {
39:                         Image(systemName: "doc.on.doc")
40:                     }
41:                     .disabled(workspace.activePane == nil)
42:                     .help("Copy Terminal Output")
43: 
44:                     Button(action: pasteClipboardToActiveTerminal) {
45:                         Image(systemName: "doc.on.clipboard")
46:                     }
47:                     .disabled(workspace.activePane == nil)
48:                     .help("Paste")
49: 
50:                     Button(action: { workspace.activePane?.clear() }) {
51:                         Image(systemName: "trash")
52:                     }
53:                     .disabled(workspace.activePane == nil)
54:                     .help("Clear Terminal")
55: 
56:                     Button(action: { workspace.killActive() }) {
57:                         Image(systemName: "xmark")
58:                     }
59:                     .disabled(workspace.activePane == nil)
60:                     .help("Kill Terminal")
61: 
62:                     Button(action: { showConnectionSheet = true }) {
63:                         Image(systemName: "network")
64:                     }
65:                     .disabled(workspace.activePane == nil)
66:                     .help("SSH Connect")
67:                 }
68:                 .font(.caption)
69:                 .foregroundColor(themeManager.currentTheme.editorForeground)
70:             }
71:             .padding(8)
72:             .background(themeManager.currentTheme.editorBackground)
73:             .overlay(
74:                 Rectangle()
75:                     .frame(height: 1)
76:                     .foregroundColor(themeManager.currentTheme.editorForeground.opacity(0.2)),
77:                 alignment: .bottom
78:             )
79: 
80:             // MARK: Tab Strip
81:             ScrollView(.horizontal, showsIndicators: false) {
82:                 HStack(spacing: 6) {
83:                     ForEach(workspace.tabs) { tab in
84:                         if let primary = tab.panes.first {
85:                             TerminalTabButtonView(
86:                                 terminal: primary,
87:                                 isActive: workspace.activeTabId == tab.id,
88:                                 onSelect: { workspace.activeTabId = tab.id },
89:                                 onClose: { workspace.closeTab(id: tab.id) },
90:                                 onRename: { workspace.activeTabId = tab.id },
91:                                 onSplit: { workspace.activeTabId = tab.id; workspace.toggleSplitActiveTab() }
92:                             )
93:                         }
94:                     }
95: 
96:                     Button(action: { workspace.addTab() }) {
97:                         Image(systemName: "plus")
98:                             .font(.caption)
99:                             .padding(.horizontal, 10)
100:                             .padding(.vertical, 6)
101:                             .background(
102:                                 RoundedRectangle(cornerRadius: 6)
103:                                     .fill(themeManager.currentTheme.editorForeground.opacity(0.08))
104:                             )
105:                     }
106:                     .buttonStyle(.plain)
107:                     .help("New Terminal")
108:                 }
109:                 .padding(.horizontal, 8)
110:                 .padding(.vertical, 6)
111:             }
112:             .background(themeManager.currentTheme.editorBackground)
113:             .overlay(
114:                 Rectangle()
115:                     .frame(height: 1)
116:                     .foregroundColor(themeManager.currentTheme.editorForeground.opacity(0.12)),
117:                 alignment: .bottom
118:             )
119: 
120:             // MARK: Terminal Content
121:             Group {
122:                 if let tab = workspace.activeTab {
123:                     if tab.panes.count <= 1, let terminal = tab.panes.first {
124:                         SingleTerminalView(
125:                             terminal: terminal,
126:                             isActive: true,
127:                             onActivate: { workspace.setActivePane(terminal.id, in: tab.id) },
128:                             onKill: { workspace.killActive() }
129:                         )
130:                     } else {
131:                         HStack(spacing: 0) {
132:                             ForEach(tab.panes) { pane in
133:                                 SingleTerminalView(
134:                                     terminal: pane,
135:                                     isActive: tab.activePaneId == pane.id,
136:                                     onActivate: { workspace.setActivePane(pane.id, in: tab.id) },
137:                                     onKill: { workspace.killActive() }
138:                                 )
139:                                 .frame(maxWidth: .infinity, maxHeight: .infinity)
140: 
141:                                 if pane.id != tab.panes.last?.id {
142:                                     Divider()
143:                                         .background(themeManager.currentTheme.editorForeground.opacity(0.2))
144:                                 }
145:                             }
146:                         }
147:                     }
148:                 } else {
149:                     VStack(spacing: 12) {
150:                         Text("No Open Terminals")
151:                             .foregroundColor(themeManager.currentTheme.editorForeground.opacity(0.5))
152:                         Button("Create New Terminal") {
153:                             workspace.addTab()
154:                         }
155:                     }
156:                     .frame(maxWidth: .infinity, maxHeight: .infinity)
157:                     .background(themeManager.currentTheme.editorBackground)
158:                 }
159:             }
160:         }
161:         .background(themeManager.currentTheme.editorBackground)
162:         .sheet(isPresented: $showConnectionSheet) {
163:             if let active = workspace.activePane {
164:                 SSHConnectionView(terminal: active, isPresented: $showConnectionSheet)
165:             }
166:         }
167:     }
168: 
169:     private func copyActiveTerminalToClipboard() {
170:         guard let terminal = workspace.activePane else { return }
171:         let text = terminal.output.map(\.text).joined(separator: "\n")
172:         UIPasteboard.general.string = text
173:     }
174: 
175:     private func pasteClipboardToActiveTerminal() {
176:         guard let terminal = workspace.activePane else { return }
177:         guard let clip = UIPasteboard.general.string, !clip.isEmpty else { return }
178:         terminal.draftCommand.append(contentsOf: clip)
179:     }
180: }
181: 
182: struct TerminalTabButtonView: View {
183:     @ObservedObject var terminal: TerminalManager
184:     var isActive: Bool
185:     var onSelect: () -> Void
186:     var onClose: () -> Void
187:     var onRename: () -> Void
188:     var onSplit: () -> Void
189: 
190:     @ObservedObject private var themeManager = ThemeManager.shared
191:     @State private var showRenameAlert = false
192: 
193:     var body: some View {
194:         Button(action: onSelect) {
195:             HStack(spacing: 6) {
196:                 Image(systemName: "terminal")
197:                     .font(.caption2)
198: 
199:                 Text(terminal.title.isEmpty ? "Terminal" : terminal.title)
200:                     .font(.caption)
201:                     .lineLimit(1)
202:                     .frame(maxWidth: 200, alignment: .leading)
203: 
204:                 Button(action: onClose) {
205:                     Image(systemName: "xmark")
206:                         .font(.caption2)
207:                 }
208:                 .buttonStyle(.plain)
209:             }
210:             .padding(.horizontal, 10)
211:             .padding(.vertical, 6)
212:             .background(
213:                 RoundedRectangle(cornerRadius: 6)
214:                     .fill(isActive ? themeManager.currentTheme.editorForeground.opacity(0.15) : themeManager.currentTheme.editorForeground.opacity(0.08))
215:             )
216:             .overlay(
217:                 RoundedRectangle(cornerRadius: 6)
218:                     .stroke(isActive ? themeManager.currentTheme.tabActiveForeground.opacity(0.5) : .clear, lineWidth: 1)
219:             )
220:         }
221:         .buttonStyle(.plain)
222:         .contextMenu {
223:             Button(action: {
224:                 showRenameAlert = true
225:             }) {
226:                 Label("Rename Terminal", systemImage: "pencil")
227:             }
228: 
229:             Button(action: {
230:                 onSplit()
231:             }) {
232:                 Label("Split Terminal", systemImage: "square.split.2x1")
233:             }
234: 
235:             Divider()
236: 
237:             Button(action: {
238:                 onClose()
239:             }) {
240:                 Label("Close Terminal", systemImage: "xmark")
241:                     .foregroundColor(.red)
242:             }
243:         }
244:         .alert("Rename Terminal", isPresented: $showRenameAlert) {
245:             TextField("Terminal Name", text: $terminal.title)
246:             Button("OK", role: .cancel) { }
247:         }
248:     }
249: }
250: 
251: // MARK: - Single Terminal View
252: 
253: struct SingleTerminalView: View {
254:     @ObservedObject var terminal: TerminalManager
255:     var isActive: Bool
256:     var onActivate: () -> Void
257:     var onKill: () -> Void
258: 
259:     @ObservedObject private var themeManager = ThemeManager.shared
260:     @FocusState private var isInputFocused: Bool
261: 
262:     var body: some View {
263:         VStack(spacing: 0) {
264:             // Terminal Output
265:             ScrollViewReader { proxy in
266:                 ScrollView {
267:                     VStack(alignment: .leading, spacing: 2) {
268:                         ForEach(terminal.output) { line in
269:                             TerminalLineView(line: line)
270:                                 .id(line.id)
271:                         }
272:                     }
273:                     .frame(maxWidth: .infinity, alignment: .leading)
274:                     .padding(8)
275:                 }
276:                 .onChange(of: terminal.output.count) { _ in
277:                     withAnimation(.easeOut(duration: 0.1)) {
278:                         proxy.scrollTo(terminal.output.last?.id, anchor: .bottom)
279:                     }
280:                 }
281:             }
282:             .contentShape(Rectangle())
283:             .contextMenu {
284:                 Button(action: {
285:                     let text = terminal.output.map(\.text).joined(separator: "\n")
286:                     UIPasteboard.general.string = text
287:                 }) {
288:                     Label("Copy", systemImage: "doc.on.doc")
289:                 }
290: 
291:                 Button(action: {
292:                     if let clip = UIPasteboard.general.string, !clip.isEmpty {
293:                         terminal.draftCommand.append(contentsOf: clip)
294:                     }
295:                 }) {
296:                     Label("Paste", systemImage: "doc.on.clipboard")
297:                 }
298: 
299:                 Divider()
300: 
301:                 Button(action: {
302:                     terminal.clear()
303:                 }) {
304:                     Label("Clear Terminal", systemImage: "trash")
305:                 }
306: 
307:                 Divider()
308: 
309:                 Button(action: {
310:                     onKill()
311:                 }) {
312:                     Label("Kill Terminal", systemImage: "xmark.circle")
313:                         .foregroundColor(.red)
314:                 }
315:             }
316:             .onTapGesture {
317:                 onActivate()
318:                 isInputFocused = true
319:             }
320: 
321:             // Input Area
322:             HStack(spacing: 0) {
323:                 Text(terminal.promptString)
324:                     .font(.system(.body, design: .monospaced))
325:                     .foregroundColor(themeManager.currentTheme.type)
326:                     .padding(.leading, 8)
327: 
328:                 TextField("", text: $terminal.draftCommand)
329:                     .font(.system(.body, design: .monospaced))
330:                     .foregroundColor(themeManager.currentTheme.editorForeground)
331:                     .accentColor(themeManager.currentTheme.cursor)
332:                     .autocapitalization(.none)
333:                     .disableAutocorrection(true)
334:                     .focused($isInputFocused)
335:                     .onSubmit { executeCommand() }
336:                     .padding(8)
337:             }
338:             .background(themeManager.currentTheme.editorBackground)
339: 
340:             // Mobile Helper Bar (optional)
341:             if isInputFocused {
342:                 HStack(spacing: 12) {
343:                     Button("Tab") { terminal.sendTab() }
344:                     Button("Esc") { /* handle esc */ }
345:                     Button("Ctrl+C") { terminal.sendInterrupt() }
346:                         .foregroundColor(.red)
347:                     Spacer()
348:                     Button("ls") { terminal.draftCommand = "ls -la" }
349:                     Button("git status") { terminal.draftCommand = "git status" }
350:                 }
351:                 .font(.caption)
352:                 .padding(.horizontal)
353:                 .padding(.vertical, 6)
354:                 .background(themeManager.currentTheme.editorForeground.opacity(0.1))
355:             }
356:         }
357:         .background(themeManager.currentTheme.editorBackground)
358:         .overlay(
359:             RoundedRectangle(cornerRadius: 0)
360:                 .stroke(isActive ? themeManager.currentTheme.tabActiveForeground.opacity(0.35) : .clear, lineWidth: 1)
361:         )
362:         .onAppear {
363:             if isActive {
364:                 isInputFocused = true
365:             }
366:         }
367:     }
368: 
369:     private func executeCommand() {
370:         let command = terminal.draftCommand.trimmingCharacters(in: .whitespacesAndNewlines)
371:         guard !command.isEmpty else { return }
372:         terminal.executeCommand(command)
373:         terminal.draftCommand = ""
374:     }
375: }
376: 
377: struct TerminalLineView: View {
378:     let line: TerminalLine
379:     @ObservedObject private var themeManager = ThemeManager.shared
380:     
381:     var body: some View {
382:         if line.isANSI {
383:             ANSIText(line.text)
384:         } else {
385:             Text(line.text)
386:                 .font(.system(.body, design: .monospaced))
387:                 .foregroundColor(colorForType(line.type))
388:                 .textSelection(.enabled)
389:         }
390:     }
391:     
392:     func colorForType(_ type: LineType) -> Color {
393:         switch type {
394:         case .command: return themeManager.currentTheme.editorForeground
395:         case .output: return themeManager.currentTheme.editorForeground.opacity(0.9)
396:         case .error: return Color.red // Could use theme error color if available
397:         case .system: return themeManager.currentTheme.comment
398:         case .prompt: return themeManager.currentTheme.type
399:         }
400:     }
401: }
402: 
403: // MARK: - Terminal Workspace Manager
404: 
405: struct TerminalTab: Identifiable, Equatable {
406:     let id: UUID
407:     var panes: [TerminalManager]
408:     var activePaneId: UUID
409: 
410:     init(panes: [TerminalManager]) {
411:         self.id = UUID()
412:         self.panes = panes
413:         self.activePaneId = panes.first?.id ?? UUID()
414:     }
415: 
416:     var title: String {
417:         panes.first?.title ?? "Terminal"
418:     }
419: 
420:     static func == (lhs: TerminalTab, rhs: TerminalTab) -> Bool {
421:         lhs.id == rhs.id
422:     }
423: }
424: 
425: class TerminalWorkspace: ObservableObject {
426:     static let shared = TerminalWorkspace()
427: 
428:     @Published var tabs: [TerminalTab] = []
429:     @Published var activeTabId: UUID?
430: 
431:     var activeTabIndex: Int? {
432:         guard let id = activeTabId else { return nil }
433:         return tabs.firstIndex(where: { $0.id == id })
434:     }
435: 
436:     var activeTab: TerminalTab? {
437:         guard let idx = activeTabIndex else { return nil }
438:         return tabs[idx]
439:     }
440: 
441:     var activePane: TerminalManager? {
442:         guard let tab = activeTab else { return nil }
443:         return tab.panes.first(where: { $0.id == tab.activePaneId }) ?? tab.panes.first
444:     }
445: 
446:     init() {
447:         addTab() // start with one
448:     }
449: 
450:     func addTab() {
451:         let term = TerminalManager()
452:         term.title = "Terminal \(tabs.count + 1)"
453:         let tab = TerminalTab(panes: [term])
454:         tabs.append(tab)
455:         activeTabId = tab.id
456:     }
457: 
458:     func closeTab(id: UUID) {
459:         guard let idx = tabs.firstIndex(where: { $0.id == id }) else { return }
460:         for pane in tabs[idx].panes {
461:             pane.disconnect()
462:         }
463:         tabs.remove(at: idx)
464:         if activeTabId == id {
465:             activeTabId = tabs.last?.id
466:         }
467:     }
468: 
469:     func setActivePane(_ paneId: UUID, in tabId: UUID) {
470:         guard let tabIndex = tabs.firstIndex(where: { $0.id == tabId }) else { return }
471:         tabs[tabIndex].activePaneId = paneId
472:     }
473: 
474:     func toggleSplitActiveTab() {
475:         guard let tabId = activeTabId else { return }
476:         guard let idx = tabs.firstIndex(where: { $0.id == tabId }) else { return }
477: 
478:         if tabs[idx].panes.count <= 1 {
479:             // Split: add a second pane (max 2 panes for now)
480:             let newPane = TerminalManager()
481:             newPane.title = "Terminal \(tabs.count).2"
482:             tabs[idx].panes.append(newPane)
483:             tabs[idx].activePaneId = newPane.id
484:         } else {
485:             // Unsplit: remove all panes except the first
486:             let extraPanes = tabs[idx].panes.dropFirst()
487:             for pane in extraPanes {
488:                 pane.disconnect()
489:             }
490:             tabs[idx].panes = Array(tabs[idx].panes.prefix(1))
491:             tabs[idx].activePaneId = tabs[idx].panes.first?.id ?? tabs[idx].activePaneId
492:         }
493:     }
494: 
495:     func killActive() {
496:         guard let tabId = activeTabId else { return }
497:         guard let tabIndex = tabs.firstIndex(where: { $0.id == tabId }) else { return }
498: 
499:         let paneId = tabs[tabIndex].activePaneId
500:         if tabs[tabIndex].panes.count > 1 {
501:             // If split, kill the active pane only.
502:             if let paneIndex = tabs[tabIndex].panes.firstIndex(where: { $0.id == paneId }) {
503:                 tabs[tabIndex].panes[paneIndex].disconnect()
504:                 tabs[tabIndex].panes.remove(at: paneIndex)
505:             }
506:             tabs[tabIndex].activePaneId = tabs[tabIndex].panes.first?.id ?? tabs[tabIndex].activePaneId
507: 
508:             if tabs[tabIndex].panes.isEmpty {
509:                 closeTab(id: tabId)
510:             }
511:         } else {
512:             // If not split, kill the tab.
513:             closeTab(id: tabId)
514:         }
515:     }
516: }
517: 
518: // MARK: - Terminal Manager
519: 
520: class TerminalManager: ObservableObject, Identifiable {
521:     let id = UUID()
522:     @Published var title: String = "Terminal"
523:     
524:     @Published var output: [TerminalLine] = [
525:         TerminalLine(text: "VSCode iPadOS Terminal v2.0", type: .system),
526:         TerminalLine(text: "Type 'help' for commands or connect via SSH (SwiftNIO).", type: .system),
527:         TerminalLine(text: "", type: .output)
528:     ]
529:     @Published var isConnected = false
530:     @Published var isConnecting = false
531:     @Published var connectionStatus = "Not connected"
532:     @Published var promptString = "$ "
533:     @Published var draftCommand: String = ""
534:     
535:     private var sshManager: SSHManager?
536:     private var currentConfig: SSHConnectionConfig?
537:     private var commandHistory: [String] = []
538:     private var historyIndex = 0
539:     
540:     func clear() {
541:         output = []
542:     }
543:     
544:     func connect(to config: SSHConnectionConfig) {
545:         currentConfig = config
546:         isConnecting = true
547:         connectionStatus = "Connecting to \(config.host)..."
548:         title = "\(config.username)@\(config.host)"
549:         
550:         appendOutput("Connecting to \(config.username)@\(config.host):\(config.port)...", type: .system)
551:         appendOutput("Using SwiftNIO SSH (real SSH protocol)", type: .system)
552:         
553:         sshManager = SSHManager()
554:         sshManager?.delegate = self
555:         sshManager?.connect(config: config) { [weak self] result in
556:             switch result {
557:             case .success:
558:                 // Connection successful - delegate will handle UI update
559:                 SSHConnectionStore.shared.updateLastUsed(config)
560:             case .failure(let error):
561:                 self?.appendOutput("Connection failed: \(error.localizedDescription)", type: .error)
562:                 self?.isConnecting = false
563:                 self?.connectionStatus = "Connection failed"
564:             }
565:         }
566:     }
567:     
568:     // Legacy connect method for backward compatibility
569:     func connect(to connection: SSHConnection) {
570:         let authMethod: SSHConnectionConfig.SSHAuthMethod
571:         if let privateKey = connection.privateKey, !privateKey.isEmpty {
572:             authMethod = .privateKey(key: privateKey, passphrase: nil)
573:         } else {
574:             authMethod = .password(connection.password ?? "")
575:         }
576:         
577:         let config = SSHConnectionConfig(
578:             name: "\(connection.username)@\(connection.host)",
579:             host: connection.host,
580:             port: connection.port,
581:             username: connection.username,
582:             authMethod: authMethod
583:         )
584:         connect(to: config)
585:     }
586:     
587:     func disconnect() {
588:         sshManager?.disconnect()
589:         sshManager = nil
590:         isConnected = false
591:         isConnecting = false
592:         connectionStatus = "Disconnected"
593:         promptString = "$ "
594:         title = "Terminal (Disconnected)"
595:         appendOutput("Disconnected from server.", type: .system)
596:     }
597:     
598:     func executeCommand(_ command: String) {
599:         commandHistory.append(command)
600:         historyIndex = commandHistory.count
601:         
602:         if isConnected {
603:             // Don't echo command - server will echo it back
604:             sshManager?.send(command: command)
605:         } else {
606:             appendOutput(promptString + command, type: .command)
607:             processLocalCommand(command)
608:         }
609:     }
610:     
611:     func sendInterrupt() {
612:         if isConnected {
613:             sshManager?.sendInterrupt()
614:         }
615:         appendOutput("^C", type: .system)
616:     }
617:     
618:     func sendTab() {
619:         if isConnected {
620:             sshManager?.sendTab()
621:         }
622:     }
623:     
624:     func sendEscape() {
625:         sshManager?.sendEscape()
626:     }
627:     
628:     func previousCommand() -> String? {
629:         guard !commandHistory.isEmpty else { return nil }
630:         historyIndex = max(0, historyIndex - 1)
631:         return commandHistory[historyIndex]
632:     }
633:     
634:     func nextCommand() -> String? {
635:         guard !commandHistory.isEmpty else { return nil }
636:         historyIndex = min(commandHistory.count, historyIndex + 1)
637:         if historyIndex >= commandHistory.count {
638:             return ""
639:         }
640:         return commandHistory[historyIndex]
641:     }
642:     
643:     private func processLocalCommand(_ command: String) {
644:         let parts = command.split(separator: " ", maxSplits: 1)
645:         guard let cmd = parts.first?.lowercased() else { return }
646:         
647:         switch cmd {
648:         case "help":
649:             appendOutput("""
650:             Local Commands:
651:               help              - Show this help
652:               clear             - Clear terminal
653:               echo <text>       - Echo text
654:               date              - Show current date
655:               whoami            - Show current user
656:               history           - Show command history
657:               ssh               - Show SSH connection info
658:             
659:             Connect via SSH using the network button in toolbar.
660:             Real SSH protocol powered by SwiftNIO SSH.
661:             """, type: .output)
662:             
663:         case "clear":
664:             clear()
665:             
666:         case "echo":
667:             let text = parts.count > 1 ? String(parts[1]) : ""
668:             appendOutput(text, type: .output)
669:             
670:         case "date":
671:             appendOutput(Date().description, type: .output)
672:             
673:         case "whoami":
674:             appendOutput("ipad-user", type: .output)
675:             
676:         case "history":
677:             for (index, cmd) in commandHistory.enumerated() {
678:                 appendOutput("  \(index + 1)  \(cmd)", type: .output)
679:             }
680:             
681:         case "ssh":
682:             appendOutput("""
683:             SSH Status: \(isConnected ? "Connected" : "Not connected")
684:             Implementation: SwiftNIO SSH (apple/swift-nio-ssh)
685:             Features: Password auth, Key auth, PTY support, Shell sessions
686:             """, type: .output)
687:             
688:         default:
689:             appendOutput("\(cmd): command not found (local mode)", type: .error)
690:         }
691:     }
692:     
693:     func appendOutput(_ text: String, type: LineType, isANSI: Bool = false) {
694:         DispatchQueue.main.async {
695:             // Split multi-line output into separate lines
696:             let lines = text.components(separatedBy: .newlines)
697:             for line in lines {
698:                 if !line.isEmpty || lines.count == 1 {
699:                     self.output.append(TerminalLine(text: line, type: type, isANSI: isANSI || line.contains("\u{1B}")))
700:                 }
701:             }
702:         }
703:     }
704: }
705: 
706: // MARK: - SSH Manager Delegate
707: extension TerminalManager: SSHManagerDelegate {
708:     func sshManagerDidConnect(_ manager: SSHManager) {
709:         DispatchQueue.main.async {
710:             self.isConnected = true
711:             self.isConnecting = false
712:             self.connectionStatus = "Connected"
713:             self.promptString = "" // Shell will provide prompt
714:             self.appendOutput("Connected successfully via SwiftNIO SSH!", type: .system)
715:         }
716:     }
717:     
718:     func sshManagerDidDisconnect(_ manager: SSHManager, error: Error?) {
719:         DispatchQueue.main.async {
720:             self.isConnected = false
721:             self.isConnecting = false
722:             self.connectionStatus = "Disconnected"
723:             self.promptString = "$ "
724:             if let error = error {
725:                 self.appendOutput("Connection lost: \(error.localizedDescription)", type: .error)
726:             }
727:         }
728:     }
729:     
730:     func sshManager(_ manager: SSHManager, didReceiveOutput text: String) {
731:         appendOutput(text, type: .output)
732:     }
733:     
734:     func sshManager(_ manager: SSHManager, didReceiveError text: String) {
735:         appendOutput(text, type: .error)
736:     }
737: }
738: 
739: // MARK: - SSH Connection View (Enhanced with Saved Connections)
740: 
741: struct SSHConnectionView: View {
742:     @ObservedObject var terminal: TerminalManager
743:     @Binding var isPresented: Bool
744:     @ObservedObject private var connectionStore = SSHConnectionStore.shared
745:     @ObservedObject private var themeManager = ThemeManager.shared
746:     
747:     @State private var connectionName = ""
748:     @State private var host = ""
749:     @State private var port = "22"
750:     @State private var username = ""
751:     @State private var password = ""
752:     @State private var useKey = false
753:     @State private var privateKey = ""
754:     @State private var keyPassphrase = ""
755:     @State private var saveConnection = true
756:     @State private var showSavedConnections = true
757:     @State private var errorMessage: String?
758:     
759:     var body: some View {
760:         NavigationView {
761:             Form {
762:                 // Saved Connections Section
763:                 if !connectionStore.savedConnections.isEmpty {
764:                     Section(header: Text("Saved Connections")) {
765:                         ForEach(connectionStore.savedConnections) { config in
766:                             Button(action: { connectToSaved(config) }) {
767:                                 HStack {
768:                                     VStack(alignment: .leading, spacing: 2) {
769:                                         Text(config.name)
770:                                             .font(.headline)
771:                                             .foregroundColor(themeManager.currentTheme.editorForeground)
772:                                         Text("\(config.username)@\(config.host):\(config.port)")
773:                                             .font(.caption)
774:                                             .foregroundColor(themeManager.currentTheme.comment)
775:                                     }
776:                                     Spacer()
777:                                     if case .privateKey = config.authMethod {
778:                                         Image(systemName: "key.fill")
779:                                             .foregroundColor(.orange)
780:                                     } else {
781:                                         Image(systemName: "lock.fill")
782:                                             .foregroundColor(.blue)
783:                                     }
784:                                 }
785:                             }
786:                             .swipeActions(edge: .trailing, allowsFullSwipe: true) {
787:                                 Button(role: .destructive) {
788:                                     connectionStore.delete(config)
789:                                 } label: {
790:                                     Label("Delete", systemImage: "trash")
791:                                 }
792:                             }
793:                         }
794:                     }
795:                 }
796:                 
797:                 // New Connection Section
798:                 Section(header: Text("New Connection")) {
799:                     TextField("Connection Name (optional)", text: $connectionName)
800:                         .autocapitalization(.none)
801:                     
802:                     TextField("Host", text: $host)
803:                         .autocapitalization(.none)
804:                         .disableAutocorrection(true)
805:                         .keyboardType(.URL)
806:                     
807:                     TextField("Port", text: $port)
808:                         .keyboardType(.numberPad)
809:                     
810:                     TextField("Username", text: $username)
811:                         .autocapitalization(.none)
812:                         .disableAutocorrection(true)
813:                 }
814:                 
815:                 Section(header: Text("Authentication")) {
816:                     Picker("Method", selection: $useKey) {
817:                         Text("Password").tag(false)
818:                         Text("SSH Key").tag(true)
819:                     }
820:                     .pickerStyle(.segmented)
821:                     
822:                     if useKey {
823:                         VStack(alignment: .leading, spacing: 8) {
824:                             Text("Private Key (PEM format)")
825:                                 .font(.caption)
826:                                 .foregroundColor(themeManager.currentTheme.comment)
827:                             
828:                             TextEditor(text: $privateKey)
829:                                 .font(.system(.caption, design: .monospaced))
830:                                 .frame(height: 120)
831:                                 .overlay(
832:                                     RoundedRectangle(cornerRadius: 8)
833:                                         .stroke(themeManager.currentTheme.editorForeground.opacity(0.2), lineWidth: 1)
834:                                 )
835:                             
836:                             SecureField("Key Passphrase (if encrypted)", text: $keyPassphrase)
837:                         }
838:                     } else {
839:                         SecureField("Password", text: $password)
840:                     }
841:                 }
842:                 
843:                 Section {
844:                     Toggle("Save Connection", isOn: $saveConnection)
845:                 }
846:                 
847:                 if let error = errorMessage {
848:                     Section {
849:                         Text(error)
850:                             .foregroundColor(.red)
851:                             .font(.caption)
852:                     }
853:                 }
854:                 
855:                 Section {
856:                     Button(action: connect) {
857:                         HStack {
858:                             Spacer()
859:                             if terminal.isConnecting {
860:                                 ProgressView()
861:                                     .progressViewStyle(CircularProgressViewStyle())
862:                                 Text("Connecting...")
863:                             } else {
864:                                 Image(systemName: "network")
865:                                 Text("Connect")
866:                             }
867:                             Spacer()
868:                         }
869:                     }
870:                     .disabled(host.isEmpty || username.isEmpty || terminal.isConnecting)
871:                 }
872:             }
873:             .navigationTitle("SSH Connection")
874:             .toolbar {
875:                 ToolbarItem(placement: .cancellationAction) {
876:                     Button("Cancel") { isPresented = false }
877:                 }
878:             }
879:         }
880:     }
881:     
882:     private func connectToSaved(_ config: SSHConnectionConfig) {
883:         terminal.connect(to: config)
884:         isPresented = false
885:     }
886:     
887:     private func connect() {
888:         errorMessage = nil
889:         
890:         let authMethod: SSHConnectionConfig.SSHAuthMethod
891:         if useKey {
892:             guard !privateKey.isEmpty else {
893:                 errorMessage = "Please enter your private key"
894:                 return
895:             }
896:             authMethod = .privateKey(key: privateKey, passphrase: keyPassphrase.isEmpty ? nil : keyPassphrase)
897:         } else {
898:             guard !password.isEmpty else {
899:                 errorMessage = "Please enter your password"
900:                 return
901:             }
902:             authMethod = .password(password)
903:         }
904:         
905:         let name = connectionName.isEmpty ? "\(username)@\(host)" : connectionName
906:         
907:         let config = SSHConnectionConfig(
908:             name: name,
909:             host: host,
910:             port: Int(port) ?? 22,
911:             username: username,
912:             authMethod: authMethod
913:         )
914:         
915:         if saveConnection {
916:             connectionStore.save(config)
917:         }
918:         
919:         terminal.connect(to: config)
920:         isPresented = false
921:     }
922: }
923: 
924: // MARK: - Models & Helpers (Legacy support)
925: 
926: struct SSHConnection {
927:     let host: String
928:     let port: Int
929:     let username: String
930:     let password: String?
931:     let privateKey: String?
932: }
933: 
934: struct TerminalLine: Identifiable {
935:     let id = UUID()
936:     let text: String
937:     let type: LineType
938:     var isANSI: Bool = false
939: }
940: 
941: enum LineType {
942:     case command
943:     case output
944:     case error
945:     case system
946:     case prompt
947: }
948: 
949: struct ANSIText: View {
950:     let text: String
951:     @ObservedObject private var themeManager = ThemeManager.shared
952:     
953:     init(_ text: String) {
954:         self.text = text
955:     }
956:     
957:     var body: some View {
958:         Text(stripANSI(text))
959:             .font(.system(.body, design: .monospaced))
960:             .foregroundColor(themeManager.currentTheme.editorForeground)
961:             .textSelection(.enabled)
962:     }
963:     
964:     private func stripANSI(_ text: String) -> String {
965:         let pattern = "\u{1B}\\[[0-9;]*[a-zA-Z]"
966:         guard let regex = try? NSRegularExpression(pattern: pattern) else { return text }
967:         let range = NSRange(text.startIndex..., in: text)
968:         return regex.stringByReplacingMatches(in: text, range: range, withTemplate: "")
969:     }
970: }
971: 
972: // MARK: - SSH Client Implementation
973: // Real SSH implementation is now in Services/SSHManager.swift
974: // Uses SwiftNIO SSH (apple/swift-nio-ssh) for proper SSH protocol support
975: // Features:
976: // - Password authentication
977: // - SSH key authentication (Ed25519, ECDSA)
978: // - PTY allocation for interactive shells
979: // - Proper channel management
980: // - Terminal resize support
981: 


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Panels/OutputView.swift"}
>>>END

---

## üîß TOOL RESULTS

[read_file]
File: VSCodeiPadOS/VSCodeiPadOS/Views/Panels/OutputView.swift (lines 1-393 of 393)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
1: import SwiftUI
2: 
3: // MARK: - Output Line View
4: 
5: /// Renders a single output line with ANSI color support and stream type styling
6: struct OutputLineView: View {
7:     let line: OutputLine
8:     let showTimestamp: Bool
9:     let wordWrap: Bool
10:     
11:     @State private var attributedString: AttributedString?
12:     
13:     var body: some View {
14:         HStack(alignment: .top, spacing: 4) {
15:             // Stream type indicator
16:             streamTypeIndicator
17:             
18:             // Timestamp (if enabled)
19:             if showTimestamp {
20:                 timestampView
21:             }
22:             
23:             // Content with ANSI color support
24:             contentView
25:         }
26:         .frame(maxWidth: .infinity, alignment: .leading)
27:         .id(line.id)
28:     }
29:     
30:     @ViewBuilder
31:     private var streamTypeIndicator: some View {
32:         switch line.streamType {
33:         case .stdout:
34:             Image(systemName: "arrow.right")
35:                 .font(.system(size: 8))
36:                 .foregroundColor(.blue)
37:                 .frame(width: 12)
38:         case .stderr:
39:             Image(systemName: "exclamationmark.triangle.fill")
40:                 .font(.system(size: 8))
41:                 .foregroundColor(.orange)
42:                 .frame(width: 12)
43:         }
44:     }
45:     
46:     @ViewBuilder
47:     private var timestampView: some View {
48:         Text(formatTimestamp(line.timestamp))
49:             .font(.system(size: 10, design: .monospaced))
50:             .foregroundColor(.secondary)
51:     }
52:     
53:     @ViewBuilder
54:     private var contentView: some View {
55:         if line.isAnsiFormatted, let attributes = line.ansiAttributes {
56:             // Render with ANSI colors
57:             ansiAttributedText(attributes: attributes)
58:         } else {
59:             // Plain text with stream type color
60:             Text(line.text)
61:                 .font(.system(size: 12, design: .monospaced))
62:                 .foregroundColor(textColor)
63:                 .lineLimit(wordWrap ? nil : 1)
64:         }
65:     }
66:     
67:     private var textColor: Color {
68:         switch line.streamType {
69:         case .stdout: return .primary
70:         case .stderr: return .orange
71:         }
72:     }
73:     
74:     private func formatTimestamp(_ date: Date) -> String {
75:         let formatter = DateFormatter()
76:         formatter.timeStyle = .medium
77:         return formatter.string(from: date)
78:     }
79:     
80:     /// Creates SwiftUI AttributedString from ANSI attributes
81:     private func ansiAttributedText(attributes: [NSRange: [NSAttributedString.Key: Any]]) -> some View {
82:         var result = AttributedString(line.text)
83:         
84:         for (range, attrs) in attributes {
85:             guard let swiftRange = Range(range, in: line.text) else { continue }
86:             let attrRange = AttributedString.Index(swiftRange.lowerBound, within: result)!..<AttributedString.Index(swiftRange.upperBound, within: result)!
87:             
88:             var container = AttributeContainer()
89:             
90:             if let color = attrs[.foregroundColor] as? Color {
91:                 container.foregroundColor = color
92:             }
93:             if let bgColor = attrs[.backgroundColor] as? Color {
94:                 container.backgroundColor = bgColor
95:             }
96:             if let font = attrs[.font] as? Font {
97:                 container.font = font
98:             }
99:             
100:             result[attrRange].setAttributes(container)
101:         }
102:         
103:         return Text(result)
104:             .font(.system(size: 12, design: .monospaced))
105:             .lineLimit(wordWrap ? nil : 1)
106:     }
107: }
108: 
109: // MARK: - Progress Indicator View
110: 
111: struct RemoteProgressView: View {
112:     @ObservedObject var outputManager = OutputPanelManager.shared
113:     
114:     var body: some View {
115:         if outputManager.remoteExecutionStatus.isRunning {
116:             VStack(spacing: 8) {
117:                 HStack(spacing: 12) {
118:                     ProgressView()
119:                         .progressViewStyle(CircularProgressViewStyle(tint: .purple))
120:                         .scaleEffect(0.8)
121:                     
122:                     VStack(alignment: .leading, spacing: 2) {
123:                         if let command = outputManager.remoteExecutionStatus.command {
124:                             Text(command)
125:                                 .font(.system(size: 12, weight: .medium))
126:                                 .foregroundColor(.primary)
127:                                 .lineLimit(1)
128:                         }
129:                         
130:                         if let message = outputManager.remoteExecutionStatus.progressMessage {
131:                             Text(message)
132:                                 .font(.system(size: 11))
133:                                 .foregroundColor(.secondary)
134:                                 .lineLimit(1)
135:                         }
136:                         
137:                         if let startTime = outputManager.remoteExecutionStatus.startTime {
138:                             Text("Running for \(Int(Date().timeIntervalSince(startTime)))s")
139:                                 .font(.system(size: 10))
140:                                 .foregroundColor(.secondary)
141:                                 .monospacedDigit()
142:                         }
143:                     }
144:                     
145:                     Spacer()
146:                     
147:                     Button(action: {
148:                         // Cancel action would go here
149:                     }) {
150:                         Image(systemName: "xmark.circle.fill")
151:                             .font(.system(size: 16))
152:                             .foregroundColor(.secondary)
153:                     }
154:                     .help("Cancel remote execution")
155:                 }
156:                 .padding(.horizontal, 12)
157:                 .padding(.vertical, 8)
158:             }
159:             .background(Color.purple.opacity(0.1))
160:             .overlay(
161:                 HStack(spacing: 0) {
162:                     Rectangle()
163:                         .fill(Color.purple)
164:                         .frame(width: 3)
165:                     Spacer()
166:                 }
167:             )
168:         }
169:     }
170: }
171: 
172: // MARK: - Search Bar View
173: 
174: struct OutputSearchBar: View {
175:     @ObservedObject var outputManager = OutputPanelManager.shared
176:     @State private var localQuery: String = ""
177:     
178:     var body: some View {
179:         HStack(spacing: 8) {
180:             Image(systemName: "magnifyingglass")
181:                 .font(.system(size: 12))
182:                 .foregroundColor(.secondary)
183:             
184:             TextField("Search output...", text: $localQuery)
185:                 .font(.system(size: 12))
186:                 .textFieldStyle(.plain)
187:                 .onChange(of: localQuery) { newValue in
188:                     outputManager.setSearchQuery(newValue)
189:                 }
190:             
191:             if !localQuery.isEmpty {
192:                 Button(action: {
193:                     localQuery = ""
194:                     outputManager.clearFilter()
195:                 }) {
196:                     Image(systemName: "xmark.circle.fill")
197:                         .font(.system(size: 12))
198:                         .foregroundColor(.secondary)
199:                 }
200:                 .buttonStyle(.plain)
201:             }
202:             
203:             let stats = outputManager.filterStats(for: outputManager.selectedChannel)
204:             if stats.filtered != stats.total {
205:                 Text("\(stats.filtered)/\(stats.total)")
206:                     .font(.system(size: 10))
207:                     .foregroundColor(.secondary)
208:             }
209:         }
210:         .padding(.horizontal, 8)
211:         .padding(.vertical, 4)
212:         .background(Color(UIColor.tertiarySystemFill))
213:         .cornerRadius(6)
214:     }
215: }
216: 
217: // MARK: - Main Output View
218: 
219: struct OutputView: View {
220:     @ObservedObject private var outputManager = OutputPanelManager.shared
221:     @State private var showingSearchBar: Bool = false
222: 
223:     var body: some View {
224:         VStack(spacing: 0) {
225:             // Remote execution progress indicator
226:             if outputManager.selectedChannel == .remote {
227:                 RemoteProgressView()
228:                 Divider()
229:             }
230:             
231:             // Main header with controls
232:             header
233:             
234:             Divider()
235:             
236:             // Optional search bar
237:             if showingSearchBar {
238:                 searchBarSection
239:                 Divider()
240:             }
241:             
242:             // Output content
243:             outputBody
244:         }
245:         .background(Color(UIColor.systemBackground))
246:     }
247: 
248:     private var header: some View {
249:         HStack(spacing: 12) {
250:             // Channel selector
251:             Menu {
252:                 ForEach(OutputChannel.allCases) { channel in
253:                     Button(action: {
254:                         outputManager.selectedChannel = channel
255:                     }) {
256:                         HStack {
257:                             Image(systemName: channel.icon)
258:                             Text(channel.rawValue)
259:                             Spacer()
260:                             if outputManager.selectedChannel == channel {
261:                                 Image(systemName: "checkmark")
262:                                     .font(.system(size: 10))
263:                             }
264:                         }
265:                     }
266:                 }
267:             } label: {
268:                 HStack(spacing: 4) {
269:                     Image(systemName: outputManager.selectedChannel.icon)
270:                         .font(.system(size: 10))
271:                         .foregroundColor(outputManager.selectedChannel.color)
272:                     Text(outputManager.selectedChannel.rawValue)
273:                         .font(.system(size: 11))
274:                         .foregroundColor(.primary)
275:                     Image(systemName: "chevron.down")
276:                         .font(.system(size: 8))
277:                         .foregroundColor(.secondary)
278:                 }
279:                 .padding(.horizontal, 8)
280:                 .padding(.vertical, 4)
281:                 .background(Color(UIColor.tertiarySystemFill))
282:                 .cornerRadius(4)
283:             }
284:             
285:             Spacer()
286:             
287:             // Search toggle
288:             Button(action: {
289:                 withAnimation(.easeInOut(duration: 0.15)) {
290:                     showingSearchBar.toggle()
291:                     if !showingSearchBar {
292:                         outputManager.clearFilter()
293:                     }
294:                 }
295:             }) {
296:                 Image(systemName: "magnifyingglass")
297:                     .font(.system(size: 12))
298:                     .foregroundColor(showingSearchBar ? .blue : .secondary)
299:             }
300:             .help("Search in output")
301:             
302:             // Word wrap toggle
303:             Button(action: {
304:                 outputManager.toggleWordWrap()
305:             }) {
306:                 Image(systemName: outputManager.wordWrapEnabled ? "text.wrap" : "text.badge.xmark")
307:                     .font(.system(size: 12))
308:                     .foregroundColor(outputManager.wordWrapEnabled ? .blue : .secondary)
309:             }
310:             .help("Toggle word wrap")
311:             
312:             // Timestamp toggle
313:             Button(action: {
314:                 outputManager.toggleTimestamps()
315:             }) {
316:                 Image(systemName: outputManager.showTimestamps ? "clock.fill" : "clock")
317:                     .font(.system(size: 12))
318:                     .foregroundColor(outputManager.showTimestamps ? .blue : .secondary)
319:             }
320:             .help("Show timestamps")
321:             
322:             // Auto-scroll toggle
323:             Button(action: {
324:                 outputManager.toggleAutoScroll()
325:             }) {
326:                 Image(systemName: outputManager.isAutoScrollEnabled ? "lock.open.fill" : "lock")
327:                     .font(.system(size: 12))
328:                     .foregroundColor(outputManager.isAutoScrollEnabled ? .blue : .secondary)
329:             }
330:             .help("Auto-scroll")
331:             
332:             Divider()
333:                 .frame(height: 16)
334:             
335:             // Clear button
336:             Button(action: { outputManager.clear(outputManager.selectedChannel) }) {
337:                 Image(systemName: "trash")
338:                     .font(.system(size: 12))
339:                     .foregroundColor(.secondary)
340:             }
341:             .help("Clear Output")
342:         }
343:         .padding(6)
344:         .background(Color(UIColor.secondarySystemBackground))
345:     }
346:     
347:     private var searchBarSection: some View {
348:         HStack {
349:             OutputSearchBar()
350:         }
351:         .padding(.horizontal, 8)
352:         .padding(.vertical, 4)
353:         .background(Color(UIColor.secondarySystemBackground))
354:     }
355: 
356:     private var outputBody: some View {
357:         let channel = outputManager.selectedChannel
358:         let lines = outputManager.lines(for: channel)
359: 
360:         return ScrollViewReader { proxy in
361:             ScrollView {
362:                 LazyVStack(alignment: .leading, spacing: 2) {
363:                     ForEach(lines) { line in
364:                         OutputLineView(
365:                             line: line,
366:                             showTimestamp: outputManager.showTimestamps,
367:                             wordWrap: outputManager.wordWrapEnabled
368:                         )
369:                         .padding(.vertical, 1)
370:                     }
371:                 }
372:                 .padding(8)
373:                 .frame(maxWidth: .infinity, alignment: .leading)
374:             }
375:             .onChange(of: lines.count) { _ in
376:                 guard !lines.isEmpty && outputManager.isAutoScrollEnabled else { return }
377:                 withAnimation(.easeOut(duration: 0.1)) {
378:                     if let lastLine = lines.last {
379:                         proxy.scrollTo(lastLine.id, anchor: .bottom)
380:                     }
381:                 }
382:             }
383:         }
384:     }
385: }
386: 
387: // MARK: - Preview
388: 
389: #Preview {
390:     OutputView()
391:         .frame(height: 400)
392: }
393: 


>>>TOOL list_dir
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views"}
>>>END

---

## üîß TOOL RESULTS

[list_dir]
üìÅ VSCodeiPadOS/VSCodeiPadOS/Views/
üìÅ Editor/
üìÅ Panels/
   _tmp.txt
   BranchMenu.swift
   CommandPalette.swift
   CommandPaletteView.swift
   DiffComponents.swift
   FileIconView.swift
   FileTreeView.swift
   GoToSymbol.swift
   LaunchConfigView.swift
   QuickOpen.swift
   RunConfigView.swift
   SidebarView.swift
   SnippetPickerView.swift
   StatusBarView.swift
   TabBarView.swift
   TasksView.swift
   WorkspaceSettingsView.swift
   WorkspaceTrustDialog.swift


‚ùå API Error (iteration 69): terminated
