# Agent: diff-ui-gemini3
**Status:** done
**Tokens:** 33,802
**Cost:** $0.0000
**Time:** 2026-02-09T10:45:12.808Z

## Task
Design/implement diff viewer UI components (inline and side-by-side) for SwiftUI, including styling for additions/deletions and hunk headers. Integrate with GitView by providing views/models.

## Response
>>>TOOL list_dir
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views"}
>>>END
>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Panels/GitView.swift"}
>>>END


>>>TOOL list_dir
{"path": "VSCodeiPadOS/VSCodeiPadOS"}
>>>END


>>>TOOL list_dir
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views"}
>>>END

>>>TOOL list_dir
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Panels"}
>>>END

>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Panels/GitView.swift"}
>>>END

>>>TOOL list_dir
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Editor"}
>>>END

>>>TOOL list_dir
{"path": "VSCodeiPadOS/VSCodeiPadOS"}
>>>END

>>>TOOL create_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/DiffComponents.swift", "content": "import SwiftUI\n\n// MARK: - Models\n\nenum DiffLineType {\n    case context\n    case addition\n    case deletion\n    case header\n}\n\nstruct DiffLine: Identifiable {\n    let id = UUID()\n    let type: DiffLineType\n    let content: String\n    let oldLineNumber: Int?\n    let newLineNumber: Int?\n}\n\nstruct DiffHunk: Identifiable {\n    let id = UUID()\n    let header: String\n    let lines: [DiffLine]\n}\n\nstruct DiffFile: Identifiable {\n    let id = UUID()\n    let fileName: String\n    let status: String\n    let hunks: [DiffHunk]\n}\n\nenum DiffViewMode {\n    case inline\n    case sideBySide\n}\n\n// MARK: - Inline Diff View\n\nstruct InlineDiffView: View {\n    let file: DiffFile\n    \n    var body: some View {\n        VStack(alignment: .leading, spacing: 0) {\n            ForEach(file.hunks) { hunk in\n                HunkHeaderView(text: hunk.header)\n                \n                ForEach(hunk.lines) { line in\n                    InlineDiffLineView(line: line)\n                }\n            }\n        }\n        .background(Color(UIColor.systemBackground))\n        .border(Color.gray.opacity(0.2))\n    }\n}\n\nstruct InlineDiffLineView: View {\n    let line: DiffLine\n    \n    var body: some View {\n        HStack(alignment: .top, spacing: 0) {\n            // Line Numbers\n            HStack(spacing: 0) {\n                Text(line.oldLineNumber.map(String.init) ?? \"\")\n                    .frame(width: 30, alignment: .trailing)\n                    .padding(.trailing, 4)\n                Text(line.newLineNumber.map(String.init) ?? \"\")\n                    .frame(width: 30, alignment: .trailing)\n                    .padding(.trailing, 4)\n            }\n            .font(.caption2)\n            .foregroundColor(.secondary)\n            .background(Color(UIColor.secondarySystemBackground))\n            \n            // Content\n            Text(line.content)\n                .font(.system(.caption, design: .monospaced))\n                .frame(maxWidth: .infinity, alignment: .leading)\n                .padding(.leading, 8)\n                .padding(.vertical, 1)\n        }\n        .background(backgroundColor)\n    }\n    \n    var backgroundColor: Color {\n        switch line.type {\n        case .addition: return Color.green.opacity(0.15)\n        case .deletion: return Color.red.opacity(0.15)\n        case .header: return Color.blue.opacity(0.1)\n        case .context: return Color.clear\n        }\n    }\n}\n\n// MARK: - Side By Side Diff View\n\nstruct SideBySideDiffView: View {\n    let file: DiffFile\n    \n    var body: some View {\n        VStack(alignment: .leading, spacing: 0) {\n            ForEach(file.hunks) { hunk in\n                HunkHeaderView(text: hunk.header)\n                \n                ForEach(hunk.lines) { line in\n                    SideBySideDiffLineView(line: line)\n                }\n            }\n        }\n        .background(Color(UIColor.systemBackground))\n        .border(Color.gray.opacity(0.2))\n    }\n}\n\nstruct SideBySideDiffLineView: View {\n    let line: DiffLine\n    \n    var body: some View {\n        HStack(spacing: 0) {\n            // Left Column (Old)\n            HStack(spacing: 0) {\n                if line.type != .addition {\n                    Text(line.oldLineNumber.map(String.init) ?? \"\")\n                        .font(.caption2)\n                        .foregroundColor(.secondary)\n                        .frame(width: 30, alignment: .trailing)\n                        .padding(.trailing, 4)\n                        .background(Color(UIColor.secondarySystemBackground))\n                    \n                    Text(line.content)\n                        .font(.system(.caption, design: .monospaced))\n                        .frame(maxWidth: .infinity, alignment: .leading)\n                        .padding(.leading, 4)\n                } else {\n                    Spacer()\n                }\n            }\n            .frame(maxWidth: .infinity)\n            .background(leftBackgroundColor)\n            \n            Divider()\n            \n            // Right Column (New)\n            HStack(spacing: 0) {\n                if line.type != .deletion {\n                    Text(line.newLineNumber.map(String.init) ?? \"\")\n                        .font(.caption2)\n                        .foregroundColor(.secondary)\n                        .frame(width: 30, alignment: .trailing)\n                        .padding(.trailing, 4)\n                        .background(Color(UIColor.secondarySystemBackground))\n                    \n                    Text(line.content)\n                        .font(.system(.caption, design: .monospaced))\n                        .frame(maxWidth: .infinity, alignment: .leading)\n                        .padding(.leading, 4)\n                } else {\n                    Spacer()\n                }\n            }\n            .frame(maxWidth: .infinity)\n            .background(rightBackgroundColor)\n        }\n        .fixedSize(horizontal: false, vertical: true)\n    }\n    \n    var leftBackgroundColor: Color {\n        if line.type == .deletion { return Color.red.opacity(0.15) }\n        if line.type == .addition { return Color(UIColor.systemGray6) }\n        return Color.clear\n    }\n    \n    var rightBackgroundColor: Color {\n        if line.type == .addition { return Color.green.opacity(0.15) }\n        if line.type == .deletion { return Color(UIColor.systemGray6) }\n        return Color.clear\n    }\n}\n\n// MARK: - Shared Components\n\nstruct HunkHeaderView: View {\n    let text: String\n    \n    var body: some View {\n        Text(text)\n            .font(.caption)\n            .padding(.vertical, 4)\n            .padding(.horizontal)\n            .frame(maxWidth: .infinity, alignment: .leading)\n            .background(Color.blue.opacity(0.1))\n            .foregroundColor(.blue)\n    }\n}\n\n// MARK: - Previews\n\nstruct DiffComponents_Previews: PreviewProvider {\n    static var previews: some View {\n        let sampleLines = [\n            DiffLine(type: .context, content: \"import SwiftUI\", oldLineNumber: 1, newLineNumber: 1),\n            DiffLine(type: .deletion, content: \"struct OldView: View {\", oldLineNumber: 2, newLineNumber: nil),\n            DiffLine(type: .addition, content: \"struct NewView: View {\", oldLineNumber: nil, newLineNumber: 2),\n            DiffLine(type: .context, content: \"    var body: some View {\", oldLineNumber: 3, newLineNumber: 3)\n        ]\n        let hunk = DiffHunk(header: \"@@ -1,3 +1,3 @@\", lines: sampleLines)\n        let file = DiffFile(fileName: \"ContentView.swift\", status: \"modified\", hunks: [hunk])\n        \n        VStack(spacing: 20) {\n            Text(\"Inline\")\n            InlineDiffView(file: file)\n            \n            Text(\"Side by Side\")\n            SideBySideDiffView(file: file)\n        }\n        .padding()\n    }\n}\n"}
>>>END


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Panels/GitView.swift"}
>>>END



>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Panels/GitView.swift"}
>>>END

>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/DiffComponents.swift"}
>>>END

>>>TOOL create_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Panels/GitView.swift", "content": "import SwiftUI\n\nstruct GitView: View {\n    @State private var commitMessage = \"\"\n    @State private var branchInfo = \"On branch main\"\n    @State private var changedFiles: [DiffFile] = []\n    @State private var isLoading = false\n    @State private var selectedFile: DiffFile?\n    @State private var diffMode: DiffViewMode = .inline\n    \n    var body: some View {\n        VStack(alignment: .leading, spacing: 20) {\n            // Header\n            HStack {\n                Image(systemName: \"arrow.triangle.branch\")\n                    .font(.title2)\n                Text(\"Source Control\")\n                    .font(.title2)\n                    .fontWeight(.semibold)\n                Spacer()\n            }\n            .padding(.horizontal)\n            .padding(.top)\n            \n            // Git Status\n            VStack(alignment: .leading, spacing: 10) {\n                Text(\"STATUS\")\n                    .font(.caption)\n                    .foregroundColor(.secondary)\n                    .padding(.horizontal)\n                \n                Text(branchInfo)\n                    .font(.caption)\n                    .foregroundColor(.secondary)\n                    .padding(.horizontal)\n                \n                if changedFiles.isEmpty {\n                    Text(\"No changes detected\")\n                        .font(.callout)\n                        .foregroundColor(.secondary)\n                        .frame(maxWidth: .infinity, alignment: .leading)\n                        .padding()\n                        .background(Color(UIColor.secondarySystemBackground))\n                        .cornerRadius(8)\n                        .padding(.horizontal)\n                } else {\n                    List(changedFiles) { file in\n                        Button(action: { selectedFile = file }) {\n                            HStack {\n                                Image(systemName: \"doc.text\")\n                                    .foregroundColor(.blue)\n                                Text(file.fileName)\n                                    .foregroundColor(.primary)\n                                Spacer()\n                                Text(file.status)\n                                    .font(.caption)\n                                    .foregroundColor(.secondary)\n                                    .padding(.horizontal, 6)\n                                    .padding(.vertical, 2)\n                                    .background(Color.orange.opacity(0.1))\n                                    .cornerRadius(4)\n                            }\n                        }\n                    }\n                    .listStyle(.plain)\n                    .frame(maxHeight: 300)\n                    .padding(.horizontal)\n                }\n            }\n            \n            // Commit Section\n            VStack(alignment: .leading, spacing: 10) {\n                Text(\"COMMIT\")\n                    .font(.caption)\n                    .foregroundColor(.secondary)\n                    .padding(.horizontal)\n                \n                TextField(\"Commit message...\", text: $commitMessage)\n                    .textFieldStyle(RoundedBorderTextFieldStyle())\n                    .padding(.horizontal)\n                \n                HStack(spacing: 15) {\n                    Button(action: performCommit) {\n                        Label(\"Commit\", systemImage: \"checkmark.circle.fill\")\n                            .frame(maxWidth: .infinity)\n                    }\n                    .buttonStyle(.borderedProminent)\n                    .disabled(commitMessage.isEmpty || isLoading)\n                    \n                    Button(action: refreshStatus) {\n                        Label(\"Refresh\", systemImage: \"arrow.clockwise\")\n                    }\n                    .buttonStyle(.bordered)\n                    .disabled(isLoading)\n                }\n                .padding(.horizontal)\n            }\n            \n            Spacer()\n        }\n        .frame(maxWidth: .infinity, maxHeight: .infinity)\n        .background(Color(UIColor.systemBackground))\n        .onAppear {\n            refreshStatus()\n        }\n        .sheet(item: $selectedFile) { file in\n            NavigationView {\n                VStack(spacing: 0) {\n                    Picker(\"Mode\", selection: $diffMode) {\n                        Text(\"Inline\").tag(DiffViewMode.inline)\n                        Text(\"Side by Side\").tag(DiffViewMode.sideBySide)\n                    }\n                    .pickerStyle(.segmented)\n                    .padding()\n                    .background(Color(UIColor.secondarySystemBackground))\n                    \n                    ScrollView {\n                        if diffMode == .inline {\n                            InlineDiffView(file: file)\n                        } else {\n                            SideBySideDiffView(file: file)\n                        }\n                    }\n                }\n                .navigationTitle(file.fileName)\n                .navigationBarTitleDisplayMode(.inline)\n                .toolbar {\n                    ToolbarItem(placement: .navigationBarTrailing) {\n                        Button(\"Done\") {\n                            selectedFile = nil\n                        }\n                    }\n                }\n            }\n            .navigationViewStyle(.stack)\n        }\n    }\n    \n    private func refreshStatus() {\n        isLoading = true\n        // Simulate git status check\n        DispatchQueue.main.asyncAfter(deadline: .now() + 0.5) {\n            // Mock data\n            let contentLines = [\n                DiffLine(type: .context, content: \"import SwiftUI\", oldLineNumber: 1, newLineNumber: 1),\n                DiffLine(type: .context, content: \"\", oldLineNumber: 2, newLineNumber: 2),\n                DiffLine(type: .deletion, content: \"struct ContentView: View {\", oldLineNumber: 3, newLineNumber: nil),\n                DiffLine(type: .addition, content: \"struct ContentView: View { // Modified\", oldLineNumber: nil, newLineNumber: 3),\n                DiffLine(type: .context, content: \"    var body: some View {\", oldLineNumber: 4, newLineNumber: 4)\n            ]\n            let contentHunk = DiffHunk(header: \"@@ -1,4 +1,4 @@\", lines: contentLines)\n            \n            let readmeLines = [\n                DiffLine(type: .context, content: \"# VSCodeiPadOS\", oldLineNumber: 1, newLineNumber: 1),\n                DiffLine(type: .addition, content: \"A full-featured code editor for iPad.\", oldLineNumber: nil, newLineNumber: 2)\n            ]\n            let readmeHunk = DiffHunk(header: \"@@ -1,1 +1,2 @@\", lines: readmeLines)\n            \n            changedFiles = [\n                DiffFile(fileName: \"ContentView.swift\", status: \"Modified\", hunks: [contentHunk]),\n                DiffFile(fileName: \"README.md\", status: \"Modified\", hunks: [readmeHunk])\n            ]\n            branchInfo = \"On branch main • Your branch is up to date\"\n            isLoading = false\n        }\n    }\n    \n    private func performCommit() {\n        isLoading = true\n        // Simulate git commit\n        DispatchQueue.main.asyncAfter(deadline: .now() + 1) {\n            changedFiles = []\n            branchInfo = \"On branch main • Nothing to commit, working tree clean\"\n            commitMessage = \"\"\n            isLoading = false\n        }\n    }\n}\n\n#Preview {\n    GitView()\n}\n"}
>>>END


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/DiffComponents.swift"}
>>>END

>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Panels/GitView.swift"}
>>>END
>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/DiffComponents.swift"}
>>>END
>>>FILE VSCodeiPadOS/VSCodeiPadOS/Views/Panels/GitView.swift
>>>FIND
    @State private var commitMessage = ""
    @State private var gitStatus = "No changes"
    @State private var isLoading = false
    
    var body: some View {
        VStack(alignment: .leading, spacing: 20) {
            // Header
            HStack {
>>>REPLACE
    @State private var commitMessage = ""
    @State private var gitStatus = "No changes"
    @State private var isLoading = false
    @State private var changedFiles: [DiffFile] = []
    @State private var selectedFileForDiff: DiffFile?
    
    var body: some View {
        VStack(alignment: .leading, spacing: 20) {
            // Header
            HStack {
>>>END
>>>FILE VSCodeiPadOS/VSCodeiPadOS/Views/Panels/GitView.swift
>>>FIND
            // Git Status
            VStack(alignment: .leading, spacing: 10) {
                Text("STATUS")
                    .font(.caption)
                    .foregroundColor(.secondary)
                    .padding(.horizontal)
                
                ScrollView {
                    Text(gitStatus)
                        .font(.system(.body, design: .monospaced))
                        .padding()
                        .frame(maxWidth: .infinity, alignment: .leading)
                        .background(Color(UIColor.secondarySystemBackground))
                        .cornerRadius(8)
                }
                .frame(maxHeight: 200)
                .padding(.horizontal)
            }
>>>REPLACE
            // Git Status
            VStack(alignment: .leading, spacing: 10) {
                HStack {
                    Text("CHANGES")
                        .font(.caption)
                        .foregroundColor(.secondary)
                    Spacer()
                    Text("\(changedFiles.count) files")
                        .font(.caption)
                        .foregroundColor(.secondary)
                }
                .padding(.horizontal)
                
                if changedFiles.isEmpty {
                    Text(gitStatus)
                        .font(.system(.body, design: .monospaced))
                        .padding()
                        .frame(maxWidth: .infinity, alignment: .leading)
                        .background(Color(UIColor.secondarySystemBackground))
                        .cornerRadius(8)
                        .padding(.horizontal)
                } else {
                    List(changedFiles) { file in
                        Button(action: {
                            selectedFileForDiff = file
                        }) {
                            HStack {
                                Text(file.status)
                                    .font(.system(.caption, design: .monospaced))
                                    .fontWeight(.bold)
                                    .foregroundColor(statusColor(for: file.status))
                                    .frame(width: 20)
                                Text(file.fileName)
                                    .font(.system(.body, design: .monospaced))
                                Spacer()
                            }
                        }
                    }
                    .listStyle(.plain)
                    .frame(maxHeight: 300)
                    .background(Color(UIColor.secondarySystemBackground))
                    .cornerRadius(8)
                    .padding(.horizontal)
                }
            }
            .sheet(item: $selectedFileForDiff) { file in
                DiffDetailView(file: file)
            }
>>>END
>>>FILE VSCodeiPadOS/VSCodeiPadOS/Views/Panels/GitView.swift
>>>FIND
    private func refreshStatus() {
        isLoading = true
        // Simulate git status check
        DispatchQueue.main.asyncAfter(deadline: .now() + 0.5) {
            gitStatus = "On branch main\nYour branch is up to date with 'origin/main'.\n\nChanges not staged for commit:\n  modified:   ContentView.swift\n  modified:   README.md"
            isLoading = false
        }
    }
>>>REPLACE
    private func refreshStatus() {
        isLoading = true
        // Simulate git status check
        DispatchQueue.main.asyncAfter(deadline: .now() + 0.5) {
            gitStatus = "On branch main"
            changedFiles = generateSampleDiff()
            isLoading = false
        }
    }
    
    private func statusColor(for status: String) -> Color {
        switch status {
        case "M": return .orange
        case "A": return .green
        case "D": return .red
        default: return .secondary
        }
    }
    
    private func generateSampleDiff() -> [DiffFile] {
        let sampleLines1 = [
            DiffLine(type: .context, content: "import SwiftUI", oldLineNumber: 1, newLineNumber: 1),
            DiffLine(type: .deletion, content: "struct OldView: View {", oldLineNumber: 2, newLineNumber: nil),
            DiffLine(type: .addition, content: "struct NewView: View {", oldLineNumber: nil, newLineNumber: 2),
            DiffLine(type: .context, content: "    var body: some View {", oldLineNumber: 3, newLineNumber: 3),
            DiffLine(type: .addition, content: "        Text(\"New Feature\")", oldLineNumber: nil, newLineNumber: 4)
        ]
        let hunk1 = DiffHunk(header: "@@ -1,3 +1,4 @@", lines: sampleLines1)
        
        let sampleLines2 = [
            DiffLine(type: .context, content: "# VSCode iPadOS", oldLineNumber: 1, newLineNumber: 1),
            DiffLine(type: .deletion, content: "A simple editor", oldLineNumber: 2, newLineNumber: nil),
            DiffLine(type: .addition, content: "A powerful editor for iPad", oldLineNumber: nil, newLineNumber: 2)
        ]
        let hunk2 = DiffHunk(header: "@@ -1,2 +1,2 @@", lines: sampleLines2)
        
        return [
            DiffFile(fileName: "ContentView.swift", status: "M", hunks: [hunk1]),
            DiffFile(fileName: "README.md", status: "M", hunks: [hunk2])
        ]
    }
>>>END
>>>FILE VSCodeiPadOS/VSCodeiPadOS/Views/Panels/GitView.swift
>>>FIND
#Preview {
    GitView()
}
>>>REPLACE
struct DiffDetailView: View {
    let file: DiffFile
    @State private var viewMode: DiffViewMode = .inline
    @Environment(\.dismiss) var dismiss
    
    var body: some View {
        NavigationView {
            VStack(spacing: 0) {
                Picker("View Mode", selection: $viewMode) {
                    Text("Inline").tag(DiffViewMode.inline)
                    Text("Side by Side").tag(DiffViewMode.sideBySide)
                }
                .pickerStyle(.segmented)
                .padding()
                .background(Color(UIColor.secondarySystemBackground))
                
                ScrollView {
                    if viewMode == .inline {
                        InlineDiffView(file: file)
                            .padding()
                    } else {
                        SideBySideDiffView(file: file)
                            .padding()
                    }
                }
            }
            .navigationTitle(file.fileName)
            .navigationBarTitleDisplayMode(.inline)
            .toolbar {
                ToolbarItem(placement: .navigationBarTrailing) {
                    Button("Done") { dismiss() }
                }
            }
            .background(Color(UIColor.systemBackground))
        }
        .navigationViewStyle(.stack)
    }
}

#Preview {
    GitView()
}
>>>END


>>>TOOL read_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Panels/GitView.swift"}
>>>END
>>>TOOL create_file
{"path": "VSCodeiPadOS/VSCodeiPadOS/Views/Panels/GitView.swift", "content": "import SwiftUI\n\nstruct GitView: View {\n    @State private var commitMessage = \"\"\n    @State private var changedFiles: [DiffFile] = []\n    @State private var selectedFile: DiffFile? \n    @State private var isLoading = false\n    \n    var body: some View {\n        VStack(alignment: .leading, spacing: 20) {\n            // Header\n            HStack {\n                Image(systemName: \"arrow.triangle.branch\")\n                    .font(.title2)\n                Text(\"Source Control\")\n                    .font(.title2)\n                    .fontWeight(.semibold)\n                Spacer()\n            }\n            .padding(.horizontal)\n            .padding(.top)\n            \n            // Git Status (File List)\n            VStack(alignment: .leading, spacing: 10) {\n                Text(\"CHANGES\")\n                    .font(.caption)\n                    .foregroundColor(.secondary)\n                    .padding(.horizontal)\n                \n                if isLoading {\n                    ProgressView()\n                        .frame(maxWidth: .infinity)\n                        .padding()\n                } else if changedFiles.isEmpty {\n                    Text(\"No changes detected\")\n                        .foregroundColor(.secondary)\n                        .padding(.horizontal)\n                        .italic()\n                } else {\n                    List(changedFiles) { file in\n                        Button(action: { selectedFile = file }) {\n                            HStack {\n                                Image(systemName: fileIcon(for: file.fileName))\n                                    .foregroundColor(.secondary)\n                                Text(file.fileName)\n                                    .font(.system(.body, design: .monospaced))\n                                Spacer()\n                                Text(file.status)\n                                    .font(.caption)\n                                    .padding(.horizontal, 6)\n                                    .padding(.vertical, 2)\n                                    .background(statusColor(for: file.status).opacity(0.1))\n                                    .foregroundColor(statusColor(for: file.status))\n                                    .cornerRadius(4)\n                            }\n                        }\n                    }\n                    .listStyle(.plain)\n                    .frame(maxHeight: .infinity)\n                }\n            }\n            \n            // Commit Section\n            VStack(alignment: .leading, spacing: 10) {\n                Text(\"COMMIT\")\n                    .font(.caption)\n                    .foregroundColor(.secondary)\n                    .padding(.horizontal)\n                \n                TextField(\"Commit message...\", text: $commitMessage)\n                    .textFieldStyle(RoundedBorderTextFieldStyle())\n                    .padding(.horizontal)\n                \n                HStack(spacing: 15) {\n                    Button(action: performCommit) {\n                        Label(\"Commit\", systemImage: \"checkmark.circle.fill\")\n                            .frame(maxWidth: .infinity)\n                    }\n                    .buttonStyle(.borderedProminent)\n                    .disabled(commitMessage.isEmpty || isLoading || changedFiles.isEmpty)\n                    \n                    Button(action: refreshStatus) {\n                        Label(\"Refresh\", systemImage: \"arrow.clockwise\")\n                    }\n                    .buttonStyle(.bordered)\n                    .disabled(isLoading)\n                }\n                .padding(.horizontal)\n            }\n            .padding(.bottom)\n        }\n        .frame(maxWidth: .infinity, maxHeight: .infinity)\n        .background(Color(UIColor.systemBackground))\n        .onAppear {\n            refreshStatus()\n        }\n        .sheet(item: $selectedFile) { file in\n            DiffViewerSheet(file: file)\n        }\n    }\n    \n    private func fileIcon(for name: String) -> String {\n        if name.hasSuffix(\".swift\") { return \"swift\" }\n        if name.hasSuffix(\".md\") { return \"doc.text\" }\n        return \"doc\"\n    }\n    \n    private func statusColor(for status: String) -> Color {\n        switch status {\n        case \"modified\": return .orange\n        case \"added\": return .green\n        case \"deleted\": return .red\n        default: return .secondary\n        }\n    }\n    \n    private func refreshStatus() {\n        isLoading = true\n        // Simulate git status check\n        DispatchQueue.main.asyncAfter(deadline: .now() + 0.5) {\n            changedFiles = MockGitData.sampleFiles\n            isLoading = false\n        }\n    }\n    \n    private func performCommit() {\n        isLoading = true\n        // Simulate git commit\n        DispatchQueue.main.asyncAfter(deadline: .now() + 1) {\n            changedFiles = []\n            commitMessage = \"\"\n            isLoading = false\n        }\n    }\n}\n\nstruct DiffViewerSheet: View {\n    let file: DiffFile\n    @State private var mode: DiffViewMode = .inline\n    @Environment(\\.presentationMode) var presentationMode\n    \n    var body: some View {\n        NavigationView {\n            ScrollView {\n                if mode == .inline {\n                    InlineDiffView(file: file)\n                        .padding()\n                } else {\n                    SideBySideDiffView(file: file)\n                        .padding()\n                }\n            }\n            .navigationTitle(file.fileName)\n            .navigationBarTitleDisplayMode(.inline)\n            .toolbar {\n                ToolbarItem(placement: .navigationBarLeading) {\n                    Button(\"Done\") {\n                        presentationMode.wrappedValue.dismiss()\n                    }\n                }\n                \n                ToolbarItem(placement: .navigationBarTrailing) {\n                    Picker(\"View Mode\", selection: $mode) {\n                        Text(\"Inline\").tag(DiffViewMode.inline)\n                        Text(\"Side by Side\").tag(DiffViewMode.sideBySide)\n                    }\n                    .pickerStyle(SegmentedPickerStyle())\n                }\n            }\n        }\n    }\n}\n\nstruct MockGitData {\n    static let sampleFiles: [DiffFile] = [\n        DiffFile(\n            fileName: \"ContentView.swift\",\n            status: \"modified\",\n            hunks: [\n                DiffHunk(\n                    header: \"@@ -10,7 +10,7 @@\",\n                    lines: [\n                        DiffLine(type: .context, content: \"    var body: some View {\", oldLineNumber: 10, newLineNumber: 10),\n                        DiffLine(type: .deletion, content: \"        Text(\\\"Hello, World!\\\")\", oldLineNumber: 11, newLineNumber: nil),\n                        DiffLine(type: .addition, content: \"        Text(\\\"Hello, iPadOS!\\\")\", oldLineNumber: nil, newLineNumber: 11),\n                        DiffLine(type: .context, content: \"            .padding()\", oldLineNumber: 12, newLineNumber: 12)\n                    ]\n                )\n            ]\n        ),\n        DiffFile(\n            fileName: \"README.md\",\n            status: \"modified\",\n            hunks: [\n                DiffHunk(\n                    header: \"@@ -1,3 +1,5 @@\",\n                    lines: [\n                        DiffLine(type: .context, content: \"# VSCodeiPadOS\", oldLineNumber: 1, newLineNumber: 1),\n                        DiffLine(type: .addition, content: \"A fully functional VS Code clone for iPad.\", oldLineNumber: nil, newLineNumber: 2),\n                        DiffLine(type: .context, content: \"\", oldLineNumber: 2, newLineNumber: 3),\n                        DiffLine(type: .deletion, content: \"Coming soon...\", oldLineNumber: 3, newLineNumber: nil),\n                        DiffLine(type: .addition, content: \"Work in progress.\", oldLineNumber: nil, newLineNumber: 4)\n                    ]\n                )\n            ]\n        )\n    ]\n}\n\n#Preview {\n    GitView()\n}\n"}
>>>END
>>>REPORT
I have designed and implemented the Diff Viewer UI components and integrated them into the `GitView`.

**Key Components Implemented:**

1.  **`DiffComponents.swift`**:
    *   **Models**: `DiffFile`, `DiffHunk`, `DiffLine`, `DiffLineType` for representing diff data.
    *   **`InlineDiffView`**: Displays diffs in a single column with colored backgrounds for additions (green) and deletions (red).
    *   **`SideBySideDiffView`**: Displays diffs in two columns (Left: Old, Right: New) with aligned lines and empty spacers where needed.
    *   **Shared Components**: `HunkHeaderView` for displaying hunk metadata (e.g., `@@ -1,3 +1,3 @@`).

2.  **`GitView.swift` Integration**:
    *   Updated `GitView` to display a list of changed files instead of a static status text.
    *   Added `DiffViewerSheet` which opens when a file is selected, providing a full-screen view of the diff.
    *   Added a toggle in the toolbar to switch between **Inline** and **Side-by-Side** modes.
    *   Added `MockGitData` to simulate git changes for demonstration purposes.

**Usage:**
*   Open the `GitView` (Source Control panel).
*   It will automatically "refresh" and show a list of modified files (mocked).
*   Tap on a file to open the Diff Viewer.
*   Use the segmented control in the top right to switch between view modes.

**Files Created/Modified:**
*   `VSCodeiPadOS/VSCodeiPadOS/Views/DiffComponents.swift` (New)
*   `VSCodeiPadOS/VSCodeiPadOS/Views/Panels/GitView.swift` (Modified)
>>>END
